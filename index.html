<html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>main.cpp</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="generator" content="Code::Blocks Exporter plugin">
<style type="text/css">
<!--
body { color: #F1F2F3; background-color: #252C2E; }
.style11 { color: #F1F2F3; background-color: #252C2E; }
.style64 { color: #C8C8C8; }
.style72 { color: #C8C8C8; }
.style75 { color: #C8C8C8; }
.style1 { color: #66747B; }
.style23 { color: #66747B; }
.style65 { color: #66747B; }
.style87 { color: #66747B; }
.style2 { color: #BEBEE6; }
.style66 { color: #BEBEE6; }
.style3 { color: #99A38A; }
.style24 { color: #99A38A; }
.style67 { color: #99A38A; }
.style88 { color: #99A38A; }
.style15 { color: #8080FF; font-weight: bold; }
.style79 { color: #8080FF; font-weight: bold; }
.style17 { color: #008080; }
.style81 { color: #008080; }
.style18 { color: #0000A4; }
.style82 { color: #0000A4; }
.style4 { color: #FFCD22; }
.style68 { color: #F0C8F0; }
.style5 { color: #93C763; }
.style69 { color: #8787C8; font-weight: bold; }
.style16 { color: #678CB1; }
.style80 { color: #9AC89A; font-weight: bold; }
.style19 { color: #BE00BE; font-weight: bold; }
.style83 { color: #BE89BE; font-weight: bold; }
.style6 { color: #EC7600; }
.style12 { color: #EC7600; }
.style20 { color: #EC7600; }
.style70 { color: #BEBEFF; }
.style76 { color: #BEBEFF; }
.style7 { color: #EFC210; }
.style71 { color: #E0CE9F; }
.style8 { color: #CFD7D3; }
.style9 { color: #A082BD; }
.style73 { color: #84A084; }
.style10 { color: #E8E2B7; }
.style74 { color: #FFC8C8; }
.style34 { color: #FFFF00; background-color: #2F393C; font-weight: bold; }
.style35 { color: #0000A0; background-color: #FF0000; font-weight: bold; }
.style50 { color: #404080; font-style: italic; }
.style114 { color: #8585AC; font-style: italic; }
--></style></head>
<body>
<pre><code><span style="font: 30pt Courier New;"><span class="style9">#include &lt;bits/stdc++.h&gt;
#define Task            "A"                                 </span><span class="style15">///map of knowledge
</span><span class="style9">#define ll              long long                           </span><span class="style2">//+ Binary Lifting
</span><span class="style9">#define bit(x,i)        ((x &gt;&gt; i) &amp; 1)                      </span><span class="style2">//+ Hash Table
</span><span class="style9">#define stt(x,i)        (x &amp; (1 &lt;&lt; i))                      </span><span class="style2">//+ Trie Tree
</span><span class="style9">#define trail0(x)       (x &amp; (-x))                          </span><span class="style2">//+ Sparse Table - RMQ
</span><span class="style9">#define up(i,a,b)       for (int i = (a); i &lt;= (b); i++)    </span><span class="style2">//+ Matrix
</span><span class="style9">#define down(i,a,b)     for (int i = (a); i &gt;= (b); i--)    </span><span class="style2">//+ DSU
</span><span class="style9">#define MOD             1000000007                          </span><span class="style2">//+ Joints - Bridges
</span><span class="style9">#define base            311                                 </span><span class="style2">//+ SCC
</span><span class="style9">#define pii             pair&lt;int, int&gt;                      </span><span class="style2">//+ Z-KMP
</span><span class="style9">#define f               first                               </span><span class="style2">//+ MST
</span><span class="style9">#define s               second                              </span><span class="style2">//+ LCA
</span><span class="style9">#define pb              push_back                           </span><span class="style2">//+ Shortest Path
</span><span class="style9">#define ep              emplace_back                        </span><span class="style2">//+ Fenwick Tree
                                                            //+ Segment Tree
                                                            //+ Bitmasking
                                                            //+ Longest Path
                                                            //+ Center Node
                                                            //+ Bin-Tern Search
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;                                        </span><span class="style2">//+ Stack-Queue-Deque

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">3</span><span class="style10">*</span><span class="style4">100000</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">z</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">TinhZ</span><span class="style10">(){
    </span><span class="style11">z</span><span class="style10">[</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">r </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">r</span><span class="style10">) </span><span class="style11">x </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">z</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style11">l</span><span class="style10">+</span><span class="style4">1</span><span class="style10">], </span><span class="style11">r</span><span class="style10">-</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">x</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] == </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style11">x</span><span class="style10">]) </span><span class="style11">x</span><span class="style10">++;

        </span><span class="style11">z</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">- </span><span class="style4">1 </span><span class="style10">&gt; </span><span class="style11">r</span><span class="style10">){
            </span><span class="style11">l </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
            </span><span class="style11">r </span><span class="style10">= </span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">- </span><span class="style4">1</span><span class="style10">;
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">TinhZ</span><span class="style10">();
</span><span class="style2">//    up(i, 1, n) cout &lt;&lt; z[i] &lt;&lt; " ";
//    cout &lt;&lt; "\n";

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
</span><span class="style2">//        cout &lt;&lt; i + 1 + z[i+1] &lt;&lt; " " &lt;&lt; n-i &lt;&lt; "\n";
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">z</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] == </span><span class="style11">n</span><span class="style10">-</span><span class="style11">i</span><span class="style10">) {
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">;
            </span><span class="style5">break</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style11">pii T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">4</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">id</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">A</span><span class="style10">,</span><span class="style11">B</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">build</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style11">make_pair</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">){
        </span><span class="style11">id</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">nod</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">pii x</span><span class="style10">, </span><span class="style11">pii</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){ </span><span class="style2">//We can see the importance of "passing by reference"
    </span><span class="style1">/* Cha : tinh nhan a
             tinh cong b
       Con : tinh nhan c
             tinh cong d
       Cha -&gt; Con: c = c*a
                   d = b*c + d
    */
    </span><span class="style11">y</span><span class="style10">.</span><span class="style11">f </span><span class="style10">= (</span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f </span><span class="style10">* </span><span class="style11">y</span><span class="style10">.</span><span class="style11">f</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
    </span><span class="style11">y</span><span class="style10">.</span><span class="style11">s </span><span class="style10">= ((</span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">*</span><span class="style11">y</span><span class="style10">.</span><span class="style11">s</span><span class="style10">) % </span><span class="style11">MOD </span><span class="style10">+ </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">&lt; </span><span class="style11">l </span><span class="style10">|| </span><span class="style11">u </span><span class="style10">&gt; </span><span class="style11">r</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">A </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">s </span><span class="style10">= (</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">s </span><span class="style10">+ </span><span class="style11">B</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style2">//(x+y)*g -&gt; xg + gy
            </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">f </span><span class="style10">= (</span><span class="style4">1ll </span><span class="style10">* </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">f </span><span class="style10">* </span><span class="style11">A</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
            </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">s </span><span class="style10">= (</span><span class="style4">1ll </span><span class="style10">* </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">s </span><span class="style10">* </span><span class="style11">A</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
        }
        </span><span class="style5">return</span><span class="style10">;
    }

    </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">], </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">]);
    </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">], </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style11">make_pair</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
}

</span><span class="style11">ll getpos</span><span class="style10">(</span><span class="style5">int </span><span class="style11">pos</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">id</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">];
    </span><span class="style5">long long </span><span class="style11">res </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">];

    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">nod </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">= ((</span><span class="style4">1ll</span><span class="style10">* </span><span class="style11">res </span><span class="style10">* </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">f</span><span class="style10">) % </span><span class="style11">MOD </span><span class="style10">+ </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">s</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
        </span><span class="style11">nod </span><span class="style10">/= </span><span class="style4">2</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">pr_mb</span><span class="style10">(){
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">*</span><span class="style4">4</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">T</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">T</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">q</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">q</span><span class="style10">--){
        </span><span class="style5">char </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style7">'?'</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">x</span><span class="style10">;
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">getpos</span><span class="style10">(</span><span class="style11">x</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style7">'*'</span><span class="style10">){
                </span><span class="style11">A </span><span class="style10">= </span><span class="style11">w</span><span class="style10">;
                </span><span class="style11">B </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
                </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
            }
            </span><span class="style5">else </span><span class="style10">{
                </span><span class="style11">A </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
                </span><span class="style11">B </span><span class="style10">= </span><span class="style11">w</span><span class="style10">;
                </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
            }
        }
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}


</span><span class="style5">void </span><span class="style11">KMP</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">Pi</span><span class="style10">[</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">k </span><span class="style10">&amp;&amp; </span><span class="style11">s</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] != </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">k </span><span class="style10">= </span><span class="style11">Pi</span><span class="style10">[</span><span class="style11">k</span><span class="style10">];
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">s</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] == </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">k</span><span class="style10">++;
        </span><span class="style11">Pi</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">k</span><span class="style10">;
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">;
    </span><span class="style11">n </span><span class="style10">= </span><span class="style11">s</span><span class="style10">.</span><span class="style11">length</span><span class="style10">();
    </span><span class="style11">s </span><span class="style10">= </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">;
    </span><span class="style11">KMP</span><span class="style10">();
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">res</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">res</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">) </span><span class="style11">res</span><span class="style10">[</span><span class="style11">Pi</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] += </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style2">// (A + B) * C - D

</span><span class="style16">string </span><span class="style11">add</span><span class="style10">(</span><span class="style16">string </span><span class="style11">a</span><span class="style10">, </span><span class="style16">string </span><span class="style11">b</span><span class="style10">){
    </span><span class="style16">string </span><span class="style11">res </span><span class="style10">= </span><span class="style6">""</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt; </span><span class="style11">b</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()) </span><span class="style11">a </span><span class="style10">= </span><span class="style7">'0' </span><span class="style10">+ </span><span class="style11">a</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &gt; </span><span class="style11">b</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()) </span><span class="style11">b </span><span class="style10">= </span><span class="style7">'0' </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">crr </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= (</span><span class="style5">int</span><span class="style10">)</span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()-</span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">t </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] + </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style4">48</span><span class="style10">*</span><span class="style4">2 </span><span class="style10">+ </span><span class="style11">crr</span><span class="style10">;
        </span><span class="style11">crr </span><span class="style10">= </span><span class="style11">t</span><span class="style10">/</span><span class="style4">10</span><span class="style10">;
        </span><span class="style11">t </span><span class="style10">%= </span><span class="style4">10</span><span class="style10">;
        </span><span class="style11">res </span><span class="style10">= </span><span class="style5">char</span><span class="style10">(</span><span class="style11">t</span><span class="style10">+</span><span class="style4">48</span><span class="style10">) + </span><span class="style11">res</span><span class="style10">;
    }
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">res</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &gt; </span><span class="style4">1 </span><span class="style10">&amp;&amp; </span><span class="style11">res</span><span class="style10">.</span><span class="style16">front</span><span class="style10">() == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">res</span><span class="style10">.</span><span class="style16">erase</span><span class="style10">(</span><span class="style4">0</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">crr </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">) </span><span class="style11">res </span><span class="style10">= </span><span class="style7">'1' </span><span class="style10">+ </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style16">string </span><span class="style11">sub</span><span class="style10">(</span><span class="style16">string </span><span class="style11">a</span><span class="style10">, </span><span class="style16">string </span><span class="style11">b</span><span class="style10">){
    </span><span class="style16">string </span><span class="style11">res </span><span class="style10">= </span><span class="style6">""</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt; </span><span class="style11">b</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()) </span><span class="style11">a </span><span class="style10">= </span><span class="style7">'0' </span><span class="style10">+ </span><span class="style11">a</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &gt; </span><span class="style11">b</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()) </span><span class="style11">b </span><span class="style10">= </span><span class="style7">'0' </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">brr </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

    </span><span class="style5">bool </span><span class="style11">isNeg </span><span class="style10">= </span><span class="style5">false</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a </span><span class="style10">&lt; </span><span class="style11">b</span><span class="style10">){
        </span><span class="style16">swap</span><span class="style10">(</span><span class="style11">a</span><span class="style10">, </span><span class="style11">b</span><span class="style10">);
        </span><span class="style11">isNeg </span><span class="style10">= </span><span class="style5">true</span><span class="style10">;
    }
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= (</span><span class="style5">int</span><span class="style10">)</span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()-</span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">t </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style11">brr</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">t </span><span class="style10">&lt; </span><span class="style4">0</span><span class="style10">){
            </span><span class="style11">brr </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">t </span><span class="style10">+= </span><span class="style4">10</span><span class="style10">;
        }
        </span><span class="style5">else </span><span class="style11">brr </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">res </span><span class="style10">= </span><span class="style5">char</span><span class="style10">(</span><span class="style11">t </span><span class="style10">% </span><span class="style4">10 </span><span class="style10">+ </span><span class="style4">48</span><span class="style10">) + </span><span class="style11">res</span><span class="style10">;
    }
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">res</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &gt; </span><span class="style4">1 </span><span class="style10">&amp;&amp; </span><span class="style11">res</span><span class="style10">.</span><span class="style16">front</span><span class="style10">() == </span><span class="style7">'0'</span><span class="style10">) </span><span class="style11">res</span><span class="style10">.</span><span class="style16">erase</span><span class="style10">(</span><span class="style4">0</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">isNeg</span><span class="style10">) </span><span class="style11">res </span><span class="style10">= </span><span class="style7">'-' </span><span class="style10">+ </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style16">string </span><span class="style11">mul</span><span class="style10">(</span><span class="style16">string </span><span class="style11">a</span><span class="style10">, </span><span class="style16">string </span><span class="style11">b</span><span class="style10">){
    </span><span class="style16">string </span><span class="style11">res </span><span class="style10">= </span><span class="style6">""</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">n </span><span class="style10">= </span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">m </span><span class="style10">= </span><span class="style11">b</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">len </span><span class="style10">= </span><span class="style11">n </span><span class="style10">+ </span><span class="style11">m </span><span class="style10">- </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">crr </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">len</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">sum </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">m</span><span class="style10">-</span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j</span><span class="style10">--){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i</span><span class="style10">-</span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">i</span><span class="style10">-</span><span class="style11">j </span><span class="style10">&gt;= </span><span class="style4">1</span><span class="style10">){
                </span><span class="style5">int </span><span class="style11">x1 </span><span class="style10">= </span><span class="style11">b</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] - </span><span class="style4">48</span><span class="style10">;
                </span><span class="style5">int </span><span class="style11">x2 </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">] - </span><span class="style4">48</span><span class="style10">;
                </span><span class="style11">sum </span><span class="style10">+= </span><span class="style11">x1</span><span class="style10">*</span><span class="style11">x2</span><span class="style10">;
            }
        }
        </span><span class="style11">sum </span><span class="style10">+= </span><span class="style11">crr</span><span class="style10">;
        </span><span class="style11">crr </span><span class="style10">= </span><span class="style11">sum</span><span class="style10">/</span><span class="style4">10</span><span class="style10">;
        </span><span class="style11">res </span><span class="style10">= </span><span class="style5">char</span><span class="style10">(</span><span class="style11">sum </span><span class="style10">% </span><span class="style4">10 </span><span class="style10">+ </span><span class="style4">48</span><span class="style10">) + </span><span class="style11">res</span><span class="style10">;
    }
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">res</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &gt; </span><span class="style4">1 </span><span class="style10">&amp;&amp; </span><span class="style11">res</span><span class="style10">.</span><span class="style16">front</span><span class="style10">() == </span><span class="style7">'0'</span><span class="style10">) </span><span class="style11">res</span><span class="style10">.</span><span class="style16">erase</span><span class="style10">(</span><span class="style4">0</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">MAXDATA </span><span class="style10">= </span><span class="style4">201</span><span class="style10">;
</span><span class="style16">mt19937 </span><span class="style11">RNG</span><span class="style10">(</span><span class="style11">chrono</span><span class="style10">::</span><span class="style11">steady_clock</span><span class="style10">::</span><span class="style11">now</span><span class="style10">().</span><span class="style11">time_since_epoch</span><span class="style10">().</span><span class="style16">count</span><span class="style10">());
</span><span class="style16">uniform_int_distribution</span><span class="style10">&lt;</span><span class="style16">mt19937</span><span class="style10">::</span><span class="style11">result_type</span><span class="style10">&gt; </span><span class="style11">random_number</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style11">MAXDATA</span><span class="style10">);

</span><span class="style5">int </span><span class="style11">randome</span><span class="style10">(){
    </span><span class="style5">return </span><span class="style11">random_number</span><span class="style10">(</span><span class="style11">RNG</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">b</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;

</span><span class="style5">bool </span><span class="style11">check</span><span class="style10">(</span><span class="style5">int </span><span class="style11">h</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">h</span><span class="style10">){
            </span><span class="style5">while </span><span class="style10">(</span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">m </span><span class="style10">&amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] + </span><span class="style11">b</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] &lt; </span><span class="style11">h</span><span class="style10">) </span><span class="style11">j</span><span class="style10">++;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">j </span><span class="style10">&gt; </span><span class="style11">m</span><span class="style10">) </span><span class="style5">return false</span><span class="style10">;
            </span><span class="style11">j</span><span class="style10">++;
        }
    }
    </span><span class="style5">return true</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">Search</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">r </span><span class="style10">= </span><span class="style4">2e8</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">check</span><span class="style10">(</span><span class="style11">mid</span><span class="style10">)) </span><span class="style11">l </span><span class="style10">= </span><span class="style11">mid</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">r </span><span class="style10">= </span><span class="style11">mid</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style11">l</span><span class="style10">;
}


</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">Search</span><span class="style10">();
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define pii pair&lt;double, double&gt;
#define f first
#define s second
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style11">pii a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">double </span><span class="style11">w</span><span class="style10">,</span><span class="style11">h</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
</span><span class="style5">double </span><span class="style11">Md</span><span class="style10">;
</span><span class="style5">double </span><span class="style11">Mc</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">w </span><span class="style10">&gt;&gt; </span><span class="style11">h</span><span class="style10">;

    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) {
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f </span><span class="style10">= </span><span class="style11">u</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">= </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">Md </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">Md</span><span class="style10">, </span><span class="style11">w</span><span class="style10">/(</span><span class="style4">1.0</span><span class="style10">*</span><span class="style11">u</span><span class="style10">));
        </span><span class="style11">Mc </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">Mc</span><span class="style10">, </span><span class="style11">w</span><span class="style10">/(</span><span class="style4">1.0</span><span class="style10">*</span><span class="style11">v</span><span class="style10">));
    }
}

</span><span class="style5">bool </span><span class="style11">check</span><span class="style10">(</span><span class="style5">double </span><span class="style11">k</span><span class="style10">){
    </span><span class="style5">double </span><span class="style11">sumh </span><span class="style10">= </span><span class="style4">0.0</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">remain </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">== </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">].</span><span class="style11">s </span><span class="style10">&amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">*</span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style11">remain</span><span class="style10">){
            </span><span class="style11">remain </span><span class="style10">-= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">*</span><span class="style11">k</span><span class="style10">;
            </span><span class="style2">//neu mot dong co nhieu tu
            //thi cac tu phai duoc in cung 1 do cao
        </span><span class="style10">}
        </span><span class="style5">else</span><span class="style10">{
            </span><span class="style11">sumh </span><span class="style10">+= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">*</span><span class="style11">k</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sumh </span><span class="style10">&gt; </span><span class="style11">h</span><span class="style10">) </span><span class="style5">return false</span><span class="style10">;
            </span><span class="style11">remain </span><span class="style10">= </span><span class="style11">w </span><span class="style10">- </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">*</span><span class="style11">k</span><span class="style10">;
        }
    }
    </span><span class="style5">return true</span><span class="style10">;
}

</span><span class="style5">double </span><span class="style11">Search</span><span class="style10">(){
    </span><span class="style5">double </span><span class="style11">l </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">r </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">Mc</span><span class="style10">, </span><span class="style11">Md</span><span class="style10">);
    </span><span class="style5">double </span><span class="style11">ACRC </span><span class="style10">= </span><span class="style4">1e-7</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">ACRC</span><span class="style10">){
        </span><span class="style5">double </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">check</span><span class="style10">(</span><span class="style11">mid</span><span class="style10">)) </span><span class="style11">l </span><span class="style10">= </span><span class="style11">mid</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">r </span><span class="style10">= </span><span class="style11">mid</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style11">l</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">fixed </span><span class="style10">&lt;&lt; </span><span class="style16">setprecision</span><span class="style10">(</span><span class="style4">6</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">Search</span><span class="style10">();
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define Task "A"
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;

</span><span class="style5">double </span><span class="style11">x</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">double </span><span class="style11">v</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">, </span><span class="style11">xx</span><span class="style10">, </span><span class="style11">vv</span><span class="style10">;

</span><span class="style5">double </span><span class="style11">get_dist</span><span class="style10">(</span><span class="style5">double </span><span class="style11">t</span><span class="style10">){
    </span><span class="style5">double </span><span class="style11">dmax </span><span class="style10">= -</span><span class="style4">1.0</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">dmin </span><span class="style10">= </span><span class="style4">2e14</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">double </span><span class="style11">d </span><span class="style10">= </span><span class="style11">x</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] + </span><span class="style11">v</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] * </span><span class="style11">t</span><span class="style10">;
        </span><span class="style11">dmax </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dmax</span><span class="style10">, </span><span class="style11">d</span><span class="style10">);
        </span><span class="style11">dmin </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">dmin</span><span class="style10">, </span><span class="style11">d</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">dmax </span><span class="style10">- </span><span class="style11">dmin</span><span class="style10">);
}

</span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">double</span><span class="style10">, </span><span class="style5">double</span><span class="style10">&gt; </span><span class="style11">Search</span><span class="style10">(){
    </span><span class="style5">double </span><span class="style11">l </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">r </span><span class="style10">= </span><span class="style4">1e7</span><span class="style10">;
    </span><span class="style2">//truong hop xau nhat :
    // 2 nguoi
    // 1 nguoi dung yen
    // 1 nguoi di chuyen 1m/s
    // =&gt; WORST_TIME = 1e7
    </span><span class="style5">double </span><span class="style11">ACRC </span><span class="style10">= </span><span class="style4">1e-9</span><span class="style10">;
    </span><span class="style2">//ACRC vua du
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">400</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">double </span><span class="style11">m1 </span><span class="style10">= </span><span class="style11">l </span><span class="style10">+ (</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l</span><span class="style10">)/</span><span class="style4">3</span><span class="style10">;
        </span><span class="style5">double </span><span class="style11">m2 </span><span class="style10">= </span><span class="style11">r </span><span class="style10">- (</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l</span><span class="style10">)/</span><span class="style4">3</span><span class="style10">;
        </span><span class="style5">double </span><span class="style11">d1 </span><span class="style10">= </span><span class="style11">get_dist</span><span class="style10">(</span><span class="style11">m1</span><span class="style10">);
        </span><span class="style5">double </span><span class="style11">d2 </span><span class="style10">= </span><span class="style11">get_dist</span><span class="style10">(</span><span class="style11">m2</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d1 </span><span class="style10">&lt; </span><span class="style11">d2 </span><span class="style10">+ </span><span class="style11">ACRC</span><span class="style10">) </span><span class="style11">r </span><span class="style10">= </span><span class="style11">m2</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">l </span><span class="style10">= </span><span class="style11">m1</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style11">make_pair</span><span class="style10">(</span><span class="style11">l</span><span class="style10">, </span><span class="style11">get_dist</span><span class="style10">(</span><span class="style11">l</span><span class="style10">));
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">xx </span><span class="style10">&gt;&gt; </span><span class="style11">vv</span><span class="style10">;
        </span><span class="style11">x</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">xx</span><span class="style10">;
        </span><span class="style11">v</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">vv</span><span class="style10">;
    }

    </span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">double</span><span class="style10">, </span><span class="style5">double</span><span class="style10">&gt; </span><span class="style11">res </span><span class="style10">= </span><span class="style11">Search</span><span class="style10">();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">fixed </span><span class="style10">&lt;&lt; </span><span class="style16">setprecision</span><span class="style10">(</span><span class="style4">6</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">.</span><span class="style11">first </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">.</span><span class="style11">second</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style11">pii a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">x </span><span class="style10">= </span><span class="style11">u</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">y </span><span class="style10">= </span><span class="style11">v</span><span class="style10">;
    }
}

</span><span class="style5">bool </span><span class="style11">check</span><span class="style10">(</span><span class="style5">double </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">y </span><span class="style10">&gt; </span><span class="style11">r</span><span class="style10">*</span><span class="style4">2</span><span class="style10">) </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
    }
    </span><span class="style5">double </span><span class="style11">p</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">q</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">L </span><span class="style10">= -</span><span class="style4">1e24</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">R </span><span class="style10">= </span><span class="style4">1e24</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">double </span><span class="style11">d </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">y </span><span class="style10">* (</span><span class="style4">2</span><span class="style10">*</span><span class="style11">r </span><span class="style10">- </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">y</span><span class="style10">);
        </span><span class="style11">d </span><span class="style10">= </span><span class="style11">sqrt</span><span class="style10">(</span><span class="style11">d</span><span class="style10">);
        </span><span class="style11">p </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">x </span><span class="style10">- </span><span class="style11">d</span><span class="style10">;
        </span><span class="style11">q </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">x </span><span class="style10">+ </span><span class="style11">d</span><span class="style10">;
        </span><span class="style11">L </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">L</span><span class="style10">, </span><span class="style11">p</span><span class="style10">);
        </span><span class="style11">R </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">R</span><span class="style10">, </span><span class="style11">q</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">L </span><span class="style10">&lt;= </span><span class="style11">R</span><span class="style10">); </span><span class="style2">// co diem chung
</span><span class="style10">}

</span><span class="style5">double </span><span class="style11">Search</span><span class="style10">(){
    </span><span class="style5">double </span><span class="style11">l </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">r </span><span class="style10">= </span><span class="style4">1e12</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">ACRC </span><span class="style10">= </span><span class="style4">1e-7</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">ACRC</span><span class="style10">){
        </span><span class="style5">double </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">check</span><span class="style10">(</span><span class="style11">mid</span><span class="style10">)) </span><span class="style11">r </span><span class="style10">= </span><span class="style11">mid</span><span class="style10">; </span><span class="style2">// tim ban kinh nho nhat
        </span><span class="style5">else </span><span class="style11">l </span><span class="style10">= </span><span class="style11">mid</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style11">r</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">fixed </span><span class="style10">&lt;&lt; </span><span class="style16">setprecision</span><span class="style10">(</span><span class="style4">3</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">Search</span><span class="style10">();
}
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1001</span><span class="style10">;
</span><span class="style11">pii a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">double </span><span class="style11">sqr</span><span class="style10">(</span><span class="style5">double </span><span class="style11">t</span><span class="style10">){
    </span><span class="style5">return </span><span class="style11">t</span><span class="style10">*</span><span class="style11">t</span><span class="style10">;
}

</span><span class="style5">double </span><span class="style11">radius</span><span class="style10">(</span><span class="style5">double </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">double </span><span class="style11">y </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">y </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">y</span><span class="style10">, (</span><span class="style11">sqr</span><span class="style10">(</span><span class="style11">x </span><span class="style10">- </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">x</span><span class="style10">) + </span><span class="style11">sqr</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">y</span><span class="style10">))/(</span><span class="style4">2.0 </span><span class="style10">* </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">y</span><span class="style10">));
    }
    </span><span class="style5">return </span><span class="style11">y</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style5">double </span><span class="style11">l </span><span class="style10">= -</span><span class="style4">2e6</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">r </span><span class="style10">= </span><span class="style4">2e6</span><span class="style10">;
    </span><span class="style5">double </span><span class="style11">ACRC </span><span class="style10">= </span><span class="style4">1e-6</span><span class="style10">;

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">x </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">y</span><span class="style10">;
    }

    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">ACRC</span><span class="style10">){
        </span><span class="style5">double </span><span class="style11">mid1 </span><span class="style10">= </span><span class="style11">l </span><span class="style10">+ (</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l</span><span class="style10">)/</span><span class="style4">3</span><span class="style10">;
        </span><span class="style5">double </span><span class="style11">mid2 </span><span class="style10">= </span><span class="style11">r </span><span class="style10">- (</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l</span><span class="style10">)/</span><span class="style4">3</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">radius</span><span class="style10">(</span><span class="style11">mid1</span><span class="style10">) &lt; </span><span class="style11">radius</span><span class="style10">(</span><span class="style11">mid2</span><span class="style10">)) </span><span class="style11">r </span><span class="style10">= </span><span class="style11">mid2</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">l </span><span class="style10">= </span><span class="style11">mid1</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">fixed </span><span class="style10">&lt;&lt; </span><span class="style16">setprecision</span><span class="style10">(</span><span class="style4">3</span><span class="style10">) &lt;&lt; </span><span class="style11">radius</span><span class="style10">(</span><span class="style11">l</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">p</span><span class="style10">,</span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">y</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">y</span><span class="style10">; </span><span class="style11">v </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">v </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] += </span><span class="style11">val</span><span class="style10">;
        }
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">int </span><span class="style11">get</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">y</span><span class="style10">; </span><span class="style11">v </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">; </span><span class="style11">v </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">v</span><span class="style10">];
        }
        </span><span class="style11">x </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">,</span><span class="style11">val</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style5">char </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style7">'U'</span><span class="style10">){
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">val</span><span class="style10">;
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">val</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">p </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">;
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">get</span><span class="style10">(</span><span class="style11">p</span><span class="style10">, </span><span class="style11">q</span><span class="style10">) - </span><span class="style11">get</span><span class="style10">(</span><span class="style11">p</span><span class="style10">, </span><span class="style11">v</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) - </span><span class="style11">get</span><span class="style10">(</span><span class="style11">u</span><span class="style10">-</span><span class="style4">1</span><span class="style10">, </span><span class="style11">q</span><span class="style10">) + </span><span class="style11">get</span><span class="style10">(</span><span class="style11">u</span><span class="style10">-</span><span class="style4">1</span><span class="style10">, </span><span class="style11">v</span><span class="style10">-</span><span class="style4">1</span><span class="style10">);
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style5">char </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style7">'U'</span><span class="style10">) {
            </span><span class="style5">int </span><span class="style11">val</span><span class="style10">;
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">val</span><span class="style10">;
            </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] += </span><span class="style11">val</span><span class="style10">;
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style5">int </span><span class="style11">x</span><span class="style10">,</span><span class="style11">y</span><span class="style10">;
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x </span><span class="style10">&gt;&gt; </span><span class="style11">y</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">u</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">x</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
                </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">v</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">y</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
                    </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
                }
            }
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">MAXDATA </span><span class="style10">= </span><span class="style4">201</span><span class="style10">;
</span><span class="style16">mt19937 </span><span class="style11">RNG</span><span class="style10">(</span><span class="style11">chrono</span><span class="style10">::</span><span class="style11">steady_clock</span><span class="style10">::</span><span class="style11">now</span><span class="style10">().</span><span class="style11">time_since_epoch</span><span class="style10">().</span><span class="style16">count</span><span class="style10">());
</span><span class="style16">uniform_int_distribution</span><span class="style10">&lt;</span><span class="style16">mt19937</span><span class="style10">::</span><span class="style11">result_type</span><span class="style10">&gt; </span><span class="style11">random_number</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style11">MAXDATA</span><span class="style10">);
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1001</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">MAXUPDATE </span><span class="style10">= </span><span class="style4">2500</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">MAXQUERY </span><span class="style10">= </span><span class="style4">2500</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">n </span><span class="style10">= </span><span class="style4">200</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">m </span><span class="style10">= </span><span class="style4">200</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">testcase</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x</span><span class="style10">,</span><span class="style11">y</span><span class="style10">,</span><span class="style11">val</span><span class="style10">;
    </span><span class="style5">bool </span><span class="style11">dei</span><span class="style10">;
};

</span><span class="style5">int </span><span class="style11">randome</span><span class="style10">(){
    </span><span class="style5">return </span><span class="style11">random_number</span><span class="style10">(</span><span class="style11">RNG</span><span class="style10">);
}

</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">testcase</span><span class="style10">&gt; </span><span class="style11">UU</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">randome_update</span><span class="style10">(){
    </span><span class="style5">char </span><span class="style11">c</span><span class="style10">[</span><span class="style4">2</span><span class="style10">] = {</span><span class="style7">'U'</span><span class="style10">, </span><span class="style7">'S'</span><span class="style10">};

    </span><span class="style5">int </span><span class="style11">p </span><span class="style10">= </span><span class="style11">MAXUPDATE</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">p</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">cc </span><span class="style10">= </span><span class="style11">randome</span><span class="style10">() % </span><span class="style4">2</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">randome</span><span class="style10">() % </span><span class="style11">n </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">randome</span><span class="style10">() % </span><span class="style11">m </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">val </span><span class="style10">= </span><span class="style11">randome</span><span class="style10">() % </span><span class="style11">MAXDATA </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">UU</span><span class="style10">.</span><span class="style11">pb</span><span class="style10">({(</span><span class="style5">int</span><span class="style10">)</span><span class="style11">c</span><span class="style10">[</span><span class="style11">cc</span><span class="style10">], </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">val</span><span class="style10">, </span><span class="style4">1</span><span class="style10">});
    }
}

</span><span class="style5">void </span><span class="style11">randome_get</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">p </span><span class="style10">= </span><span class="style11">MAXQUERY</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">p</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">randome</span><span class="style10">() % </span><span class="style11">n </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">randome</span><span class="style10">() % </span><span class="style11">m </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">randome</span><span class="style10">() % </span><span class="style11">n </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">y </span><span class="style10">= </span><span class="style11">randome</span><span class="style10">() % </span><span class="style11">m </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">UU</span><span class="style10">.</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">x</span><span class="style10">, </span><span class="style11">y</span><span class="style10">, </span><span class="style4">0</span><span class="style10">});
    }
}

</span><span class="style5">void </span><span class="style11">modify_testcase</span><span class="style10">(){
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">UU</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">; </span><span class="style2">// Queries

    </span><span class="style11">shuffle</span><span class="style10">(</span><span class="style11">UU</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">UU</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">RNG</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, (</span><span class="style5">int</span><span class="style10">)</span><span class="style11">UU</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()-</span><span class="style4">1</span><span class="style10">){

        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">UU</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">c</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">UU</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">x</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">UU</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">y</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">y </span><span class="style10">= </span><span class="style11">UU</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">val</span><span class="style10">;

        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">UU</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">dei </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style7">'U' </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">v </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">x </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">y </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style5">int </span><span class="style11">d1 </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">x</span><span class="style10">);
            </span><span class="style5">int </span><span class="style11">d2 </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">y</span><span class="style10">);
            </span><span class="style5">int </span><span class="style11">d3 </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">x</span><span class="style10">);
            </span><span class="style5">int </span><span class="style11">d4 </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">y</span><span class="style10">);
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style7">'S' </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">d1 </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">d2 </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">d3 </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">d4 </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">n </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">m </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;

    </span><span class="style11">randome_update</span><span class="style10">();
    </span><span class="style11">randome_get</span><span class="style10">();
    </span><span class="style11">modify_testcase</span><span class="style10">();

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">2000001</span><span class="style10">;
</span><span class="style16">string </span><span class="style11">s</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">z</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">p</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">TinhZ</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style4">0</span><span class="style10">, </span><span class="style11">r </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">r</span><span class="style10">) </span><span class="style11">x </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">z</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style11">l</span><span class="style10">+</span><span class="style4">1</span><span class="style10">], </span><span class="style11">r</span><span class="style10">-</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">s</span><span class="style10">[</span><span class="style11">x</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] == </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style11">x</span><span class="style10">]) </span><span class="style11">x</span><span class="style10">++;

        </span><span class="style11">z</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">- </span><span class="style4">1 </span><span class="style10">&gt; </span><span class="style11">r</span><span class="style10">){
            </span><span class="style11">l </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
            </span><span class="style11">r </span><span class="style10">= </span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">- </span><span class="style4">1</span><span class="style10">;
        }
    }
}

</span><span class="style5">void </span><span class="style11">KMP</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">p</span><span class="style10">[</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">k </span><span class="style10">&amp;&amp; </span><span class="style11">s</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] != </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">k </span><span class="style10">= </span><span class="style11">p</span><span class="style10">[</span><span class="style11">k</span><span class="style10">];
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">s</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] == </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">k</span><span class="style10">++;
        </span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">k</span><span class="style10">;
    }
}


</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">;
    </span><span class="style11">n </span><span class="style10">= </span><span class="style11">s</span><span class="style10">.</span><span class="style11">length</span><span class="style10">();
    </span><span class="style11">s </span><span class="style10">= </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">;
    </span><span class="style11">TinhZ</span><span class="style10">();
    </span><span class="style11">KMP</span><span class="style10">();

    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">f</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">f</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">) </span><span class="style11">f</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] += </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];

</span><span class="style2">//    up(i, 1, n) cout &lt;&lt; z[i] &lt;&lt; " ";
//    cout &lt;&lt; "\n";
//    up(i, 1, n) cout &lt;&lt; f[i] &lt;&lt; " ";
//    cout &lt;&lt; "\n";

    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &gt;= </span><span class="style4">3 </span><span class="style10">&amp;&amp; </span><span class="style11">z</span><span class="style10">[</span><span class="style11">n</span><span class="style10">-</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] == </span><span class="style11">i</span><span class="style10">){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">s</span><span class="style10">.</span><span class="style16">substr</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style11">i</span><span class="style10">);
            </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"No solution!"</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">t</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">compress</span><span class="style10">(</span><span class="style5">int </span><span class="style11">q</span><span class="style10">[], </span><span class="style5">int </span><span class="style11">l</span><span class="style10">){
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">v</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">q</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">q</span><span class="style10">+</span><span class="style11">l</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">l</span><span class="style10">){
        </span><span class="style11">q</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">q</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">() + </span><span class="style4">1</span><span class="style10">;
    }
}

</span><span class="style5">int </span><span class="style11">get</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">];
        </span><span class="style11">x </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] += </span><span class="style11">val</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">t</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];

</span><span class="style2">//    compress(a, n);
//    compress(t, m);

    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style16">greater</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;());

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">r </span><span class="style10">= </span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">mid</span><span class="style10">] - </span><span class="style11">get</span><span class="style10">(</span><span class="style11">mid</span><span class="style10">) &lt; </span><span class="style11">t</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">r </span><span class="style10">= </span><span class="style11">mid</span><span class="style10">;
            </span><span class="style5">else </span><span class="style11">l </span><span class="style10">= </span><span class="style11">mid</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">r</span><span class="style10">-</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        </span><span class="style11">update</span><span class="style10">(</span><span class="style11">l</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
        </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    }
</span><span class="style2">//    up(i, 1, n) cout &lt;&lt; BIT[i] &lt;&lt; " ";
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">]; </span><span class="style2">// How many candies eaten
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">int </span><span class="style11">Find</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){ </span><span class="style2">// Find lowest i in a[] such that a[i] &gt;= x
    </span><span class="style5">int </span><span class="style11">pos </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style2">// Target pos
    </span><span class="style5">int </span><span class="style11">sum </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style2">// Prefix sum
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">log2</span><span class="style10">(</span><span class="style11">n</span><span class="style10">); </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">bi </span><span class="style10">= </span><span class="style11">pos </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bi </span><span class="style10">&lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">bi</span><span class="style10">] - (</span><span class="style11">sum </span><span class="style10">+ </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">bi</span><span class="style10">]) &lt; </span><span class="style11">x</span><span class="style10">){
            </span><span class="style11">pos </span><span class="style10">= </span><span class="style11">bi</span><span class="style10">; </span><span class="style2">// liftup
            </span><span class="style11">sum </span><span class="style10">+= </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">bi</span><span class="style10">];
        }
    }
    </span><span class="style5">return </span><span class="style11">pos</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] += </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">x</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">t </span><span class="style10">= </span><span class="style11">Find</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; (</span><span class="style11">n</span><span class="style10">-</span><span class="style11">t</span><span class="style10">+</span><span class="style4">1</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        </span><span class="style11">update</span><span class="style10">(</span><span class="style11">t</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style15">/// Exponential search
/// reference : https://codeforces.com/blog/entry/61364

</span><span class="style9">#include &lt;bits/stdc++.h&gt;

#define Task                    "CANDIES"
#define bit(x,i)                (x &amp; (1 &lt;&lt; (i)))
#define up(i,a,b)               for (int i = (a); i &lt;= (b); i++)
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">4</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">4</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">x</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">build</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">) {
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
}

</span><span class="style5">void </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">t </span><span class="style10">= </span><span class="style11">d</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">k</span><span class="style10">] += </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] += </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">k</span><span class="style10">] += </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] += </span><span class="style11">t</span><span class="style10">;

    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">upd</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">w</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] += </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">d</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] += </span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }

    </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">upd</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">, </span><span class="style11">w</span><span class="style10">);
    </span><span class="style11">upd</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">w</span><span class="style10">);
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]) + </span><span class="style11">d</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">];
}

</span><span class="style5">int </span><span class="style11">Find</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){ </span><span class="style2">// Quy uoc, vi tri can tim la r
//    cout &lt;&lt; nod &lt;&lt; " ";
                                // l, r la doan tim nhi phan
                                // (Thoa man): luong keo trong hop co lon hon x?
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">) </span><span class="style5">return </span><span class="style11">r</span><span class="style10">;       </span><span class="style2">// Node chi quan ly 1 phan tu duy nhat -&gt; r la dap an
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] &lt; </span><span class="style11">x</span><span class="style10">) </span><span class="style5">return </span><span class="style11">r</span><span class="style10">+</span><span class="style4">1</span><span class="style10">; </span><span class="style2">// Neu khoang dang xet khong thoa man -&gt; Toi da la an keo duoc den r+1
    // Neu no thoa man ? Bin search: Lieu ta co the an keo nhieu hon ma van thoa man?
    </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">);

    </span><span class="style15">/// KINH DIEN : Chi lazypush khi can thiet, khi ta van co the de quy xuong cac nut con duoc
    /// Neu lazypush tuy tien ? -&gt; cac node duoc push khong can thiet,
    ///                         -&gt; Khi (l == r), chi so node duoc push co the len den 8N  !! -&gt; RTE
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">] &lt; </span><span class="style11">x</span><span class="style10">)
    </span><span class="style5">return </span><span class="style11">Find</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style5">return </span><span class="style11">Find</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">t </span><span class="style10">= </span><span class="style11">Find</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; (</span><span class="style11">n</span><span class="style10">-</span><span class="style11">t</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        </span><span class="style11">u </span><span class="style10">= </span><span class="style11">t</span><span class="style10">;
        </span><span class="style11">v </span><span class="style10">= </span><span class="style11">n</span><span class="style10">;
        </span><span class="style11">upd</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define f first
#define s second
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"CROWDED.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"CROWDED.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">d</span><span class="style10">;
</span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style4">50001</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">l</span><span class="style10">[</span><span class="style4">50001</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">r</span><span class="style10">[</span><span class="style4">50001</span><span class="style10">];
</span><span class="style16">deque</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">de</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">left</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">front</span><span class="style10">()].</span><span class="style11">f </span><span class="style10">+ </span><span class="style11">d </span><span class="style10">&lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">) </span><span class="style11">de</span><span class="style10">.</span><span class="style16">pop_front</span><span class="style10">(); </span><span class="style2">// con bo dang xet nam ngoai khoang ? - khong xet den
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">&gt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">back</span><span class="style10">()].</span><span class="style11">s</span><span class="style10">) </span><span class="style11">de</span><span class="style10">.</span><span class="style16">pop_back</span><span class="style10">();      </span><span class="style2">// con bo dang xet co chieu cao lon hon ca con bo cuoi cung ? - khong tinh
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">*</span><span class="style4">2 </span><span class="style10">&lt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">front</span><span class="style10">()].</span><span class="style11">s</span><span class="style10">) </span><span class="style11">l</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;           </span><span class="style2">// cao hon den muc nao ? (theo de bai) the la ngot ngat ben trai
        </span><span class="style11">de</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">right</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f </span><span class="style10">+ </span><span class="style11">d </span><span class="style10">&lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">front</span><span class="style10">()].</span><span class="style11">f</span><span class="style10">) </span><span class="style11">de</span><span class="style10">.</span><span class="style16">pop_front</span><span class="style10">();
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">&gt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">back</span><span class="style10">()].</span><span class="style11">s</span><span class="style10">) </span><span class="style11">de</span><span class="style10">.</span><span class="style16">pop_back</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">*</span><span class="style4">2 </span><span class="style10">&lt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">front</span><span class="style10">()].</span><span class="style11">s</span><span class="style10">) </span><span class="style11">r</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;          </span><span class="style2">// tuong tu: ngot ngat ben phai
        </span><span class="style11">de</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
}
</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">d</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) {
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">;
    }
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">left</span><span class="style10">();
    </span><span class="style11">de </span><span class="style10">= </span><span class="style16">deque</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;{};
    </span><span class="style11">right</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &amp;&amp; </span><span class="style11">r</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">res</span><span class="style10">++;
    }
    </span><span class="style2">//for (int i = 1; i &lt;= n; i++) cout &lt;&lt; l[i] &lt;&lt; " " &lt;&lt; r[i] &lt;&lt; "\n";
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1000001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">i</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">Union</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">v</span><span class="style10">) </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">Find</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">) == </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">));
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">q</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style11">Union</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">Find</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style11">pii t</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">res</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">sizee</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">i</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">joinn</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">sizee</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] += </span><span class="style11">sizee</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style11">pii x</span><span class="style10">, </span><span class="style11">pii y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f </span><span class="style10">&gt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">f</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">t</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">;
        </span><span class="style11">t</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
        </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">sizee</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">t</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">t</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">t</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style11">joinn</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
        }
        </span><span class="style5">int </span><span class="style11">pos </span><span class="style10">= </span><span class="style11">sizee</span><span class="style10">[</span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">)];
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">res</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">] == -</span><span class="style4">1</span><span class="style10">) </span><span class="style11">res</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">] = </span><span class="style11">t</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">;
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;

    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100005</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">res</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">3</span><span class="style10">];
</span><span class="style11">pii a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">get</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">get</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">calc</span><span class="style10">(</span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">bool </span><span class="style11">ok </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">cur </span><span class="style10">= </span><span class="style11">l</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">des </span><span class="style10">= </span><span class="style11">get</span><span class="style10">(</span><span class="style11">r</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">cur </span><span class="style10">&lt;= </span><span class="style11">r</span><span class="style10">){ </span><span class="style2">// ?? r+1, do ta chon r+1 lam dai dien cho toan bo cum sector
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">get</span><span class="style10">(</span><span class="style11">cur</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">cur</span><span class="style10">) </span><span class="style11">ok </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">par</span><span class="style10">[</span><span class="style11">cur</span><span class="style10">] = </span><span class="style11">des</span><span class="style10">;
        </span><span class="style11">cur </span><span class="style10">= </span><span class="style11">u</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
    }
    </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">ok</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style11">r</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">l </span><span class="style10">&gt;&gt; </span><span class="style11">r</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = {</span><span class="style11">l</span><span class="style10">, </span><span class="style11">r</span><span class="style10">};
        </span><span class="style11">v</span><span class="style10">.</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">l</span><span class="style10">);
        </span><span class="style11">v</span><span class="style10">.</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">r</span><span class="style10">);
    }

    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style11">v</span><span class="style10">.</span><span class="style16">resize</span><span class="style10">(</span><span class="style16">unique</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">()) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">());

    </span><span class="style11">n </span><span class="style10">= </span><span class="style11">v</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">m</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f </span><span class="style10">= </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">() + </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">= </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">() + </span><span class="style4">1</span><span class="style10">;
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        </span><span class="style11">calc</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">, </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">);
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}
</span><span class="style2">// omg a really hard time for debuging

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">3</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">l</span><span class="style10">,</span><span class="style11">r</span><span class="style10">,</span><span class="style11">x</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">res</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">init</span><span class="style10">(){
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
    }
}

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">init</span><span class="style10">();
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">l </span><span class="style10">&gt;&gt; </span><span class="style11">r </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">des </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">r</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&lt;= </span><span class="style11">r</span><span class="style10">){
</span><span class="style2">//            up(i, 1, n) cout &lt;&lt; par[i] &lt;&lt; " ";
//            cout &lt;&lt; "\n";
//            up(i, 1, n) cout &lt;&lt; res[i] &lt;&lt; " ";
//            cout &lt;&lt; "\n" &lt;&lt; "\n";
            </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">l</span><span class="style10">);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">&gt; </span><span class="style11">r</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">&lt; </span><span class="style11">x</span><span class="style10">){
                </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
                </span><span class="style11">res</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
            }
            </span><span class="style5">else if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">&gt; </span><span class="style11">x</span><span class="style10">){
                </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">des</span><span class="style10">;
                </span><span class="style11">res</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
            }
            </span><span class="style11">l </span><span class="style10">= </span><span class="style11">u </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        }

    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}


</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1003</span><span class="style10">;  </span><span class="style2">// 10^3 maxn
</span><span class="style5">const int </span><span class="style11">dx</span><span class="style10">[</span><span class="style4">5</span><span class="style10">] = {</span><span class="style4">0</span><span class="style10">,</span><span class="style4">0</span><span class="style10">,</span><span class="style4">0</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,-</span><span class="style4">1</span><span class="style10">};
</span><span class="style5">const int </span><span class="style11">dy</span><span class="style10">[</span><span class="style4">5</span><span class="style10">] = {</span><span class="style4">0</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,-</span><span class="style4">1</span><span class="style10">,</span><span class="style4">0</span><span class="style10">,</span><span class="style4">0</span><span class="style10">};

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">res</span><span class="style10">[</span><span class="style4">10</span><span class="style10">*</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">color</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cnt </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">dem </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">xx1</span><span class="style10">,</span><span class="style11">xx2</span><span class="style10">,</span><span class="style11">yy1</span><span class="style10">,</span><span class="style11">yy2</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">td</span><span class="style10">[</span><span class="style4">10</span><span class="style10">*</span><span class="style11">maxn</span><span class="style10">]; </span><span class="style2">// 10^4 q

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">root</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style5">return </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
}

</span><span class="style5">void </span><span class="style11">joinn</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style4">0 </span><span class="style10">|| </span><span class="style11">v </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">cnt</span><span class="style10">--;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">color</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] = ++</span><span class="style11">dem</span><span class="style10">;
    </span><span class="style11">cnt</span><span class="style10">++;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">4</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">ux </span><span class="style10">= </span><span class="style11">u </span><span class="style10">+ </span><span class="style11">dx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style5">int </span><span class="style11">vx </span><span class="style10">= </span><span class="style11">v </span><span class="style10">+ </span><span class="style11">dy</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">joinn</span><span class="style10">(</span><span class="style11">dem</span><span class="style10">, </span><span class="style11">color</span><span class="style10">[</span><span class="style11">ux</span><span class="style10">][</span><span class="style11">vx</span><span class="style10">]);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">q</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">xx1 </span><span class="style10">&gt;&gt; </span><span class="style11">yy1 </span><span class="style10">&gt;&gt; </span><span class="style11">xx2 </span><span class="style10">&gt;&gt; </span><span class="style11">yy2</span><span class="style10">;
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">xx1</span><span class="style10">, </span><span class="style11">xx2</span><span class="style10">){
            </span><span class="style11">up</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">yy1</span><span class="style10">, </span><span class="style11">yy2</span><span class="style10">){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">color</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">){
                    </span><span class="style11">color</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
                    </span><span class="style11">td</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">});
                }
            }
        }
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">color</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">]){
                </span><span class="style11">td</span><span class="style10">[</span><span class="style11">q</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">});
            }
        }
    }

    </span><span class="style11">reset</span><span class="style10">(</span><span class="style11">color</span><span class="style10">);
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">q</span><span class="style10">+</span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">x </span><span class="style10">: </span><span class="style11">td</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">, </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">);
        }
        </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">] = </span><span class="style11">cnt</span><span class="style10">;
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">q</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">typedef long long </span><span class="style11">ll</span><span class="style10">;
</span><span class="style5">typedef </span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">pii</span><span class="style10">;
</span><span class="style5">typedef </span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style11">ll</span><span class="style10">&gt; </span><span class="style11">pill</span><span class="style10">;
</span><span class="style5">typedef </span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style11">ll</span><span class="style10">, </span><span class="style11">ll</span><span class="style10">&gt; </span><span class="style11">pll</span><span class="style10">;

</span><span class="style9">#define mod 1000000007
#define mod2 1000000014000000049
#define x 1000007
#define x2 2000009
#define maxn 1000001

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style11">pll h</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">calh</span><span class="style10">(){
    </span><span class="style11">h</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] = {</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">};
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i </span><span class="style10">++){
        </span><span class="style11">h</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">first </span><span class="style10">= (</span><span class="style11">h</span><span class="style10">[</span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">].</span><span class="style11">first </span><span class="style10">* </span><span class="style11">x</span><span class="style10">) % </span><span class="style11">mod</span><span class="style10">;
        </span><span class="style11">h</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">second </span><span class="style10">= (</span><span class="style11">h</span><span class="style10">[</span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">].</span><span class="style11">second </span><span class="style10">* </span><span class="style11">x2</span><span class="style10">) % </span><span class="style11">mod</span><span class="style10">;
    }
}

</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pll</span><span class="style10">&gt; </span><span class="style11">Hash</span><span class="style10">(</span><span class="style16">string </span><span class="style10">&amp; </span><span class="style11">s</span><span class="style10">){
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pll</span><span class="style10">&gt;</span><span class="style11">res</span><span class="style10">(</span><span class="style11">s</span><span class="style10">.</span><span class="style16">size</span><span class="style10">(), {</span><span class="style4">0</span><span class="style10">, </span><span class="style4">0</span><span class="style10">});
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">s</span><span class="style10">.</span><span class="style16">size</span><span class="style10">(); </span><span class="style11">i </span><span class="style10">++){
        </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">first </span><span class="style10">= (</span><span class="style11">res</span><span class="style10">[</span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">].</span><span class="style11">first </span><span class="style10">* </span><span class="style11">x </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) % </span><span class="style11">mod</span><span class="style10">;
        </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">second </span><span class="style10">= (</span><span class="style11">res</span><span class="style10">[</span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">].</span><span class="style11">second </span><span class="style10">* </span><span class="style11">x2 </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) % </span><span class="style11">mod</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style11">pll get</span><span class="style10">(</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pll</span><span class="style10">&gt; &amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style11">ll t </span><span class="style10">= (</span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">].</span><span class="style11">first </span><span class="style10">- </span><span class="style11">a</span><span class="style10">[</span><span class="style11">l </span><span class="style10">- </span><span class="style4">1</span><span class="style10">].</span><span class="style11">first </span><span class="style10">* </span><span class="style11">h</span><span class="style10">[</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">].</span><span class="style11">first </span><span class="style10">+ </span><span class="style11">mod2</span><span class="style10">) % </span><span class="style11">mod</span><span class="style10">;
    </span><span class="style11">ll k </span><span class="style10">= (</span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">].</span><span class="style11">second </span><span class="style10">- </span><span class="style11">a</span><span class="style10">[</span><span class="style11">l </span><span class="style10">- </span><span class="style4">1</span><span class="style10">].</span><span class="style11">second </span><span class="style10">* </span><span class="style11">h</span><span class="style10">[</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">].</span><span class="style11">second </span><span class="style10">+ </span><span class="style11">mod2</span><span class="style10">) % </span><span class="style11">mod</span><span class="style10">;
    </span><span class="style5">return </span><span class="style10">{</span><span class="style11">t</span><span class="style10">, </span><span class="style11">k</span><span class="style10">};
}

</span><span class="style5">bool </span><span class="style11">check</span><span class="style10">(</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pll</span><span class="style10">&gt; &amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style16">vector</span><span class="style10">&lt; </span><span class="style11">pll</span><span class="style10">&gt; &amp; </span><span class="style11">b</span><span class="style10">, </span><span class="style5">int </span><span class="style11">k</span><span class="style10">){
    </span><span class="style16">map</span><span class="style10">&lt;</span><span class="style11">pll</span><span class="style10">, </span><span class="style5">bool</span><span class="style10">&gt; </span><span class="style11">mp</span><span class="style10">;
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i </span><span class="style10">++){
        </span><span class="style11">mp</span><span class="style10">[</span><span class="style11">get</span><span class="style10">(</span><span class="style11">a</span><span class="style10">, </span><span class="style11">i</span><span class="style10">, </span><span class="style11">k </span><span class="style10">+ </span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">)] = </span><span class="style5">true</span><span class="style10">;
    }
    </span><span class="style2">// for(auto i : mp){
    //     cout &lt;&lt; i.first.first &lt;&lt; " " &lt;&lt; i.first.second &lt;&lt; endl;
    // }
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i </span><span class="style10">++){
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">mp</span><span class="style10">[</span><span class="style11">get</span><span class="style10">(</span><span class="style11">b</span><span class="style10">, </span><span class="style11">i</span><span class="style10">, </span><span class="style11">k </span><span class="style10">+ </span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">)]) </span><span class="style5">return </span><span class="style4">1</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">string </span><span class="style11">a</span><span class="style10">, </span><span class="style11">b</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a </span><span class="style10">&gt;&gt; </span><span class="style11">b</span><span class="style10">;
    </span><span class="style11">n </span><span class="style10">= </span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style11">a </span><span class="style10">= </span><span class="style6">"#" </span><span class="style10">+ </span><span class="style11">a </span><span class="style10">+ </span><span class="style11">a</span><span class="style10">;
    </span><span class="style11">b </span><span class="style10">= </span><span class="style6">"#" </span><span class="style10">+ </span><span class="style11">b </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">calh</span><span class="style10">();
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pll</span><span class="style10">&gt; </span><span class="style11">hsa </span><span class="style10">= </span><span class="style11">Hash</span><span class="style10">(</span><span class="style11">a</span><span class="style10">);
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pll</span><span class="style10">&gt; </span><span class="style11">hsb </span><span class="style10">= </span><span class="style11">Hash</span><span class="style10">(</span><span class="style11">b</span><span class="style10">);
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">log2</span><span class="style10">(</span><span class="style11">n</span><span class="style10">); </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">--){
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">res </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) &lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">check</span><span class="style10">(</span><span class="style11">hsa</span><span class="style10">, </span><span class="style11">hsb</span><span class="style10">, </span><span class="style11">res </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">))) </span><span class="style11">res </span><span class="style10">+= </span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">c</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">long long </span><span class="style11">F</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">6</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">scanf</span><span class="style10">(</span><span class="style6">"%d%d%d"</span><span class="style10">, &amp;</span><span class="style11">n</span><span class="style10">, &amp;</span><span class="style11">m</span><span class="style10">, &amp;</span><span class="style11">k</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">scanf</span><span class="style10">(</span><span class="style6">"%d"</span><span class="style10">, &amp;</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
        </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]--;
    }
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style11">scanf</span><span class="style10">(</span><span class="style6">"%d%d"</span><span class="style10">, &amp;</span><span class="style11">u</span><span class="style10">, &amp;</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">u</span><span class="style10">--;
        </span><span class="style11">v</span><span class="style10">--;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">F</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]][</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">k</span><span class="style10">)-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">c</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) == </span><span class="style4">0</span><span class="style10">){
                    </span><span class="style11">F</span><span class="style10">[</span><span class="style11">x </span><span class="style10">| (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">c</span><span class="style10">[</span><span class="style11">v</span><span class="style10">])][</span><span class="style11">v</span><span class="style10">] += </span><span class="style11">F</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">u</span><span class="style10">];
                }
            }
        }
    }

</span><span class="style2">//    up(i, 0, (1 &lt;&lt; k) - 1){
//        cout &lt;&lt; i &lt;&lt; " ";
//        up(j, 0, n-1){
//            printf("%d ", F[i][j]);
//        }
//        printf("\n");
//    }

    </span><span class="style5">long long </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">k</span><span class="style10">)-</span><span class="style4">1</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">__builtin_popcount</span><span class="style10">(</span><span class="style11">x</span><span class="style10">) &gt;= </span><span class="style4">2</span><span class="style10">) </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">F</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
}
</span><span class="style5">int </span><span class="style11">Pi</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">string </span><span class="style11">s</span><span class="style10">,</span><span class="style11">t</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">KMP</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">Pi</span><span class="style10">[</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">k </span><span class="style10">&amp;&amp; </span><span class="style11">s</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] != </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">k </span><span class="style10">= </span><span class="style11">Pi</span><span class="style10">[</span><span class="style11">k</span><span class="style10">];
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">s</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] == </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">k</span><span class="style10">++;
        </span><span class="style11">Pi</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">k</span><span class="style10">;
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s </span><span class="style10">&gt;&gt; </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">m </span><span class="style10">= </span><span class="style11">t</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style11">s </span><span class="style10">= </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">t </span><span class="style10">+ </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">;
    </span><span class="style11">n </span><span class="style10">= </span><span class="style11">s</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style11">KMP</span><span class="style10">();
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) {
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Pi</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] == </span><span class="style11">m</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">i </span><span class="style10">- </span><span class="style4">2</span><span class="style10">*</span><span class="style11">m </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">2000001</span><span class="style10">;
</span><span class="style16">string </span><span class="style11">s</span><span class="style10">;
</span><span class="style16">string </span><span class="style11">t</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">z</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">TinhZ</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style4">0</span><span class="style10">, </span><span class="style11">r </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">r</span><span class="style10">) </span><span class="style11">x </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">z</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style11">l</span><span class="style10">+</span><span class="style4">1</span><span class="style10">], </span><span class="style11">r</span><span class="style10">-</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">s</span><span class="style10">[</span><span class="style11">x</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] == </span><span class="style11">s</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style11">x</span><span class="style10">]) </span><span class="style11">x</span><span class="style10">++;

        </span><span class="style11">z</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">- </span><span class="style4">1 </span><span class="style10">&gt; </span><span class="style11">r</span><span class="style10">){
            </span><span class="style11">l </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
            </span><span class="style11">r </span><span class="style10">= </span><span class="style11">i </span><span class="style10">+ </span><span class="style11">x </span><span class="style10">- </span><span class="style4">1</span><span class="style10">;
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">s </span><span class="style10">= </span><span class="style11">t </span><span class="style10">+ </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">m </span><span class="style10">= </span><span class="style11">t</span><span class="style10">.</span><span class="style11">length</span><span class="style10">();
    </span><span class="style11">n </span><span class="style10">= </span><span class="style11">s</span><span class="style10">.</span><span class="style11">length</span><span class="style10">();
    </span><span class="style11">s </span><span class="style10">= </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">;
    </span><span class="style11">TinhZ</span><span class="style10">();

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">z</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &gt;= </span><span class="style11">m</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">-</span><span class="style11">m</span><span class="style10">-</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style5">nullptr</span><span class="style10">), </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style5">nullptr</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">S</span><span class="style10">, </span><span class="style11">F</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">c</span><span class="style10">[</span><span class="style4">16</span><span class="style10">][</span><span class="style4">16</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">16</span><span class="style10">]; </span><span class="style2">//bieu dien trang thai nguoi i -&gt; j va j -&gt; i
</span><span class="style16">map</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">mm</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">sum </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">S </span><span class="style10">&gt;&gt; </span><span class="style11">F</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">));
    </span><span class="style5">while </span><span class="style10">(</span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">){
        </span><span class="style11">u</span><span class="style10">--, </span><span class="style11">v</span><span class="style10">--;
        </span><span class="style11">c</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">sum </span><span class="style10">+= </span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">pr </span><span class="style10">= (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">u</span><span class="style10">) + (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">v</span><span class="style10">); </span><span class="style2">// trang thai toi uu nhat khi u va v lien lac voi nhau
        </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">pr</span><span class="style10">] += </span><span class="style11">w</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">dp_bit</span><span class="style10">(){
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">)-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){ </span><span class="style2">// tai sao lai tu i+1 ma khong phai tu 0 va != 1 ? :
                               // ro rang chung ta co the chon lon truoc be sau, hoac be truoc lon sau, khong toi gi phai chon ca be va lon
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">i</span><span class="style10">) &amp;&amp; </span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">j</span><span class="style10">)){ </span><span class="style2">// tai sao for kieu gi cung ra ket qua ket qua dung ?: vi for the nao thi cung la duyet qua trang thai truoc cua x thoi :)
                    </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x </span><span class="style10">&amp;~ ((</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) | (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">j</span><span class="style10">));
                    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] &lt;= </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] + </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]){   </span><span class="style2">// tai sao la &lt;= ma khong phai &lt; : toi uu lien tuc cho viec truy vet
                        </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] + </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
                        </span><span class="style11">mm</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style11">MP</span><span class="style10">(</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">j</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
                    }
                }
            }
        }
    }

</span><span class="style2">//    for (auto [i, p] : mm){
//        cout &lt;&lt; i &lt;&lt; " " &lt;&lt; p.f &lt;&lt; " " &lt;&lt; p.s &lt;&lt; "\n";
//    }
//    rollup(i, 0, (1 &lt;&lt; (n)) - 1){
//        cout &lt;&lt; dp[i] &lt;&lt; " ";
//    }
//    cout &lt;&lt; endl;
    </span><span class="style5">int </span><span class="style11">s </span><span class="style10">= </span><span class="style11">dp</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">];
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; (</span><span class="style11">sum </span><span class="style10">- </span><span class="style11">s</span><span class="style10">)*</span><span class="style11">F </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">*</span><span class="style11">S</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">Trace</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">fi </span><span class="style10">= (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">fi</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">a </span><span class="style10">= </span><span class="style11">mm</span><span class="style10">[</span><span class="style11">fi</span><span class="style10">].</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">b </span><span class="style10">= </span><span class="style11">mm</span><span class="style10">[</span><span class="style11">fi</span><span class="style10">].</span><span class="style11">s</span><span class="style10">;
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">a </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">b </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        </span><span class="style11">fi </span><span class="style10">= </span><span class="style11">fi </span><span class="style10">- (</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">a</span><span class="style10">-</span><span class="style4">1</span><span class="style10">)) - (</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">b</span><span class="style10">-</span><span class="style4">1</span><span class="style10">));
    }
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">dp_bit</span><span class="style10">();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style16">endl</span><span class="style10">;
    </span><span class="style11">Trace</span><span class="style10">();
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style15">/// WARNING : ??!!
</span><span class="style1">/*
    * int overflow ?
    * array bounds ?
    * special cases (n = 1, n = 0) ?
    * uncontrolled loop ?
    * int or long long ?
    * positive or negative ?
    * divided by 0 ?
    * reset ?
*/

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">2</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">Array</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">pos</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">low</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">up</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">door</span><span class="style10">;
};
</span><span class="style5">struct </span><span class="style11">Segment_tree</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">cnt</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">val</span><span class="style10">;
};
</span><span class="style11">Array save</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">2</span><span class="style10">];
</span><span class="style11">Segment_tree T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">2</span><span class="style10">*</span><span class="style4">4</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">bool </span><span class="style11">compare</span><span class="style10">(</span><span class="style5">const </span><span class="style11">Array</span><span class="style10">&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style5">const </span><span class="style11">Array</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">pos </span><span class="style10">== </span><span class="style11">y</span><span class="style10">.</span><span class="style11">pos</span><span class="style10">) </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">door </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">door</span><span class="style10">);
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">pos </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">pos</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">d</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">cnt </span><span class="style10">+= </span><span class="style11">d</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        }
        </span><span class="style5">else if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">cnt </span><span class="style10">== </span><span class="style4">0</span><span class="style10">){
            </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">].</span><span class="style11">val </span><span class="style10">+ </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val</span><span class="style10">;
        }
        </span><span class="style5">return</span><span class="style10">;
    }

    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">cnt </span><span class="style10">== </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">].</span><span class="style11">val </span><span class="style10">+ </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val</span><span class="style10">;
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">maxy </span><span class="style10">= -</span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">x1</span><span class="style10">, </span><span class="style11">x2</span><span class="style10">, </span><span class="style11">y1</span><span class="style10">, </span><span class="style11">y2</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x1 </span><span class="style10">&gt;&gt; </span><span class="style11">x2 </span><span class="style10">&gt;&gt; </span><span class="style11">y1 </span><span class="style10">&gt;&gt; </span><span class="style11">y2</span><span class="style10">;
        </span><span class="style11">x1</span><span class="style10">++;
        </span><span class="style11">x2</span><span class="style10">++;
        </span><span class="style11">y1</span><span class="style10">++;
        </span><span class="style11">y2</span><span class="style10">++;
        </span><span class="style11">save</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = {</span><span class="style11">x1</span><span class="style10">, </span><span class="style11">y1</span><span class="style10">, </span><span class="style11">y2</span><span class="style10">, </span><span class="style4">1</span><span class="style10">};
        </span><span class="style11">save</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style11">n</span><span class="style10">] = {</span><span class="style11">x2</span><span class="style10">, </span><span class="style11">y1</span><span class="style10">, </span><span class="style11">y2</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">};
        </span><span class="style11">maxy </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxy</span><span class="style10">, </span><span class="style11">y1</span><span class="style10">), </span><span class="style11">y2</span><span class="style10">);
    }
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">save</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">save</span><span class="style10">+</span><span class="style11">n</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">compare</span><span class="style10">);
</span><span class="style2">//    up(i, 1, 2*n){
//        cout &lt;&lt; save[i].pos &lt;&lt; " " &lt;&lt; save[i].upper &lt;&lt; " " &lt;&lt; save[i].lower &lt;&lt; " " &lt;&lt; save[i].door &lt;&lt; "\n";
//    }

    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">*</span><span class="style4">2</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">T</span><span class="style10">[</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val </span><span class="style10">* (</span><span class="style11">save</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">pos </span><span class="style10">- </span><span class="style11">save</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">].</span><span class="style11">pos</span><span class="style10">);
        </span><span class="style11">u </span><span class="style10">= </span><span class="style11">save</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">low</span><span class="style10">;
        </span><span class="style11">v </span><span class="style10">= </span><span class="style11">save</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">up</span><span class="style10">-</span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">d </span><span class="style10">= </span><span class="style11">save</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">door</span><span class="style10">;
        </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">maxy</span><span class="style10">);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}


</span><span class="style2">//http://cpp.sh/2cd2b
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">string </span><span class="style11">a</span><span class="style10">[</span><span class="style4">16</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">c</span><span class="style10">[</span><span class="style4">16</span><span class="style10">][</span><span class="style4">16</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">15</span><span class="style10">][</span><span class="style4">16</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }
}

</span><span class="style5">void </span><span class="style11">initcost</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style5">int </span><span class="style11">cost </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                </span><span class="style11">cost </span><span class="style10">+= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">] ^ </span><span class="style11">a</span><span class="style10">[</span><span class="style11">j</span><span class="style10">][</span><span class="style11">k</span><span class="style10">];
            }
            </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style11">cost</span><span class="style10">;
        }
    }
}

</span><span class="style5">void </span><span class="style11">basis</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">m</span><span class="style10">); </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] + </span><span class="style11">m </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style4">10000001</span><span class="style10">);
    }
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">int </span><span class="style11">dem </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] == </span><span class="style7">'1'</span><span class="style10">) </span><span class="style11">dem</span><span class="style10">++;
        }
        </span><span class="style11">f</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))][</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">dem</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">Dp_bit</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">state </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">state </span><span class="style10">&lt; (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">m</span><span class="style10">); </span><span class="style11">state</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">!= </span><span class="style11">k </span><span class="style10">&amp;&amp; </span><span class="style11">state </span><span class="style10">&gt;&gt; (</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) &amp; </span><span class="style4">1 </span><span class="style10">&amp;&amp; </span><span class="style11">state </span><span class="style10">&gt;&gt; (</span><span class="style11">k</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) &amp; </span><span class="style4">1</span><span class="style10">){
                    </span><span class="style11">f</span><span class="style10">[</span><span class="style11">state</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">state</span><span class="style10">][</span><span class="style11">i</span><span class="style10">], </span><span class="style11">f</span><span class="style10">[</span><span class="style11">state </span><span class="style10">- (</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))][</span><span class="style11">k</span><span class="style10">] + </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">]);
                }
            }
        }
    }
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">IOS
    setFile</span><span class="style10">();
    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">initcost</span><span class="style10">();
    </span><span class="style11">basis</span><span class="style10">();
    </span><span class="style11">Dp_bit</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">minn </span><span class="style10">= </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">minn </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minn</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">m</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">minn</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1000001</span><span class="style10">;
</span><span class="style5">const long long </span><span class="style11">MM </span><span class="style10">= </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">MOD</span><span class="style10">*</span><span class="style11">MOD</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">H</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">B</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">string </span><span class="style11">a</span><span class="style10">,</span><span class="style11">b</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">gethash</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">B</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] - </span><span class="style11">B</span><span class="style10">[</span><span class="style11">u</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]*</span><span class="style11">H</span><span class="style10">[</span><span class="style11">n</span><span class="style10">] + </span><span class="style11">MM</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a </span><span class="style10">&gt;&gt; </span><span class="style11">b</span><span class="style10">;
    </span><span class="style11">n </span><span class="style10">= </span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style11">m </span><span class="style10">= </span><span class="style11">b</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style11">a </span><span class="style10">= </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">a</span><span class="style10">;
    </span><span class="style11">b </span><span class="style10">= </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;

    </span><span class="style5">int </span><span class="style11">hashA </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">hashA </span><span class="style10">= (</span><span class="style11">hashA</span><span class="style10">*</span><span class="style11">base </span><span class="style10">+ </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
    } </span><span class="style2">// Hash code of string a

    </span><span class="style11">H</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">B</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = (</span><span class="style11">B</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]*</span><span class="style11">base </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
        </span><span class="style2">// Hash code of substrings from 1 to i in b
        </span><span class="style11">H</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = (</span><span class="style11">H</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]*</span><span class="style11">base</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
        </span><span class="style2">// Decryptor
    </span><span class="style10">}

    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">v </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">v</span><span class="style10">++){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">v </span><span class="style10">- </span><span class="style11">n </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">gethash</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">) == </span><span class="style11">hashA</span><span class="style10">){
            </span><span class="style11">res</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">x </span><span class="style10">: </span><span class="style11">res</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">x </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1000001</span><span class="style10">;
</span><span class="style5">const long long </span><span class="style11">MM </span><span class="style10">= </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">MOD</span><span class="style10">*</span><span class="style11">MOD</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">string </span><span class="style11">s</span><span class="style10">;
</span><span class="style11">pii S</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style11">pii R</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">res</span><span class="style10">[</span><span class="style4">100008</span><span class="style10">];

</span><span class="style5">long long </span><span class="style11">gethash</span><span class="style10">(</span><span class="style16">string </span><span class="style11">t</span><span class="style10">){
    </span><span class="style5">long long </span><span class="style11">vhash </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">nn </span><span class="style10">= </span><span class="style11">t</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style11">t </span><span class="style10">= </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">t</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">nn</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">vhash </span><span class="style10">= (</span><span class="style11">vhash</span><span class="style10">*</span><span class="style11">base </span><span class="style10">+ </span><span class="style11">t</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style11">vhash</span><span class="style10">;
}

</span><span class="style2">//bool cmp1(pii x, pii y){
//    if (x.f == y.f) return (x.s &lt; y.s);
//    return (x.f &lt; y.f);
//}

</span><span class="style5">bool </span><span class="style11">cmp2</span><span class="style10">(</span><span class="style11">pii x</span><span class="style10">, </span><span class="style11">pii y</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f </span><span class="style10">== </span><span class="style11">y</span><span class="style10">.</span><span class="style11">f</span><span class="style10">) </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">s </span><span class="style10">&gt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">s</span><span class="style10">);
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">f</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">;
    </span><span class="style11">s </span><span class="style10">= </span><span class="style7">'@' </span><span class="style10">+ </span><span class="style11">s</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">n</span><span class="style10">/</span><span class="style11">m</span><span class="style10">;
    </span><span class="style16">string </span><span class="style11">a</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">dem </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i </span><span class="style10">+= </span><span class="style11">u</span><span class="style10">){
        </span><span class="style11">a </span><span class="style10">= </span><span class="style11">s</span><span class="style10">.</span><span class="style16">substr</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">u</span><span class="style10">);
        </span><span class="style11">S</span><span class="style10">[</span><span class="style11">dem</span><span class="style10">] = </span><span class="style11">make_pair</span><span class="style10">(</span><span class="style11">gethash</span><span class="style10">(</span><span class="style11">a</span><span class="style10">), </span><span class="style11">dem</span><span class="style10">);
        </span><span class="style11">dem</span><span class="style10">++;
    }

    </span><span class="style11">dem </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">string </span><span class="style11">x</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
        </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">make_pair</span><span class="style10">(</span><span class="style11">gethash</span><span class="style10">(</span><span class="style11">x</span><span class="style10">), </span><span class="style11">i</span><span class="style10">);
    }

    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">S</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">S</span><span class="style10">+</span><span class="style11">m</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">R</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">R</span><span class="style10">+</span><span class="style11">m</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cmp2</span><span class="style10">);

</span><span class="style2">//    up(i, 1, m) {
//        cout &lt;&lt; S[i].f &lt;&lt; " " &lt;&lt; S[i].s &lt;&lt; "\n";
//    }
//    cout &lt;&lt; "\n";
//
//    for (int i = 1; i &lt;= m; i++){
//        cout &lt;&lt; R[i].f &lt;&lt; " " &lt;&lt; R[i].s &lt;&lt; "\n";
//    }
//    cout &lt;&lt; "\n";


    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style11">res</span><span class="style10">[</span><span class="style11">S</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">] = </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">;
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style2">//3956221
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1000001</span><span class="style10">;
</span><span class="style5">const long long </span><span class="style11">MM </span><span class="style10">= </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">MOD</span><span class="style10">*</span><span class="style11">MOD</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style11">ll a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style11">ll b</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style11">ll hashx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style11">ll hashn</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style11">ll D</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">]; </span><span class="style2">// Decryptor
</span><span class="style5">long long </span><span class="style11">hashB</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">create</span><span class="style10">(){
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">hashx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = (</span><span class="style11">hashx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]*</span><span class="style11">base </span><span class="style10">+ </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
    }
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">hashn</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = (</span><span class="style11">hashn</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]*</span><span class="style11">base </span><span class="style10">+ </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
    }
}

</span><span class="style11">ll getx</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">hashx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] - </span><span class="style11">hashx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]*</span><span class="style11">D</span><span class="style10">[</span><span class="style11">v</span><span class="style10">-</span><span class="style11">u</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] + </span><span class="style11">MM</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style11">ll getn</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">hashn</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] - </span><span class="style11">hashn</span><span class="style10">[</span><span class="style11">v</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]*</span><span class="style11">D</span><span class="style10">[</span><span class="style11">v</span><span class="style10">-</span><span class="style11">u</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] + </span><span class="style11">MM</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">check</span><span class="style10">(</span><span class="style5">int </span><span class="style11">k</span><span class="style10">){
    </span><span class="style5">long long </span><span class="style11">sum </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">((</span><span class="style11">n </span><span class="style10">- </span><span class="style11">k </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">) % </span><span class="style4">2 </span><span class="style10">== </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">sum </span><span class="style10">= (</span><span class="style11">hashx</span><span class="style10">[</span><span class="style11">k</span><span class="style10">-</span><span class="style4">1</span><span class="style10">] + </span><span class="style11">getx</span><span class="style10">(</span><span class="style11">k</span><span class="style10">, </span><span class="style11">n</span><span class="style10">)*</span><span class="style11">D</span><span class="style10">[</span><span class="style11">k</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
    }
    </span><span class="style5">else </span><span class="style10">{
        </span><span class="style11">sum </span><span class="style10">= (</span><span class="style11">getn</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style11">k</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) + </span><span class="style11">getx</span><span class="style10">(</span><span class="style11">k</span><span class="style10">, </span><span class="style11">n</span><span class="style10">)*</span><span class="style11">D</span><span class="style10">[</span><span class="style11">k</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
    }
    </span><span class="style15">/// Decryptor is generated from 1 to n, so it
    /// only has effect on (1 -&gt; n) hashed substring
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">sum </span><span class="style10">== </span><span class="style11">hashB</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">D</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = (</span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]*</span><span class="style11">base</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">hashB </span><span class="style10">= (</span><span class="style11">hashB</span><span class="style10">*</span><span class="style11">base </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
    }
    </span><span class="style11">create</span><span class="style10">();

    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">check</span><span class="style10">(</span><span class="style11">i</span><span class="style10">)) </span><span class="style11">res</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">x </span><span class="style10">: </span><span class="style11">res</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">x </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;

}

</span><span class="style15">///Template created by PPAP_1264589
</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style5">nullptr</span><span class="style10">), </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style5">nullptr</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">16</span><span class="style10">];
</span><span class="style11">ll f</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">15</span><span class="style10">][</span><span class="style4">16</span><span class="style10">];
</span><span class="style11">ll g</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">15</span><span class="style10">][</span><span class="style4">16</span><span class="style10">];
</span><span class="style11">ll maxx</span><span class="style10">;
</span><span class="style11">ll res</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">Get_add</span><span class="style10">(</span><span class="style5">int </span><span class="style11">le</span><span class="style10">, </span><span class="style5">int </span><span class="style11">ri</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">le </span><span class="style10">&gt; </span><span class="style11">ri</span><span class="style10">) </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">ri </span><span class="style10">- </span><span class="style11">le</span><span class="style10">) * </span><span class="style4">2</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">dp_bit</span><span class="style10">(){
    </span><span class="style11">maxx </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">f</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">)][</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">2 </span><span class="style10">* </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">g</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">)][</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    }
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">i</span><span class="style10">))
            </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">j</span><span class="style10">)){
                    </span><span class="style5">int </span><span class="style11">y </span><span class="style10">= (</span><span class="style11">x </span><span class="style10">&amp;~ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">j</span><span class="style10">));
                    </span><span class="style5">int </span><span class="style11">len </span><span class="style10">= </span><span class="style11">Get_add</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">a</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]);
                    </span><span class="style5">int </span><span class="style11">C </span><span class="style10">= </span><span class="style11">len </span><span class="style10">+ </span><span class="style11">f</span><span class="style10">[</span><span class="style11">y</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
                    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] &lt; </span><span class="style11">C</span><span class="style10">){
                        </span><span class="style11">f</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style11">C</span><span class="style10">;
                        </span><span class="style11">g</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style11">g</span><span class="style10">[</span><span class="style11">y</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
                    }
                    </span><span class="style5">else if </span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] == </span><span class="style11">C</span><span class="style10">){
                        </span><span class="style11">g</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] += </span><span class="style11">g</span><span class="style10">[</span><span class="style11">y</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
                    }
                }
            }
        }
    }
</span><span class="style2">//    rollup(i, 0, (1 &lt;&lt; n)-1){
//        rollup(j, 0, n-1){
//            cout &lt;&lt; f[i][j] &lt;&lt; " ";
//        }
//        cout &lt;&lt; "\n";
//    }

    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">)-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]);
    </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">l</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] == </span><span class="style11">maxx</span><span class="style10">) </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">g</span><span class="style10">[</span><span class="style11">l</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
    }
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style5">while </span><span class="style10">(</span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">n </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">f</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">f</span><span class="style10">));
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">g</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">g</span><span class="style10">));
        </span><span class="style11">dp_bit</span><span class="style10">();
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">maxx </span><span class="style10">+ </span><span class="style11">n</span><span class="style10">*</span><span class="style4">2 </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">res </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">long long </span><span class="style11">res</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] += </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">Get</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">];
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];

        </span><span class="style11">update</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
        </span><span class="style11">Get</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]+</span><span class="style4">1</span><span class="style10">);

</span><span class="style2">//        for (int j = 1; j &lt;= n; j++) cout &lt;&lt; BIT[j] &lt;&lt; " ";
//        cout &lt;&lt; "\n";
    </span><span class="style10">}
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">long long </span><span class="style11">res</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] += </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">Get</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">];
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">compress</span><span class="style10">(){
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">v</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">() + </span><span class="style4">1</span><span class="style10">;
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }
    </span><span class="style11">compress</span><span class="style10">();
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">update</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
        </span><span class="style11">Get</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]+</span><span class="style4">1</span><span class="style10">);

</span><span class="style2">//        for (int j = 1; j &lt;= n; j++) cout &lt;&lt; BIT[j] &lt;&lt; " ";
//        cout &lt;&lt; "\n";
    </span><span class="style10">}
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100002</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">num</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">res</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">num</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">num</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style11">num</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
                </span><span class="style11">res</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">({</span><span class="style16">min</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">), </span><span class="style16">max</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)});
            }
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">num</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        }
    }

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">res</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">res</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">res</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">under</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">Tin</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">Tout</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">isJoint</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">, </span><span class="style11">step</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style11">Tin</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">step</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">child </span><span class="style10">= </span><span class="style5">bool</span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">v</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);

            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            </span><span class="style11">under</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt;= </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style11">child</span><span class="style10">++;
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }
    </span><span class="style11">isJoint</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style5">bool</span><span class="style10">(</span><span class="style11">child </span><span class="style10">&gt;= </span><span class="style4">2</span><span class="style10">);
    </span><span class="style11">Tout</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">step</span><span class="style10">;
}
</span><span class="style2">//make the DFS tree
//Tin[i] is the time begin exploring i'th node
//Tout[i] is the time terminate exploring i'th node

</span><span class="style5">bool </span><span class="style11">inDfs</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">Tin</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &lt;= </span><span class="style11">Tin</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &amp;&amp; </span><span class="style11">Tout</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &lt;= </span><span class="style11">Tout</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
}
</span><span class="style2">// check if v is 'under' u (is child of u in DFS tree)

</span><span class="style5">bool </span><span class="style11">toBridge</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">A</span><span class="style10">,</span><span class="style11">B</span><span class="style10">,</span><span class="style11">C</span><span class="style10">,</span><span class="style11">D</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">A </span><span class="style10">&gt;&gt; </span><span class="style11">B </span><span class="style10">&gt;&gt; </span><span class="style11">C </span><span class="style10">&gt;&gt; </span><span class="style11">D</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Tin</span><span class="style10">[</span><span class="style11">C</span><span class="style10">] &gt; </span><span class="style11">Tin</span><span class="style10">[</span><span class="style11">D</span><span class="style10">]) </span><span class="style16">swap</span><span class="style10">(</span><span class="style11">C</span><span class="style10">, </span><span class="style11">D</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">D</span><span class="style10">] &lt; </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">D</span><span class="style10">]) </span><span class="style5">return </span><span class="style4">1</span><span class="style10">;          </span><span class="style2">// not a bridge ?
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">inDfs</span><span class="style10">(</span><span class="style11">D</span><span class="style10">, </span><span class="style11">A</span><span class="style10">) == </span><span class="style11">inDfs</span><span class="style10">(</span><span class="style11">D</span><span class="style10">, </span><span class="style11">B</span><span class="style10">));
}

</span><span class="style5">bool </span><span class="style11">comp</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">Tin</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] &lt; </span><span class="style11">Tin</span><span class="style10">[</span><span class="style11">y</span><span class="style10">]);
}

</span><span class="style5">int </span><span class="style11">get_parent</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">inDfs</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)) </span><span class="style5">return </span><span class="style10">-</span><span class="style4">1</span><span class="style10">;            </span><span class="style2">// if v belong to parent node of u (not 'under' u) ?
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= *(</span><span class="style16">upper_bound</span><span class="style10">(</span><span class="style11">under</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">under</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">, </span><span class="style11">comp</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">); </span><span class="style2">// combine comp() with upper_bound is more effecient than sort-and-find
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] &lt; </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">return </span><span class="style10">-</span><span class="style4">1</span><span class="style10">;         </span><span class="style2">// if x still can comeback to parent of u ?
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">toJoint</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">A</span><span class="style10">, </span><span class="style11">B</span><span class="style10">, </span><span class="style11">C</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">A </span><span class="style10">&gt;&gt; </span><span class="style11">B </span><span class="style10">&gt;&gt; </span><span class="style11">C</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">isJoint</span><span class="style10">[</span><span class="style11">C</span><span class="style10">]) </span><span class="style5">return </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">get_parent</span><span class="style10">(</span><span class="style11">C</span><span class="style10">, </span><span class="style11">A</span><span class="style10">) == </span><span class="style11">get_parent</span><span class="style10">(</span><span class="style11">C</span><span class="style10">, </span><span class="style11">B</span><span class="style10">));
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;

    </span><span class="style5">int </span><span class="style11">query</span><span class="style10">;
    </span><span class="style5">bool </span><span class="style11">flag</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">query</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">query </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style11">flag </span><span class="style10">= </span><span class="style11">toBridge</span><span class="style10">();
        </span><span class="style5">else </span><span class="style11">flag </span><span class="style10">= </span><span class="style11">toJoint</span><span class="style10">();
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; (</span><span class="style11">flag </span><span class="style10">? </span><span class="style6">"yes" </span><span class="style10">: </span><span class="style6">"no"</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100002</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">res</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">num</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">]; </span><span class="style2">// low = lowest
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">child </span><span class="style10">= </span><span class="style5">bool</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] != -</span><span class="style4">1</span><span class="style10">); </span><span class="style2">// bool == 0 khi u la goc DFS
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">num</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">num</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt;= </span><span class="style11">num</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style11">child</span><span class="style10">++;
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">num</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">child </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">) </span><span class="style11">res</span><span class="style10">.</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        }
    }

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">res</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">res</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">x </span><span class="style10">: </span><span class="style11">res</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">x </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">k</span><span class="style10">,</span><span class="style11">l</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">sa</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">sb</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">id</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">bridges</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">id</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">v</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">id</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            </span><span class="style11">sa</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">sa</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
            </span><span class="style11">sb</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">sb</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style11">id</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sa</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style4">0 </span><span class="style10">|| </span><span class="style11">sa</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style11">k </span><span class="style10">||
                    </span><span class="style11">sb</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style4">0 </span><span class="style10">|| </span><span class="style11">sb</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style11">l</span><span class="style10">){
                        </span><span class="style11">bridges</span><span class="style10">++;
                    }
            }
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">id</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m </span><span class="style10">&gt;&gt; </span><span class="style11">k </span><span class="style10">&gt;&gt; </span><span class="style11">l</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">k</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">x</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
        </span><span class="style11">sa</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">l</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">x</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
        </span><span class="style11">sb</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        }
    }

    </span><span class="style15">///debug
</span><span class="style2">//    up(i, 1, n) cout &lt;&lt; sa[i] &lt;&lt; " ";
//    cout &lt;&lt; "\n";
//    up(i, 1, n) cout &lt;&lt; sb[i] &lt;&lt; " ";
//    cout &lt;&lt; "\n";

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">bridges</span><span class="style10">;
}

</span><span class="style2">//omg such a long time for debugging

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">s</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">res</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">root</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">child </span><span class="style10">= </span><span class="style5">bool</span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style11">s</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">sum </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">v</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);

            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            </span><span class="style11">s</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">s</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt;= </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
                </span><span class="style11">child</span><span class="style10">++;
                </span><span class="style11">res</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">s</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] * (</span><span class="style11">n </span><span class="style10">- </span><span class="style11">s</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] - </span><span class="style4">1</span><span class="style10">);
                </span><span class="style11">sum </span><span class="style10">+= </span><span class="style11">s</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
                </span><span class="style2">// chi tinh nhung thanh phan thuoc nhanh cua u tren cay DFS
                </span><span class="style15">/// sau khi thao bo khop
            </span><span class="style10">}
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">child </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">res</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += (</span><span class="style11">sum</span><span class="style10">) * (</span><span class="style11">n </span><span class="style10">- </span><span class="style11">sum </span><span class="style10">- </span><span class="style4">1</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] + </span><span class="style4">2</span><span class="style10">*(</span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define Task                    "D"
#define ll                      long long
#define bit(x,i)                ((x &gt;&gt; i) &amp; 1)
#define stt(x,i)                (x &amp; (1 &lt;&lt; i))
#define trail0(x)               (x &amp; (-x))
#define up(i,a,b)               for (int i = (a); i &lt;= (b); i++)
#define down(i,a,b)             for (int i = (a); i &gt;= (b); i--)
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100101</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">bridges</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">under</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">int </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">res</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">findSCC</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){ </span><span class="style2">// strong connected components
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">findSCC</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        }
    }
}

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style11">under</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            </span><span class="style11">under</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">under</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
                </span><span class="style11">bridges</span><span class="style10">++;
            }
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style5">int </span><span class="style11">tplt </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">d</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">d</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">findSCC</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            </span><span class="style11">tplt</span><span class="style10">++;
        }
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">tplt </span><span class="style10">&gt;= </span><span class="style4">3</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"0"</span><span class="style10">;

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">tplt </span><span class="style10">== </span><span class="style4">2</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
                </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
                </span><span class="style5">break</span><span class="style10">;
            }
        }
        </span><span class="style11">res </span><span class="style10">= </span><span class="style11">tdfs </span><span class="style10">* (</span><span class="style11">n </span><span class="style10">- </span><span class="style11">tdfs</span><span class="style10">);

        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
                </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            }
        } </span><span class="style2">// co ve DFS them phat nua khong thong minh lam =(

        // tdfs = so dinh thuoc tplt 1
        // n - tdfs = so dinh thuoc tplt 2
        // m - bridges = so canh con lai khac bridges

        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res </span><span class="style10">* (</span><span class="style11">m </span><span class="style10">- </span><span class="style11">bridges</span><span class="style10">);
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">tplt </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) {
        </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);
        </span><span class="style11">res </span><span class="style10">= (</span><span class="style11">m</span><span class="style10">-</span><span class="style11">bridges</span><span class="style10">)*(</span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">n</span><span class="style10">*(</span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">)/</span><span class="style4">2 </span><span class="style10">- </span><span class="style11">m</span><span class="style10">);
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] == </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
                </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">under</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] * (</span><span class="style11">n </span><span class="style10">- </span><span class="style11">under</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) - </span><span class="style4">1</span><span class="style10">;
            }
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    }

    </span><span class="style15">///debug
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">bridges </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">tdfs </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">3</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">Cmax</span><span class="style10">, </span><span class="style11">C</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">child </span><span class="style10">= (</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">root</span><span class="style10">);
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);

            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt;= </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style11">child</span><span class="style10">++;
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">child </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Cmax </span><span class="style10">&lt; </span><span class="style11">child </span><span class="style10">|| (</span><span class="style11">Cmax </span><span class="style10">== </span><span class="style11">child </span><span class="style10">&amp;&amp; </span><span class="style11">C </span><span class="style10">&gt; </span><span class="style11">u</span><span class="style10">)){
            </span><span class="style11">Cmax </span><span class="style10">= </span><span class="style11">child</span><span class="style10">, </span><span class="style11">C </span><span class="style10">= </span><span class="style11">u</span><span class="style10">;
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">Cmax </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
    </span><span class="style11">C </span><span class="style10">= </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style5">int </span><span class="style11">tplt </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">root </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            </span><span class="style11">tplt</span><span class="style10">++;
        }
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Cmax </span><span class="style10">== </span><span class="style11">INT_MIN</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">tplt </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style4">1</span><span class="style10">;
    }
    </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">Cmax </span><span class="style10">+ </span><span class="style11">tplt </span><span class="style10">- </span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">C</span><span class="style10">;
    </span><span class="style2">// so thanh phan toi da tao thanh
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;
</span><span class="style16">map</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">, </span><span class="style5">bool</span><span class="style10">&gt; </span><span class="style11">ma</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">res</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">tol</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
        </span><span class="style11">ma</span><span class="style10">[{</span><span class="style16">min</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">), </span><span class="style16">max</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)}] = </span><span class="style4">1</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
                </span><span class="style11">res</span><span class="style10">.</span><span class="style11">pb</span><span class="style10">({</span><span class="style16">min</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">), </span><span class="style16">max</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)});
                </span><span class="style11">tol</span><span class="style10">++;
            }
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        }
    }
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">res</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">ma</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]) </span><span class="style11">tol</span><span class="style10">--;
    }

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">tol</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style4">11</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">compress</span><span class="style10">(){
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">v</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">() + </span><span class="style4">1</span><span class="style10">;
    }
}

</span><span class="style5">int </span><span class="style11">getlen </span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">= (</span><span class="style11">res </span><span class="style10">+ </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = (</span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] + </span><span class="style11">val</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style15">///From VNOI with love
</span><span class="style2">// Goi f[x][i] la day con tang co do dai x ket thuc tai vi tri i
// Goi BIT[x] la do dai day con tang co (do dai dang xet) ket thuc tai gia tri x

// Voi x = 1 =&gt; f[x][i] = 1 voi moi i
// Voi x &gt;= 2 dung LIS thong thuong
    // update a[j] cung gia tri toi uu truoc do f[i-1][j]

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">b</span><span class="style10">){
    </span><span class="style11">a </span><span class="style10">+= </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a </span><span class="style10">&gt;= </span><span class="style11">MOD</span><span class="style10">) </span><span class="style11">a </span><span class="style10">-= </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style2">//compress();

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">f</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">k</span><span class="style10">){
        </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">BIT</span><span class="style10">, </span><span class="style11">BIT</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
        </span><span class="style11">down</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){ </span><span class="style2">// Tai sao for nguoc lai dung ??
            </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style11">getlen</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]); </span><span class="style2">// Tai sao -1 hay khong van co ket qua dung ??
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">j</span><span class="style10">], </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]);
        }
    }

    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">add</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;

</span><span class="style2">//    cout &lt;&lt; "\n";
//    up(i, 1, k){
//        up(j, 1, n){
//            cout &lt;&lt; f[i][j] &lt;&lt; " ";
//        }
//        cout &lt;&lt; "\n";
//    }
//    cout &lt;&lt; "\n";
//
//    up(i, 1, n){
//        cout &lt;&lt; BIT[i] &lt;&lt; " ";
//    }
//    cout &lt;&lt; "\n";
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"KOL.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"KOL.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">30001</span><span class="style10">];
</span><span class="style5">struct </span><span class="style11">T</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">pre</span><span class="style10">, </span><span class="style11">val</span><span class="style10">;
};
</span><span class="style11">T tree</span><span class="style10">[</span><span class="style4">4</span><span class="style10">*</span><span class="style4">30001</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">t </span><span class="style10">= </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre</span><span class="style10">;
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">+= </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">+= </span><span class="style11">t</span><span class="style10">;

    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">].</span><span class="style11">val </span><span class="style10">+= </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val </span><span class="style10">+= </span><span class="style11">t</span><span class="style10">;

    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">f</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">+= </span><span class="style11">f</span><span class="style10">;
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">+= </span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">node</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">, </span><span class="style11">f</span><span class="style10">);
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">f</span><span class="style10">);
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">].</span><span class="style11">val</span><span class="style10">, </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">getmin</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style5">return </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val</span><span class="style10">;
    }
    </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">node</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">left </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">right </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style5">return </span><span class="style16">min</span><span class="style10">(</span><span class="style11">left</span><span class="style10">, </span><span class="style11">right</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">4</span><span class="style10">*</span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">q</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">v</span><span class="style10">--;
        </span><span class="style5">int </span><span class="style11">minn </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">minn </span><span class="style10">&gt;= </span><span class="style11">w</span><span class="style10">){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"T"</span><span class="style10">;
            </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">,-</span><span class="style11">w</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"N"</span><span class="style10">;
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
</span><span class="style2">//        for (int i = 1; i &lt;= 4*n; i++) cout &lt;&lt; tree[i].val &lt;&lt; " ";
//        cout &lt;&lt; "\n";
//        cout &lt;&lt; getmin(1,1,n) &lt;&lt; "\n";
    </span><span class="style10">}
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;

#define Task                    "LIS"
#define bit(x,i)                (x &amp; (1 &lt;&lt; (i)))
#define up(i,a,b)               for (int i = (a); i &lt;= (b); i++)
#define down(i,a,b)             for (int i = (a); i &gt;= (b); i--)
#define MOD                     14062008
#define ll                      long long

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style2">//dp[i] do dai LIS ket thuc tai vi tri i
//BIT[x] do dai LIS ket thuc tai gia tri x


</span><span class="style5">int </span><span class="style11">getmax</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">ans </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">ans </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">ans</span><span class="style10">, </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]);
        </span><span class="style11">x </span><span class="style10">-= (</span><span class="style11">x </span><span class="style10">&amp; -</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">ans</span><span class="style10">;
}
</span><span class="style2">//
</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">], </span><span class="style11">val</span><span class="style10">);
        </span><span class="style11">x </span><span class="style10">+= (</span><span class="style11">x </span><span class="style10">&amp; -</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">compress</span><span class="style10">(){
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">v</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">() + </span><span class="style4">1</span><span class="style10">;
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">compress</span><span class="style10">();

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">lmax </span><span class="style10">= </span><span class="style11">getmax</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]-</span><span class="style4">1</span><span class="style10">);
        </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">lmax </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">update</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    }

</span><span class="style2">//    up(i, 1, n){
//        cout &lt;&lt; BIT[i] &lt;&lt; " ";
//    }
//    cout &lt;&lt; "\n";
//    up(i, 1, n){
//        cout &lt;&lt; dp[i] &lt;&lt; " ";
//    }

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; *</span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m </span><span class="style10">&gt;&gt; </span><span class="style11">s </span><span class="style10">&gt;&gt; </span><span class="style11">f</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">BFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">root</span><span class="style10">){
    </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">root</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">root</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">luu</span><span class="style10">.</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">root</span><span class="style10">);

    </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">root</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">q</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">q</span><span class="style10">.</span><span class="style16">front</span><span class="style10">();
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">dd</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
                </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
                </span><span class="style11">luu</span><span class="style10">.</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
                </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">;
                </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">f</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
            }
        }
        </span><span class="style11">q</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
    }
}

</span><span class="style5">bool </span><span class="style11">isbetter</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">PminU </span><span class="style10">= </span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">PminV </span><span class="style10">= </span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">17</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] != </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">PminU </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">PminU</span><span class="style10">, </span><span class="style11">pmin</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]);
            </span><span class="style11">PminV </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">PminV</span><span class="style10">, </span><span class="style11">pmin</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]);
            </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
            </span><span class="style11">v </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        }
    }
    </span><span class="style11">PminU </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">PminU</span><span class="style10">, </span><span class="style11">pmin</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]);
    </span><span class="style11">PminV </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">PminV</span><span class="style10">, </span><span class="style11">pmin</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]);
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">PminU </span><span class="style10">&lt; </span><span class="style11">PminV</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">DP</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">u </span><span class="style10">: </span><span class="style11">luu</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dist</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] - </span><span class="style4">1</span><span class="style10">){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">tr</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0 </span><span class="style10">|| </span><span class="style11">isbetter</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">tr</span><span class="style10">[</span><span class="style11">u</span><span class="style10">])) </span><span class="style11">tr</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
            }
        }
        </span><span class="style11">pmin</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
        </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">tr</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">17</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">p </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">];
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">par</span><span class="style10">[</span><span class="style11">p</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">];
            </span><span class="style11">pmin</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">pmin</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">], </span><span class="style11">pmin</span><span class="style10">[</span><span class="style11">p</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]);
        }
    }
}


</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">BFS</span><span class="style10">(</span><span class="style11">f</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">dd</span><span class="style10">[</span><span class="style11">s</span><span class="style10">]){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; -</span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
    }
    </span><span class="style11">DP</span><span class="style10">();
    </span><span class="style2">//up(i, 1, n) cout &lt;&lt; tr[i] &lt;&lt; "\n";

    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">s </span><span class="style10">!= </span><span class="style11">f</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">s </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        </span><span class="style11">s </span><span class="style10">= </span><span class="style11">tr</span><span class="style10">[</span><span class="style11">s</span><span class="style10">];
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">s</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style11">ll f</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">15</span><span class="style10">][</span><span class="style4">16</span><span class="style10">];
</span><span class="style2">//F[x][i] : so cach tao thanh hoan vi o trang thai x
//co phan tu cuoi cung la i

</span><span class="style5">void </span><span class="style11">dp_bit</span><span class="style10">(){
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) </span><span class="style11">f</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style2">//Co so Quy hoach
    //luon luon co 1 cach de co so i o cuoi
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">st</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">!= </span><span class="style11">j </span><span class="style10">&amp;&amp; </span><span class="style11">bit</span><span class="style10">(</span><span class="style11">st</span><span class="style10">, </span><span class="style11">i</span><span class="style10">) &amp;&amp; </span><span class="style11">abs</span><span class="style10">(</span><span class="style11">i</span><span class="style10">-</span><span class="style11">j</span><span class="style10">) &lt;= </span><span class="style11">k</span><span class="style10">){
                    </span><span class="style11">f</span><span class="style10">[</span><span class="style11">st</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] += </span><span class="style11">f</span><span class="style10">[</span><span class="style11">st </span><span class="style10">&amp;~ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">)][</span><span class="style11">j</span><span class="style10">];
                }
            }
        }
    }
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style16">endl</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style16">endl</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
    </span><span class="style11">dp_bit</span><span class="style10">();
    </span><span class="style11">ll res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
    </span><span class="style2">// tong so cach co hoan vi thoa man
    //ket thuc tai i
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">f</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style15">/// WARNING : ??!!
</span><span class="style1">/*
    * int overflow ?
    * array bounds ?
    * special cases (n = 1, n = 0) ?
    * uncontrolled loop ?
    * int or long long ?
    * positive or negative ?
    * divided by 0 ?
    * reset ?
*/

</span><span class="style2">//hoáº·c f[x][i] &lt;-- f[x-2^i][j]
//vá»›i j tá»“n táº¡i trong x vÃ&nbsp; khÃ¡c i


</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">18</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">h</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">18</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">edge</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
};
</span><span class="style11">edge E</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">P</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">w</span><span class="style10">;
    }
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">w </span><span class="style10">&gt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">w</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">Union</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">return true</span><span class="style10">;
    }
    </span><span class="style5">return false</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">mark_MST</span><span class="style10">(){
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">E</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">E</span><span class="style10">+</span><span class="style11">m</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">u</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Union</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
            </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
            </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        }
    }
}

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">!= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]){
            </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">w</span><span class="style10">;

            </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">17</span><span class="style10">){
                </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">par</span><span class="style10">[</span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">];
                </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">], </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]);
                </span><span class="style2">// 'mpar' and 'par', sometimes confused...
            </span><span class="style10">}
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        }
    }
}

</span><span class="style5">int </span><span class="style11">MinLCA</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &lt; </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style16">swap</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">fin </span><span class="style10">= </span><span class="style4">10000007</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">delta </span><span class="style10">= </span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] - </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, (</span><span class="style5">int</span><span class="style10">)</span><span class="style11">log2</span><span class="style10">(</span><span class="style11">delta</span><span class="style10">), </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">delta</span><span class="style10">, </span><span class="style11">i</span><span class="style10">)){
            </span><span class="style11">fin </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">fin</span><span class="style10">, </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]);
            </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        }
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">fin</span><span class="style10">;

    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">17</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] != </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">fin </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">fin</span><span class="style10">, </span><span class="style16">min</span><span class="style10">(</span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">], </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]));
            </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
            </span><span class="style11">v </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        }
    }
    </span><span class="style11">fin </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">fin</span><span class="style10">, </span><span class="style16">min</span><span class="style10">(</span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">], </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]));
    </span><span class="style5">return </span><span class="style11">fin</span><span class="style10">;
}


</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]+</span><span class="style4">17</span><span class="style10">, </span><span class="style4">10000007</span><span class="style10">);
    }
    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">mark_MST</span><span class="style10">();
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);

    </span><span class="style5">long long </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">dd</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">u</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">v</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">w</span><span class="style10">;
            </span><span class="style11">res </span><span class="style10">+= </span><span class="style16">max</span><span class="style10">(</span><span class="style4">1ll</span><span class="style10">*</span><span class="style4">0</span><span class="style10">, </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">MinLCA</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">) - </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">w</span><span class="style10">);
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">18</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">h</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">18</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">edge</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
};
</span><span class="style11">edge E</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">P</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">w</span><span class="style10">;
    }
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">w </span><span class="style10">&gt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">w</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">Union</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">return true</span><span class="style10">;
    }
    </span><span class="style5">return false</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">mark_MST</span><span class="style10">(){
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">E</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">E</span><span class="style10">+</span><span class="style11">m</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">u</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Union</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
            </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
            </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        }
    }
}

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">!= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]){
            </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">w</span><span class="style10">;

            </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">17</span><span class="style10">){
                </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">par</span><span class="style10">[</span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">];
                </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">], </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]);
                </span><span class="style2">// 'mpar' and 'par', sometimes confused...
            </span><span class="style10">}
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        }
    }
}

</span><span class="style5">int </span><span class="style11">MinLCA</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &lt; </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style16">swap</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">fin </span><span class="style10">= </span><span class="style4">10000007</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">delta </span><span class="style10">= </span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] - </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, (</span><span class="style5">int</span><span class="style10">)</span><span class="style11">log2</span><span class="style10">(</span><span class="style11">delta</span><span class="style10">), </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">delta</span><span class="style10">, </span><span class="style11">i</span><span class="style10">)){
            </span><span class="style11">fin </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">fin</span><span class="style10">, </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]);
            </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        }
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">fin</span><span class="style10">;

    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">17</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] != </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">fin </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">fin</span><span class="style10">, </span><span class="style16">min</span><span class="style10">(</span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">], </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]));
            </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
            </span><span class="style11">v </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        }
    }
    </span><span class="style11">fin </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">fin</span><span class="style10">, </span><span class="style16">min</span><span class="style10">(</span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">], </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]));
    </span><span class="style5">return </span><span class="style11">fin</span><span class="style10">;
}


</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">mpar</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]+</span><span class="style4">17</span><span class="style10">, </span><span class="style4">10000007</span><span class="style10">);
    }
    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">mark_MST</span><span class="style10">();
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);

    </span><span class="style5">long long </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">dd</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">u</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">v</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">w</span><span class="style10">;
            </span><span class="style11">res </span><span class="style10">+= </span><span class="style16">max</span><span class="style10">(</span><span class="style4">1ll</span><span class="style10">*</span><span class="style4">0</span><span class="style10">, </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">MinLCA</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">) - </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">w</span><span class="style10">);
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;vector&gt;
#include &lt;math.h&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;algorithm&gt;
#define task "SERIEA"

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style16">ifstream </span><span class="style11">fi</span><span class="style10">(</span><span class="style11">task </span><span class="style6">".inp"</span><span class="style10">);
</span><span class="style16">ofstream </span><span class="style11">fo</span><span class="style10">(</span><span class="style11">task </span><span class="style6">".out"</span><span class="style10">);

</span><span class="style16">map</span><span class="style10">&lt;</span><span class="style16">string</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

</span><span class="style5">class </span><span class="style11">team </span><span class="style10">{
</span><span class="style5">public</span><span class="style10">:
    </span><span class="style16">string </span><span class="style11">name</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">match</span><span class="style10">, </span><span class="style11">score</span><span class="style10">, </span><span class="style11">win</span><span class="style10">, </span><span class="style11">lost</span><span class="style10">, </span><span class="style11">draw</span><span class="style10">, </span><span class="style11">goal</span><span class="style10">, </span><span class="style11">goalLost</span><span class="style10">;
</span><span class="style5">public</span><span class="style10">:
    </span><span class="style11">team</span><span class="style10">() : </span><span class="style11">match</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style11">win</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style11">lost</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style11">score</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style11">draw</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style11">goal</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style11">goalLost</span><span class="style10">(</span><span class="style4">0</span><span class="style10">) {
        </span><span class="style11">fi </span><span class="style10">&gt;&gt; </span><span class="style11">name</span><span class="style10">;
        </span><span class="style11">m</span><span class="style10">[</span><span class="style11">name</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">++;
    };
    </span><span class="style5">friend </span><span class="style16">ofstream</span><span class="style10">&amp; </span><span class="style5">operator </span><span class="style10">&lt;&lt; (</span><span class="style16">ofstream </span><span class="style10">&amp; </span><span class="style11">os</span><span class="style10">, </span><span class="style11">team </span><span class="style10">&amp; </span><span class="style11">t</span><span class="style10">) {
        </span><span class="style11">os </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">name </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">match </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">score </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        </span><span class="style11">os </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">win </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">lost </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">draw </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        </span><span class="style11">os </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">goal </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">goalLost </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">goal </span><span class="style10">- </span><span class="style11">t</span><span class="style10">.</span><span class="style11">goalLost </span><span class="style10">&lt;&lt; </span><span class="style16">endl</span><span class="style10">;
        </span><span class="style5">return </span><span class="style11">os</span><span class="style10">;
    }
    </span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">goal</span><span class="style10">, </span><span class="style5">int </span><span class="style11">goalLost</span><span class="style10">) {
        </span><span class="style5">this</span><span class="style10">-&gt;</span><span class="style11">goal </span><span class="style10">+= </span><span class="style11">goal</span><span class="style10">;
        </span><span class="style5">this</span><span class="style10">-&gt;</span><span class="style11">goalLost </span><span class="style10">+= </span><span class="style11">goalLost</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">goal </span><span class="style10">&gt; </span><span class="style11">goalLost</span><span class="style10">) {
            </span><span class="style11">win</span><span class="style10">++;
            </span><span class="style11">score </span><span class="style10">+= </span><span class="style4">3</span><span class="style10">;
        }
        </span><span class="style5">else if </span><span class="style10">(</span><span class="style11">goal </span><span class="style10">&lt; </span><span class="style11">goalLost</span><span class="style10">) {
            </span><span class="style11">lost</span><span class="style10">++;
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style11">score</span><span class="style10">++;
            </span><span class="style11">draw</span><span class="style10">++;
        }
        </span><span class="style5">this </span><span class="style10">-&gt; </span><span class="style11">match</span><span class="style10">++;
    }
    </span><span class="style5">int </span><span class="style11">w_l</span><span class="style10">() {
        </span><span class="style5">return </span><span class="style11">goal </span><span class="style10">- </span><span class="style11">goalLost</span><span class="style10">;
    }
    </span><span class="style5">friend bool operator </span><span class="style10">&lt; (</span><span class="style11">team </span><span class="style10">&amp; </span><span class="style11">l</span><span class="style10">, </span><span class="style11">team</span><span class="style10">&amp; </span><span class="style11">t</span><span class="style10">) {
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l</span><span class="style10">.</span><span class="style11">score </span><span class="style10">!= </span><span class="style11">t</span><span class="style10">.</span><span class="style11">score</span><span class="style10">) </span><span class="style5">return </span><span class="style11">l</span><span class="style10">.</span><span class="style11">score </span><span class="style10">&gt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">score</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l</span><span class="style10">.</span><span class="style11">w_l</span><span class="style10">() != </span><span class="style11">t</span><span class="style10">.</span><span class="style11">w_l</span><span class="style10">()) </span><span class="style5">return </span><span class="style11">l</span><span class="style10">.</span><span class="style11">w_l</span><span class="style10">() &gt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">w_l</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l</span><span class="style10">.</span><span class="style11">goal </span><span class="style10">!= </span><span class="style11">t</span><span class="style10">.</span><span class="style11">goal</span><span class="style10">) </span><span class="style5">return </span><span class="style11">l</span><span class="style10">.</span><span class="style11">goal </span><span class="style10">&gt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">goal</span><span class="style10">;
        </span><span class="style5">return </span><span class="style11">l</span><span class="style10">.</span><span class="style11">name </span><span class="style10">&lt; </span><span class="style11">t</span><span class="style10">.</span><span class="style11">name</span><span class="style10">;
    }

};

</span><span class="style5">int </span><span class="style11">main</span><span class="style10">() {
    </span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">fi </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">team</span><span class="style10">&gt;</span><span class="style11">a</span><span class="style10">(</span><span class="style11">n</span><span class="style10">);
    </span><span class="style16">string </span><span class="style11">t1</span><span class="style10">, </span><span class="style11">t2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">k</span><span class="style10">, </span><span class="style11">q</span><span class="style10">;
    </span><span class="style5">while</span><span class="style10">(</span><span class="style11">fi </span><span class="style10">&gt;&gt; </span><span class="style11">t1 </span><span class="style10">&gt;&gt; </span><span class="style11">t2 </span><span class="style10">&gt;&gt; </span><span class="style11">k </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">m</span><span class="style10">[</span><span class="style11">t1</span><span class="style10">]].</span><span class="style11">update</span><span class="style10">(</span><span class="style11">k</span><span class="style10">, </span><span class="style11">q</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">m</span><span class="style10">[</span><span class="style11">t2</span><span class="style10">]].</span><span class="style11">update</span><span class="style10">(</span><span class="style11">q</span><span class="style10">, </span><span class="style11">k</span><span class="style10">);
    }
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">a</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">i </span><span class="style10">: </span><span class="style11">a</span><span class="style10">) {
        </span><span class="style11">fo </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">18</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">h</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">res </span><span class="style10">= -</span><span class="style4">1</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in1</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }
}

</span><span class="style5">int </span><span class="style11">LCA</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &lt; </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style16">swap</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">de </span><span class="style10">= </span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] - </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, (</span><span class="style5">int</span><span class="style10">)</span><span class="style11">log2</span><span class="style10">(</span><span class="style11">de</span><span class="style10">), </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">de</span><span class="style10">, </span><span class="style11">i</span><span class="style10">)) </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">v</span><span class="style10">;

    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">17</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] != </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
            </span><span class="style11">v </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        }
    }

    </span><span class="style5">return </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">];
}

</span><span class="style5">void </span><span class="style11">in2</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">p </span><span class="style10">= </span><span class="style11">LCA</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]--;
        </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]--;
        </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">p</span><span class="style10">] += </span><span class="style4">2</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">!= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]){
            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">;

            </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">17</span><span class="style10">){
                </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">par</span><span class="style10">[</span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">];
            }
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        }
    }
}

</span><span class="style5">void </span><span class="style11">reDFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">!= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]){
            </span><span class="style11">reDFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
        }
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sum</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">res</span><span class="style10">++;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in1</span><span class="style10">();
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">in2</span><span class="style10">();
    </span><span class="style11">reDFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">d1</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">d2</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
}

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">par</span><span class="style10">, </span><span class="style5">int </span><span class="style11">d1</span><span class="style10">[], </span><span class="style5">int </span><span class="style11">d2</span><span class="style10">[]){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;

        </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style11">d1</span><span class="style10">, </span><span class="style11">d2</span><span class="style10">);
        </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style11">d1</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] + </span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d1</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &lt; </span><span class="style11">l</span><span class="style10">){
            </span><span class="style11">d2</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">d1</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
            </span><span class="style11">d1</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">l</span><span class="style10">;
        }
        </span><span class="style5">else if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">d2</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style11">d2</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">l</span><span class="style10">;
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">d1</span><span class="style10">, </span><span class="style11">d2</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">minn </span><span class="style10">= </span><span class="style11">MOD</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">d1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">d2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style11">d1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] += </span><span class="style11">d2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; *</span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">d1</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">d1</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style2">// Nguyen Ly : hai nut X va Y nam tren duong di ngan nhat va ngan nhi
// =&gt; cung la con cua dinh U tren subtree -&gt; U la LCA(X, Y)
// =&gt; QHD theo phuong phap toi uu tu subtree -&gt; maintree
// ket qua la max voi moi u : (ngan nhat tu u xuong con) + (ngan nhi tu u xuong con)

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
}

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">par</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;

        </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">);
    }
}


</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">d</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">d</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">) - </span><span class="style11">d</span><span class="style10">;
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">d</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">d</span><span class="style10">));
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; *</span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">d</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">d</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define Task "A"
#define pii pair&lt;int, int&gt;
#define f first
#define s second
#define up(i, a, b) for (int i = (a); i &lt;= (b); i++)
#define pb push_back

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">P</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">long long </span><span class="style11">T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">]; </span><span class="style2">// tu con len cha
</span><span class="style5">long long </span><span class="style11">C</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">]; </span><span class="style2">// tu cha xuong con
</span><span class="style5">int </span><span class="style11">SigmaRice</span><span class="style10">;
</span><span class="style5">const long long </span><span class="style11">MOD </span><span class="style10">= </span><span class="style4">40000000000000001</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">P</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">SigmaRice </span><span class="style10">+= </span><span class="style11">P</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }
}

</span><span class="style5">int </span><span class="style11">S</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">void </span><span class="style11">DFS1</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">par</span><span class="style10">){
    </span><span class="style11">S</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">P</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;

        </span><span class="style11">DFS1</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">);
        </span><span class="style11">S</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">S</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">T</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] + </span><span class="style11">S</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]*</span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">w</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">DFS2</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">par</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;

        </span><span class="style11">C</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">C</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style11">T</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] - </span><span class="style11">T</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] - </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">S</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]*</span><span class="style11">w </span><span class="style10">+ (</span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">SigmaRice </span><span class="style10">- </span><span class="style11">S</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) * </span><span class="style4">1ll</span><span class="style10">*</span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">DFS2</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">DFS1</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">DFS2</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);

    </span><span class="style5">long long </span><span class="style11">minn </span><span class="style10">= </span><span class="style11">MOD</span><span class="style10">;
    </span><span class="style5">long long </span><span class="style11">maxx </span><span class="style10">= -</span><span class="style11">MOD</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
</span><span class="style2">//        cout &lt;&lt; T[i] &lt;&lt; " " &lt;&lt; C[i] &lt;&lt; "\n";
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] += </span><span class="style11">C</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">minn </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minn</span><span class="style10">, </span><span class="style11">T</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
        </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">T</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">minn </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">maxx</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
#include &lt;cstring&gt;
#include &lt;climits&gt;
#define up(i, a, b) for (int i = (a); i &lt;= (b); i++)
#define MOD 1000000007
#define pii pair&lt;int, int&gt;
#define s first
#define f second
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">oo </span><span class="style10">= </span><span class="style11">INT_MAX</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style11">pii a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">b</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">Tl</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">4</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">Tr</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">4</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">;
        </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">;
    }
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style5">const </span><span class="style11">pii</span><span class="style10">&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style5">const </span><span class="style11">pii</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">s </span><span class="style10">== </span><span class="style11">y</span><span class="style10">.</span><span class="style11">s</span><span class="style10">) </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">f</span><span class="style10">);
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">s </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">s</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">, </span><span class="style5">int </span><span class="style11">T</span><span class="style10">[]){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">], </span><span class="style11">val</span><span class="style10">);
        </span><span class="style5">return</span><span class="style10">;
    }

    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">val</span><span class="style10">, </span><span class="style11">T</span><span class="style10">);
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">val</span><span class="style10">, </span><span class="style11">T</span><span class="style10">);
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
}

</span><span class="style5">long long </span><span class="style11">getmax</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">, </span><span class="style5">int </span><span class="style11">T</span><span class="style10">[]){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style10">-</span><span class="style11">oo</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style5">return </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">];
    }

    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">left </span><span class="style10">= </span><span class="style11">getmax</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">T</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">right </span><span class="style10">= </span><span class="style11">getmax</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">T</span><span class="style10">);
    </span><span class="style5">return </span><span class="style16">max</span><span class="style10">(</span><span class="style11">left</span><span class="style10">, </span><span class="style11">right</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"A.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">b</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">b</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">MAXFJ </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= -</span><span class="style11">oo</span><span class="style10">;

    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">Tl</span><span class="style10">, </span><span class="style11">Tl</span><span class="style10">+</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">4</span><span class="style10">, -</span><span class="style11">oo</span><span class="style10">);
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">Tr</span><span class="style10">, </span><span class="style11">Tr</span><span class="style10">+</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">4</span><span class="style10">, -</span><span class="style11">oo</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">start </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">finish </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">;

        </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">b</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">b</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">start</span><span class="style10">) - </span><span class="style11">b</span><span class="style10">;
        </span><span class="style11">MAXFJ </span><span class="style10">= </span><span class="style11">getmax</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">k</span><span class="style10">-</span><span class="style4">1</span><span class="style10">, </span><span class="style11">Tl</span><span class="style10">);

        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">MAXFJ </span><span class="style10">&lt; </span><span class="style4">0</span><span class="style10">) </span><span class="style11">MAXFJ </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">MAXFJ </span><span class="style10">+ </span><span class="style11">finish </span><span class="style10">- </span><span class="style11">start</span><span class="style10">);

        </span><span class="style11">MAXFJ </span><span class="style10">= </span><span class="style11">getmax</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style11">k</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style11">Tr</span><span class="style10">);
        </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">MAXFJ </span><span class="style10">+ </span><span class="style11">finish </span><span class="style10">+ </span><span class="style11">start</span><span class="style10">);

        </span><span class="style11">k </span><span class="style10">= </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">b</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">b</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">finish</span><span class="style10">) - </span><span class="style11">b</span><span class="style10">;
        </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style11">k</span><span class="style10">, </span><span class="style11">k</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">Tl</span><span class="style10">);
        </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style11">k</span><span class="style10">, </span><span class="style11">k</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style4">2</span><span class="style10">*</span><span class="style11">finish</span><span class="style10">, </span><span class="style11">Tr</span><span class="style10">);
        </span><span class="style11">res </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style2">//https://ideone.com/Xu5lWF

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">, </span><span class="style11">k</span><span class="style10">;
</span><span class="style5">double </span><span class="style11">Vp</span><span class="style10">, </span><span class="style11">Vc</span><span class="style10">;
</span><span class="style16">priority_queue </span><span class="style10">&lt;</span><span class="style5">double</span><span class="style10">&gt; </span><span class="style11">PQ</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">k </span><span class="style10">&gt;&gt; </span><span class="style11">Vp </span><span class="style10">&gt;&gt; </span><span class="style11">Vc</span><span class="style10">;

    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">l</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">l</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">l</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">l</span><span class="style10">});
    }
}

</span><span class="style5">int </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">par</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">);

        </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] += </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
        </span><span class="style5">double </span><span class="style11">cost </span><span class="style10">= </span><span class="style5">double</span><span class="style10">(</span><span class="style4">1.0</span><span class="style10">*</span><span class="style11">sum</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] * </span><span class="style4">1.0</span><span class="style10">*(</span><span class="style11">n </span><span class="style10">- </span><span class="style11">sum</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) *
        </span><span class="style4">1.0</span><span class="style10">*</span><span class="style11">l </span><span class="style10">* (</span><span class="style4">1.0</span><span class="style10">/</span><span class="style11">Vp </span><span class="style10">- </span><span class="style4">1.0</span><span class="style10">/</span><span class="style11">Vc</span><span class="style10">));
        </span><span class="style2">//remember to cast int to double
        </span><span class="style11">PQ</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">cost</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">sum</span><span class="style10">[</span><span class="style4">1</span><span class="style10">]++;
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);

</span><span class="style2">//    up(i, 1, n){
//        cout &lt;&lt; sum[i] &lt;&lt; " ";
//    }
//    cout &lt;&lt; "\n";
    </span><span class="style5">double </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0.0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">k</span><span class="style10">--){
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">PQ</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
        </span><span class="style11">PQ</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">fixed </span><span class="style10">&lt;&lt; </span><span class="style16">setprecision</span><span class="style10">(</span><span class="style4">2</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dy</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
}

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">par</span><span class="style10">, </span><span class="style5">int </span><span class="style11">d</span><span class="style10">[]){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">par</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style11">d</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cost</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">X </span><span class="style10">= </span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">cost</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cost</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">) - </span><span class="style11">cost</span><span class="style10">;
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">X</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">dx</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">Y </span><span class="style10">= </span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">dx</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">dx</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">) - </span><span class="style11">dx</span><span class="style10">;
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">Y</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">dy</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">minn </span><span class="style10">= </span><span class="style11">MOD</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">dx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">dy</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">minn </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minn</span><span class="style10">, </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">dy</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]));
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">minn</span><span class="style10">;

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">oo </span><span class="style10">= </span><span class="style4">2</span><span class="style10">*</span><span class="style4">1000000001</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">L</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m </span><span class="style10">&gt;&gt; </span><span class="style11">L</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">u</span><span class="style10">++;
        </span><span class="style11">v</span><span class="style10">++;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">(</span><span class="style11">make_pair</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">));
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">(</span><span class="style11">make_pair</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">));
    }
}

</span><span class="style5">bool </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">maxx </span><span class="style10">= -</span><span class="style4">1</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">luu</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">P </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">parent</span><span class="style10">, </span><span class="style5">int </span><span class="style11">d</span><span class="style10">[]){
    </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">dd</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style11">luu</span><span class="style10">.</span><span class="style11">emplace_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">parent</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;

        </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style11">d</span><span class="style10">);
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">P</span><span class="style10">] &lt; </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style11">P </span><span class="style10">= </span><span class="style11">u</span><span class="style10">;
    </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
}

</span><span class="style5">int </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dy</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">R</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">find_center</span><span class="style10">(</span><span class="style5">int </span><span class="style11">root</span><span class="style10">){
    </span><span class="style11">P </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">root</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cost</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">X </span><span class="style10">= </span><span class="style11">P</span><span class="style10">;

    </span><span class="style11">P </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">X</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">dx</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">Y </span><span class="style10">= </span><span class="style11">P</span><span class="style10">;

    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">Y</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">dy</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">minn </span><span class="style10">= </span><span class="style11">oo</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">: </span><span class="style11">luu</span><span class="style10">){
        </span><span class="style11">minn </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minn</span><span class="style10">, </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">dy</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]));
        </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">dx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">dy</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    }

    </span><span class="style11">luu</span><span class="style10">.</span><span class="style16">clear</span><span class="style10">();
    </span><span class="style11">R</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">minn</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">m </span><span class="style10">== </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">P </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cost</span><span class="style10">);
        </span><span class="style5">int </span><span class="style11">X </span><span class="style10">= </span><span class="style11">P</span><span class="style10">;
        </span><span class="style11">P </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">cost</span><span class="style10">, </span><span class="style11">cost</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
        </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">X</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cost</span><span class="style10">);
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">P</span><span class="style10">];
        </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">root</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">dd</span><span class="style10">[</span><span class="style11">root</span><span class="style10">]){
            </span><span class="style11">find_center</span><span class="style10">(</span><span class="style11">root</span><span class="style10">);
        }
    }

    </span><span class="style5">int </span><span class="style11">tplt </span><span class="style10">= </span><span class="style11">R</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">R</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">R</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style16">greater</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;());

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">tplt </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">) </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] + </span><span class="style11">R</span><span class="style10">[</span><span class="style4">1</span><span class="style10">] + </span><span class="style11">L</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">tplt </span><span class="style10">&gt; </span><span class="style4">2</span><span class="style10">) </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">R</span><span class="style10">[</span><span class="style4">1</span><span class="style10">] + </span><span class="style11">R</span><span class="style10">[</span><span class="style4">2</span><span class="style10">] + </span><span class="style11">L</span><span class="style10">*</span><span class="style4">2</span><span class="style10">);

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">maxx</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">21</span><span class="style10">];

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
    </span><span class="style11">f</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;

    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">k</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] =
            (</span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]*</span><span class="style4">2</span><span class="style10">*</span><span class="style11">j </span><span class="style10">+ </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]*(</span><span class="style11">i </span><span class="style10">- </span><span class="style4">2</span><span class="style10">*(</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))) % </span><span class="style4">2021</span><span class="style10">;
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">f</span><span class="style10">[</span><span class="style11">n</span><span class="style10">][</span><span class="style11">k</span><span class="style10">];
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style3">/**

F[i-1]   =   0*F[i-2] + F[i-1]        [0, 1]
F[i]     =   2*F[i-2] + F[i-1]        [2, 1]

**/

</span><span class="style5">struct </span><span class="style11">Matrix</span><span class="style10">{
    </span><span class="style5">long long </span><span class="style11">c</span><span class="style10">[</span><span class="style4">3</span><span class="style10">][</span><span class="style4">3</span><span class="style10">];
    </span><span class="style11">Matrix</span><span class="style10">(){
        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">2</span><span class="style10">;
        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    }
    ~</span><span class="style11">Matrix</span><span class="style10">(){};
};


</span><span class="style11">Matrix nhan</span><span class="style10">(</span><span class="style11">Matrix a</span><span class="style10">, </span><span class="style11">Matrix b</span><span class="style10">){
    </span><span class="style11">Matrix res</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                </span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] =
                (</span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] + </span><span class="style11">a</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">] * </span><span class="style11">b</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
            }
        }
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style11">Matrix Powermod</span><span class="style10">(</span><span class="style11">Matrix res</span><span class="style10">, </span><span class="style5">long long </span><span class="style11">n</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">% </span><span class="style4">2 </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">Matrix T </span><span class="style10">= </span><span class="style11">Powermod</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">n</span><span class="style10">/</span><span class="style4">2</span><span class="style10">);
        </span><span class="style5">return </span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">T</span><span class="style10">, </span><span class="style11">T</span><span class="style10">), </span><span class="style11">res</span><span class="style10">);
    }
    </span><span class="style11">Matrix T </span><span class="style10">= </span><span class="style11">Powermod</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">n</span><span class="style10">/</span><span class="style4">2</span><span class="style10">);
    </span><span class="style5">return </span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">T</span><span class="style10">, </span><span class="style11">T</span><span class="style10">);
}

</span><span class="style5">long long </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
        </span><span class="style11">Matrix A</span><span class="style10">;
        </span><span class="style11">A </span><span class="style10">= </span><span class="style11">Powermod</span><span class="style10">(</span><span class="style11">A</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">A</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style3">/**

F[i] = F[i-1] + 2*F[i-2]         [1, 2]
F[i-1] = F[i-1]                  [1, 0]

**/

</span><span class="style5">struct </span><span class="style11">Matrix</span><span class="style10">{
    </span><span class="style5">long long </span><span class="style11">c</span><span class="style10">[</span><span class="style4">3</span><span class="style10">][</span><span class="style4">3</span><span class="style10">];
    </span><span class="style11">Matrix</span><span class="style10">(){
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">c</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">c</span><span class="style10">));
    }

    </span><span class="style5">static </span><span class="style11">Matrix unit</span><span class="style10">(){
        </span><span class="style11">Matrix x</span><span class="style10">;
        </span><span class="style11">x</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
    }

    </span><span class="style11">Matrix </span><span class="style5">operator </span><span class="style10">* (</span><span class="style5">const </span><span class="style11">Matrix</span><span class="style10">&amp; </span><span class="style11">b</span><span class="style10">){
        </span><span class="style11">Matrix res</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
                </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                    </span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] =
                    (</span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] + </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">] * </span><span class="style11">b</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
                }
            }
        }
        </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
    }

    </span><span class="style11">Matrix Poww</span><span class="style10">(</span><span class="style5">long long </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">Matrix res </span><span class="style10">= </span><span class="style11">unit</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
        </span><span class="style11">Matrix T </span><span class="style10">= </span><span class="style11">Poww</span><span class="style10">(</span><span class="style11">n</span><span class="style10">/</span><span class="style4">2</span><span class="style10">);
        </span><span class="style11">res </span><span class="style10">= </span><span class="style11">T</span><span class="style10">*</span><span class="style11">T</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">% </span><span class="style4">2 </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style11">res </span><span class="style10">= </span><span class="style11">res </span><span class="style10">* (*</span><span class="style5">this</span><span class="style10">);
        </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
    }
};

</span><span class="style5">long long </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">n </span><span class="style10">+= </span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">Matrix T</span><span class="style10">;
    </span><span class="style11">T</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">T</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">T</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">T</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">Matrix A </span><span class="style10">= </span><span class="style11">T</span><span class="style10">.</span><span class="style11">Poww</span><span class="style10">(</span><span class="style11">n</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">A</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] - </span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style3">/**

F[i] = F[i-1] + 2*F[i-2]         [1, 2]
F[i-1] = F[i-1]                  [1, 0]

**/

</span><span class="style5">struct </span><span class="style11">Matrix</span><span class="style10">{
    </span><span class="style5">long long </span><span class="style11">c</span><span class="style10">[</span><span class="style4">3</span><span class="style10">][</span><span class="style4">3</span><span class="style10">];
    </span><span class="style11">Matrix</span><span class="style10">(){
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">c</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">c</span><span class="style10">));
    }

    </span><span class="style5">static </span><span class="style11">Matrix unit</span><span class="style10">(){
        </span><span class="style11">Matrix x</span><span class="style10">;
        </span><span class="style11">x</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
    }

    </span><span class="style11">Matrix </span><span class="style5">operator </span><span class="style10">* (</span><span class="style5">const </span><span class="style11">Matrix</span><span class="style10">&amp; </span><span class="style11">b</span><span class="style10">){
        </span><span class="style11">Matrix res</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
                </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                    </span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] =
                    (</span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] + </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">] * </span><span class="style11">b</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
                }
            }
        }
        </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
    }

    </span><span class="style11">Matrix Poww</span><span class="style10">(</span><span class="style5">long long </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">Matrix res </span><span class="style10">= </span><span class="style11">unit</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
        </span><span class="style11">Matrix T </span><span class="style10">= </span><span class="style11">Poww</span><span class="style10">(</span><span class="style11">n</span><span class="style10">/</span><span class="style4">2</span><span class="style10">);
        </span><span class="style11">res </span><span class="style10">= </span><span class="style11">T</span><span class="style10">*</span><span class="style11">T</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">% </span><span class="style4">2 </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style11">res </span><span class="style10">= </span><span class="style11">res </span><span class="style10">* (*</span><span class="style5">this</span><span class="style10">);
        </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
    }
};

</span><span class="style5">long long </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
        </span><span class="style11">Matrix T</span><span class="style10">;
        </span><span class="style11">T</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">T</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">2</span><span class="style10">;
        </span><span class="style11">T</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">Matrix A </span><span class="style10">= </span><span class="style11">T</span><span class="style10">.</span><span class="style11">Poww</span><span class="style10">(</span><span class="style11">n</span><span class="style10">);
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">A</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define Task                    "B"
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style3">/**
f[i]   = f[i-1] + f[i-2] + f[i-3]
f[i-1] = f[i-1]
f[i-2] = f[i-2]
**/
</span><span class="style5">long long </span><span class="style11">n</span><span class="style10">,</span><span class="style11">M</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">Matrix</span><span class="style10">{
    </span><span class="style5">long long </span><span class="style11">c</span><span class="style10">[</span><span class="style4">3</span><span class="style10">][</span><span class="style4">3</span><span class="style10">];
    </span><span class="style11">Matrix</span><span class="style10">(){
        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">2</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;

        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">2</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;

        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">2</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">2</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;        </span><span class="style11">c</span><span class="style10">[</span><span class="style4">2</span><span class="style10">][</span><span class="style4">2</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    }
    ~</span><span class="style11">Matrix</span><span class="style10">(){};
}; </span><span class="style11">Matrix A</span><span class="style10">;

</span><span class="style11">Matrix nhan</span><span class="style10">(</span><span class="style11">Matrix a</span><span class="style10">, </span><span class="style11">Matrix b</span><span class="style10">){
    </span><span class="style11">Matrix res</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                </span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] =
                ((</span><span class="style11">res</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] % </span><span class="style11">M</span><span class="style10">) + (</span><span class="style11">a</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">]*</span><span class="style11">b</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] % </span><span class="style11">M</span><span class="style10">)) % </span><span class="style11">M</span><span class="style10">;
            }
        }
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style11">Matrix power</span><span class="style10">(</span><span class="style11">Matrix res</span><span class="style10">, </span><span class="style5">long long </span><span class="style11">n</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">% </span><span class="style4">2 </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">Matrix T </span><span class="style10">= </span><span class="style11">power</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">n</span><span class="style10">/</span><span class="style4">2</span><span class="style10">);
        </span><span class="style5">return </span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">T</span><span class="style10">, </span><span class="style11">T</span><span class="style10">), </span><span class="style11">res</span><span class="style10">);
    }
    </span><span class="style11">Matrix T </span><span class="style10">= </span><span class="style11">power</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">n</span><span class="style10">/</span><span class="style4">2</span><span class="style10">);
    </span><span class="style5">return </span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">T</span><span class="style10">, </span><span class="style11">T</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">M</span><span class="style10">;

    </span><span class="style11">A </span><span class="style10">= </span><span class="style11">power</span><span class="style10">(</span><span class="style11">A</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">A</span><span class="style10">.</span><span class="style11">c</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">];
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">h</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">Matrix</span><span class="style10">{
    </span><span class="style5">long long </span><span class="style11">val</span><span class="style10">[</span><span class="style4">102</span><span class="style10">][</span><span class="style4">102</span><span class="style10">];
};

</span><span class="style11">Matrix nhan</span><span class="style10">(</span><span class="style11">Matrix a</span><span class="style10">, </span><span class="style11">Matrix b</span><span class="style10">){
    </span><span class="style11">Matrix res</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">h</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">h</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">res</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style11">h</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                </span><span class="style11">res</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] =
                (</span><span class="style11">res</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] + </span><span class="style11">a</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">] * </span><span class="style11">b</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
            }
        }
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style11">Matrix power</span><span class="style10">(</span><span class="style11">Matrix res</span><span class="style10">, </span><span class="style5">long long </span><span class="style11">d</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
    </span><span class="style11">Matrix T </span><span class="style10">= </span><span class="style11">power</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">d</span><span class="style10">/</span><span class="style4">2</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d </span><span class="style10">% </span><span class="style4">2 </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">T</span><span class="style10">, </span><span class="style11">T</span><span class="style10">);
    </span><span class="style5">return </span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">T</span><span class="style10">, </span><span class="style11">T</span><span class="style10">), </span><span class="style11">res</span><span class="style10">);
}

</span><span class="style11">Matrix A</span><span class="style10">;
</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">h </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">h</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style4">0</span><span class="style10">, </span><span class="style11">i</span><span class="style10">-</span><span class="style11">k</span><span class="style10">); </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">h</span><span class="style10">, </span><span class="style11">i</span><span class="style10">+</span><span class="style11">k</span><span class="style10">); </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">A</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
        }
    }

    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">h</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">h</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">A</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }

    </span><span class="style11">A </span><span class="style10">= </span><span class="style11">power</span><span class="style10">(</span><span class="style11">A</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">);
    </span><span class="style2">// Do day bat dau tu 1, nen bieu thuc xac dinh la
    // F[n] = T^(n-1) * F[1]
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">A</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">h</span><span class="style10">][</span><span class="style4">0</span><span class="style10">];

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">h</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">h</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">A</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">long long </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style5">long long </span><span class="style11">c</span><span class="style10">[</span><span class="style4">103</span><span class="style10">];

</span><span class="style5">struct </span><span class="style11">Matrix</span><span class="style10">{
    </span><span class="style5">long long </span><span class="style11">val</span><span class="style10">[</span><span class="style4">103</span><span class="style10">][</span><span class="style4">103</span><span class="style10">];
}; </span><span class="style11">Matrix Final</span><span class="style10">;

</span><span class="style11">Matrix nhan</span><span class="style10">(</span><span class="style11">Matrix a</span><span class="style10">, </span><span class="style11">Matrix b</span><span class="style10">){
    </span><span class="style11">Matrix res</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">100</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style4">100</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">res</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style4">100</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                </span><span class="style11">res</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] =
                (</span><span class="style11">res</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] + </span><span class="style11">a</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">] * </span><span class="style11">b</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
            }
        }
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style11">Matrix Power</span><span class="style10">(</span><span class="style11">Matrix a</span><span class="style10">, </span><span class="style5">long long </span><span class="style11">n</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">a</span><span class="style10">;
    </span><span class="style11">Matrix T </span><span class="style10">= </span><span class="style11">Power</span><span class="style10">(</span><span class="style11">a</span><span class="style10">, </span><span class="style11">n</span><span class="style10">/</span><span class="style4">2</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">% </span><span class="style4">2 </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">T</span><span class="style10">, </span><span class="style11">T</span><span class="style10">);
    </span><span class="style5">return </span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">nhan</span><span class="style10">(</span><span class="style11">T</span><span class="style10">, </span><span class="style11">T</span><span class="style10">), </span><span class="style11">a</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">Init</span><span class="style10">(){
    </span><span class="style11">Final</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">Final</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style11">Final</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style4">1</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">[</span><span class="style4">1</span><span class="style10">];
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">100</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">Final</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">Final</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">Final</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style4">1</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">int </span><span class="style11">x</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
        </span><span class="style11">c</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]++;
    }
    </span><span class="style11">Init</span><span class="style10">();

    </span><span class="style11">Final </span><span class="style10">= </span><span class="style11">Power</span><span class="style10">(</span><span class="style11">Final</span><span class="style10">, </span><span class="style11">k</span><span class="style10">);

</span><span class="style2">//    for (int i = 0; i &lt;= 100; i++){
//        for (int j = 0; j &lt;= 100; j++){
//            cout &lt;&lt; Final.val[i][j] &lt;&lt; " ";
//        }
//        cout &lt;&lt; "\n";
//    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; (</span><span class="style11">Final</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] + </span><span class="style11">Final</span><span class="style10">.</span><span class="style11">val</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">1</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define pii pair&lt;int, int&gt;
#define f first
#define s second
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">,</span><span class="style11">b</span><span class="style10">;
</span><span class="style11">pii p</span><span class="style10">[</span><span class="style4">300001</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">a </span><span class="style10">&gt;&gt; </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f </span><span class="style10">&gt;&gt; </span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">;
    }
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">p</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">p</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">two_pointer</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">minn </span><span class="style10">= </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">dema </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">demb </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dema </span><span class="style10">&lt; </span><span class="style11">a </span><span class="style10">|| </span><span class="style11">demb </span><span class="style10">&lt; </span><span class="style11">b</span><span class="style10">){
            </span><span class="style11">j</span><span class="style10">++;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">p</span><span class="style10">[</span><span class="style11">j</span><span class="style10">].</span><span class="style11">s </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style11">dema</span><span class="style10">++;
            </span><span class="style5">else </span><span class="style11">demb</span><span class="style10">++;
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style11">i</span><span class="style10">++;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) </span><span class="style11">dema</span><span class="style10">--;
            </span><span class="style5">else </span><span class="style11">demb</span><span class="style10">--;
            </span><span class="style11">minn </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minn</span><span class="style10">, </span><span class="style11">p</span><span class="style10">[</span><span class="style11">j</span><span class="style10">].</span><span class="style11">f </span><span class="style10">- </span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f</span><span class="style10">);
        }
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">minn </span><span class="style10">== </span><span class="style11">INT_MAX</span><span class="style10">) </span><span class="style5">return </span><span class="style10">-</span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">minn</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">two_pointer</span><span class="style10">(</span><span class="style11">n</span><span class="style10">);
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"MAXRANGE.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"MAXRANGE.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tree</span><span class="style10">[</span><span class="style4">4</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">id</span><span class="style10">[</span><span class="style4">4</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">build</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">){
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
        </span><span class="style11">id</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">node</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">pos</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">node </span><span class="style10">= </span><span class="style11">id</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">];
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">node </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">node </span><span class="style10">/= </span><span class="style4">2</span><span class="style10">;
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
    }
}

</span><span class="style5">int </span><span class="style11">getmax</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">INT_MIN</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">maxleft </span><span class="style10">= </span><span class="style11">getmax</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">maxright </span><span class="style10">= </span><span class="style11">getmax</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style5">return </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxleft</span><span class="style10">, </span><span class="style11">maxright</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) {
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">getmax</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style2">//for (int i = 1; i &lt;= 4*n; i++) cout &lt;&lt; tree[i].val &lt;&lt; " ";
</span><span class="style10">}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"MINRANGE.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"MINRANGE.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tree</span><span class="style10">[</span><span class="style4">4</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">id</span><span class="style10">[</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">build</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">){
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
        </span><span class="style11">id</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">node</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">pos</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">node </span><span class="style10">= </span><span class="style11">id</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">];
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">] = </span><span class="style11">val</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">node </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">node </span><span class="style10">/= </span><span class="style4">2</span><span class="style10">;
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
    }
}

</span><span class="style5">int </span><span class="style11">getmin</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">];
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">minleft </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">minright </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style5">return </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minleft</span><span class="style10">, </span><span class="style11">minright</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">getmin</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">T</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">val</span><span class="style10">, </span><span class="style11">pre</span><span class="style10">;
};
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">100001</span><span class="style10">];
</span><span class="style11">T tree</span><span class="style10">[</span><span class="style4">4</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">build</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">){
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">].</span><span class="style11">val</span><span class="style10">, </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">t </span><span class="style10">= </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre</span><span class="style10">;
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">= </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">= </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">){
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">= </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">) </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">node</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">].</span><span class="style11">val</span><span class="style10">, </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">getmin</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style5">return </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val</span><span class="style10">;
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">) </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">node</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">minleft </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">minright </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style5">return </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minleft</span><span class="style10">, </span><span class="style11">minright</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) {
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
            </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">getmin</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style2">//for (int i = 1; i &lt;= 4*n; i++) cout &lt;&lt; tree[i].val &lt;&lt; " ";
</span><span class="style10">}

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style4">0</span><span class="style10">), </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style5">nullptr</span><span class="style10">), </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style5">nullptr</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style16">deque</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">de</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">s</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">stacking</span><span class="style10">()
{
    </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style4">1</span><span class="style10">, </span><span class="style11">r </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">k</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">r </span><span class="style10">!= </span><span class="style11">l</span><span class="style10">-</span><span class="style4">1 </span><span class="style10">&amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">s</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]]) </span><span class="style11">r</span><span class="style10">--;
        </span><span class="style11">s</span><span class="style10">[++</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">s</span><span class="style10">[</span><span class="style11">l</span><span class="style10">]] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">s</span><span class="style10">[</span><span class="style11">l</span><span class="style10">] &lt;= </span><span class="style11">i</span><span class="style10">-</span><span class="style11">k </span><span class="style10">&amp;&amp; </span><span class="style11">l </span><span class="style10">!= </span><span class="style11">r</span><span class="style10">+</span><span class="style4">1</span><span class="style10">) </span><span class="style11">l</span><span class="style10">++;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">r </span><span class="style10">!= </span><span class="style11">l</span><span class="style10">-</span><span class="style4">1 </span><span class="style10">&amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">s</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]]) </span><span class="style11">r</span><span class="style10">--;
        </span><span class="style11">s</span><span class="style10">[++</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">s</span><span class="style10">[</span><span class="style11">l</span><span class="style10">]] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">stacking2</span><span class="style10">(){
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">k</span><span class="style10">){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">back</span><span class="style10">()]){
            </span><span class="style11">de</span><span class="style10">.</span><span class="style16">pop_back</span><span class="style10">();
        }
        </span><span class="style11">de</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">front</span><span class="style10">()] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">de</span><span class="style10">.</span><span class="style16">front</span><span class="style10">() + </span><span class="style11">k </span><span class="style10">&lt;= </span><span class="style11">i</span><span class="style10">) </span><span class="style11">de</span><span class="style10">.</span><span class="style16">pop_front</span><span class="style10">();
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">de</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">back</span><span class="style10">()]) </span><span class="style11">de</span><span class="style10">.</span><span class="style16">pop_back</span><span class="style10">();
        </span><span class="style11">de</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">de</span><span class="style10">.</span><span class="style16">front</span><span class="style10">()] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">stacking2</span><span class="style10">();
        </span><span class="style11">de</span><span class="style10">.</span><span class="style16">clear</span><span class="style10">();
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">struct </span><span class="style11">T</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">pre</span><span class="style10">, </span><span class="style11">val</span><span class="style10">;
};
</span><span class="style11">T tree</span><span class="style10">[</span><span class="style4">4</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">build</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">){
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">].</span><span class="style11">val</span><span class="style10">, </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">t </span><span class="style10">= </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre</span><span class="style10">;
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">+= </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">+= </span><span class="style11">t</span><span class="style10">;

    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">].</span><span class="style11">val </span><span class="style10">+= </span><span class="style11">t</span><span class="style10">;
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">k</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val </span><span class="style10">+= </span><span class="style11">t</span><span class="style10">;

    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">+= </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre </span><span class="style10">+= </span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style11">lazypush</span><span class="style10">(</span><span class="style11">node</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">update</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val </span><span class="style10">= </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre
    </span><span class="style10">+ </span><span class="style16">min</span><span class="style10">(</span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">].</span><span class="style11">val</span><span class="style10">, </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">val</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">getmin</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style5">return </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">val</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">minleft </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">minright </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style5">return </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minleft</span><span class="style10">, </span><span class="style11">minright</span><span class="style10">) + </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">].</span><span class="style11">pre</span><span class="style10">;
}
</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
            </span><span class="style11">update</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">getmin</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">struct </span><span class="style11">edge</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
};
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">edge</span><span class="style10">&gt; </span><span class="style11">E</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">dem</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">Union</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">return true</span><span class="style10">;
    }
    </span><span class="style5">return false</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">w </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">w</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">Kruskal</span><span class="style10">(){
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">par</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">par</span><span class="style10">));

    </span><span class="style5">int </span><span class="style11">sum </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">edge</span><span class="style10">&gt; </span><span class="style11">vt</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">edge e </span><span class="style10">: </span><span class="style11">E</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">u</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Union</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">sum </span><span class="style10">+= </span><span class="style11">w</span><span class="style10">;
            </span><span class="style11">vt</span><span class="style10">.</span><span class="style11">pb</span><span class="style10">(</span><span class="style11">e</span><span class="style10">);
        }
    }
    </span><span class="style11">E</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">vt</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">vt</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style5">if </span><span class="style10">((</span><span class="style5">int</span><span class="style10">)</span><span class="style11">E</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() != </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; -</span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">sum</span><span class="style10">;
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">E</span><span class="style10">.</span><span class="style16">insert</span><span class="style10">(</span><span class="style11">E</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), {</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; (</span><span class="style5">int</span><span class="style10">)</span><span class="style11">E</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()-</span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">w </span><span class="style10">&gt; </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">].</span><span class="style11">w</span><span class="style10">) </span><span class="style16">swap</span><span class="style10">(</span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">E</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
            </span><span class="style5">else break</span><span class="style10">;
        } </span><span class="style2">// Optimize algorithm by Insertion sort
        </span><span class="style11">Kruskal</span><span class="style10">();
    }

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">edges</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">w</span><span class="style10">;
};
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">edges</span><span class="style10">&gt; </span><span class="style11">E</span><span class="style10">;
</span><span class="style5">long long </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">u</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">Union</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">v</span><span class="style10">) </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">Same</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">) == </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">));
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style5">const </span><span class="style11">edges</span><span class="style10">&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style5">const </span><span class="style11">edges</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">w </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">w</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">Kruskal</span><span class="style10">(){
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">E</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">E</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">e </span><span class="style10">: </span><span class="style11">E</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">Same</span><span class="style10">(</span><span class="style11">e</span><span class="style10">.</span><span class="style11">u</span><span class="style10">, </span><span class="style11">e</span><span class="style10">.</span><span class="style11">v</span><span class="style10">)) {
            </span><span class="style11">Union</span><span class="style10">(</span><span class="style11">e</span><span class="style10">.</span><span class="style11">u</span><span class="style10">, </span><span class="style11">e</span><span class="style10">.</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">w</span><span class="style10">;
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">E</span><span class="style10">.</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
    </span><span class="style11">Kruskal</span><span class="style10">();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">201</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">M</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">struct </span><span class="style11">edge</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">;
};
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">edge</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style4">20001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">dem</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">cnt</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style11">MOD</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">Union</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">return true</span><span class="style10">;
    }
    </span><span class="style5">return false</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style5">const </span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style5">const </span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">w </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">w</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">Kruskal</span><span class="style10">(){
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">a</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">edge x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">u</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dem </span><span class="style10">== </span><span class="style11">k</span><span class="style10">){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style11">edge e </span><span class="style10">: </span><span class="style11">a</span><span class="style10">){
                </span><span class="style11">u </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">u</span><span class="style10">;
                </span><span class="style11">v </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">v</span><span class="style10">;
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">) != </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">)){
                    </span><span class="style11">res </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">e</span><span class="style10">.</span><span class="style11">w</span><span class="style10">);
                }
            }
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
            </span><span class="style5">return</span><span class="style10">;
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Union</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)) </span><span class="style11">dem</span><span class="style10">--;
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">M</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
        }
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style11">a</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">({</span><span class="style11">i</span><span class="style10">, </span><span class="style11">j</span><span class="style10">, </span><span class="style11">M</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]});
        }
    }


    </span><span class="style11">dem </span><span class="style10">= </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">cnt </span><span class="style10">= </span><span class="style11">n</span><span class="style10">*(</span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">Kruskal</span><span class="style10">();
</span><span class="style2">//    for (edge x : a)
//    cout &lt;&lt; x.u &lt;&lt; " " &lt;&lt; x.v &lt;&lt; " " &lt;&lt; x.w &lt;&lt; "\n";
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1001</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">edge</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
};
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">edge</span><span class="style10">&gt; </span><span class="style11">E</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">res</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt;&gt; </span><span class="style11">E1</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">root</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">Union</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style11">u </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">v </span><span class="style10">= </span><span class="style11">root</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">!= </span><span class="style11">v</span><span class="style10">){
        </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
        </span><span class="style5">return true</span><span class="style10">;
    }
    </span><span class="style5">return false</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style11">edge</span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">w </span><span class="style10">&lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style11">w</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">Kruskal</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">e </span><span class="style10">: </span><span class="style11">E</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">u</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Union</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">w</span><span class="style10">;
            </span><span class="style11">E1</span><span class="style10">.</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">});
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">Kruskal2</span><span class="style10">(</span><span class="style5">int </span><span class="style11">uu</span><span class="style10">, </span><span class="style5">int </span><span class="style11">vv</span><span class="style10">){
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">par</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">par</span><span class="style10">));

    </span><span class="style5">int </span><span class="style11">cost </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">e </span><span class="style10">: </span><span class="style11">E</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">u</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">uu </span><span class="style10">&amp;&amp; </span><span class="style11">v </span><span class="style10">== </span><span class="style11">vv</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Union</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">cost </span><span class="style10">+= </span><span class="style11">w</span><span class="style10">;
        }
    }
    </span><span class="style16">set</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">checker</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style11">checker</span><span class="style10">.</span><span class="style16">insert</span><span class="style10">(</span><span class="style11">root</span><span class="style10">(</span><span class="style11">i</span><span class="style10">));
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">checker</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &gt; </span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">cost</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">E</span><span class="style10">.</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }

    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">E</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">E</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style11">Kruskal</span><span class="style10">();

    </span><span class="style11">res </span><span class="style10">= </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">E1</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">Kruskal2</span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">, </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">));
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">5001</span><span class="style10">;
</span><span class="style11">pii a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">is0</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">double </span><span class="style11">Op</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">double </span><span class="style11">ans </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;

</span><span class="style5">double </span><span class="style11">sqr</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">*</span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">double </span><span class="style11">dist</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i</span><span class="style10">, </span><span class="style5">int </span><span class="style11">j</span><span class="style10">, </span><span class="style11">pii a</span><span class="style10">, </span><span class="style11">pii b</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">is0</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] || </span><span class="style11">is0</span><span class="style10">[</span><span class="style11">j</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]) </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">sqrt</span><span class="style10">(</span><span class="style11">sqr</span><span class="style10">(</span><span class="style11">a</span><span class="style10">.</span><span class="style11">f </span><span class="style10">- </span><span class="style11">b</span><span class="style10">.</span><span class="style11">f</span><span class="style10">) + </span><span class="style11">sqr</span><span class="style10">(</span><span class="style11">a</span><span class="style10">.</span><span class="style11">s </span><span class="style10">- </span><span class="style11">b</span><span class="style10">.</span><span class="style11">s</span><span class="style10">));
}

</span><span class="style5">void </span><span class="style11">Push</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">double </span><span class="style11">k </span><span class="style10">= </span><span class="style11">dist</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &amp;&amp; </span><span class="style11">Op</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt; </span><span class="style11">k</span><span class="style10">) </span><span class="style11">Op</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">k</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">Prim</span><span class="style10">(</span><span class="style5">int </span><span class="style11">root</span><span class="style10">){
    </span><span class="style11">Op</span><span class="style10">[</span><span class="style11">root</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">Push</span><span class="style10">(</span><span class="style11">root</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(</span><span class="style5">true</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) {
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">d</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &amp;&amp; </span><span class="style11">Op</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &gt; </span><span class="style11">Op</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">u </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
        </span><span class="style11">ans </span><span class="style10">+= </span><span class="style11">Op</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
        </span><span class="style11">Push</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }
}

</span><span class="style5">int </span><span class="style11">x</span><span class="style10">,</span><span class="style11">y</span><span class="style10">;
</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
</span><span class="style2">//        cin &gt;&gt; x &gt;&gt; y;
//        a[i] = {x, y};
</span><span class="style15">///       BÃ&nbsp;i há»c Ä‘á»ƒ Ä‘á»i, Ä‘á»«ng cin nhÆ° cÃ¡ch trÃªn :')
///       trÃ&nbsp;n bá»™ nhá»› nhÆ° chÆ¡i
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">f </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">s</span><span class="style10">;
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x </span><span class="style10">&gt;&gt; </span><span class="style11">y</span><span class="style10">;
        </span><span class="style11">is0</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">y</span><span class="style10">] = </span><span class="style11">is0</span><span class="style10">[</span><span class="style11">y</span><span class="style10">][</span><span class="style11">x</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">) </span><span class="style11">Op</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">1e9 </span><span class="style10">+ </span><span class="style4">7</span><span class="style10">;
    </span><span class="style11">Prim</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">fixed </span><span class="style10">&lt;&lt; </span><span class="style16">setprecision</span><span class="style10">(</span><span class="style4">2</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">ans </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
</span><span class="style2">//    up(i, 1, n) cout &lt;&lt; Op[i] &lt;&lt; " ";

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">connect</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">long long </span><span class="style11">ans </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style5">bool </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">canh </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style15">///distance

</span><span class="style5">void </span><span class="style11">Push</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &amp;&amp; </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt; </span><span class="style11">w</span><span class="style10">){
            </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">w</span><span class="style10">;
            </span><span class="style11">connect</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">; </span><span class="style15">/// Truy vet
        </span><span class="style10">}
    }
}

</span><span class="style5">void </span><span class="style11">Prim</span><span class="style10">(</span><span class="style5">int </span><span class="style11">root</span><span class="style10">){
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">dist</span><span class="style10">, </span><span class="style11">dist</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">INT_MAX</span><span class="style10">);
    </span><span class="style11">Push</span><span class="style10">(</span><span class="style11">root</span><span class="style10">);
    </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">root</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style4">1</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">d</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &amp;&amp; </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &gt; </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">u </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
        </span><span class="style11">canh</span><span class="style10">++;
        </span><span class="style11">ans </span><span class="style10">+= </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
        </span><span class="style11">Push</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
    </span><span class="style11">Prim</span><span class="style10">(</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">ans</span><span class="style10">;

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">canh </span><span class="style10">!= </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"-1"</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">i </span><span class="style10">&lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">connect</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">st</span><span class="style10">[</span><span class="style4">200</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dem </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">8</span><span class="style10">][</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">8</span><span class="style10">][</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">init</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">state </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">state </span><span class="style10">&lt; (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">8</span><span class="style10">); </span><span class="style11">state</span><span class="style10">++){
        </span><span class="style5">if </span><span class="style10">((</span><span class="style11">state </span><span class="style10">&amp; (</span><span class="style11">state </span><span class="style10">&gt;&gt; </span><span class="style4">1</span><span class="style10">)) == </span><span class="style4">0</span><span class="style10">){
            </span><span class="style11">st</span><span class="style10">[++</span><span class="style11">dem</span><span class="style10">] = </span><span class="style11">state</span><span class="style10">;
        }
    }
}

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style4">8</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
        }
    }
}

</span><span class="style5">void </span><span class="style11">dp_bit</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">state </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">state </span><span class="style10">&lt;= </span><span class="style11">dem</span><span class="style10">; </span><span class="style11">state</span><span class="style10">++){
            </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">st</span><span class="style10">[</span><span class="style11">state</span><span class="style10">];
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style4">8</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">i</span><span class="style10">)){
                    </span><span class="style11">f</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] += </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
                }
            }

            </span><span class="style5">int </span><span class="style11">maxx </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">r </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">dem</span><span class="style10">; </span><span class="style11">r</span><span class="style10">++){
                </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">st</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
                </span><span class="style5">if </span><span class="style10">((</span><span class="style11">x </span><span class="style10">&amp; </span><span class="style11">k</span><span class="style10">) == </span><span class="style4">0</span><span class="style10">){
                    </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]);
                }
            }
            </span><span class="style11">f</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] += </span><span class="style11">maxx</span><span class="style10">;
        }
    }
}

</span><span class="style5">void </span><span class="style11">pr_mb</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style4">8</span><span class="style10">); </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">result</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">maxx </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">dem</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[</span><span class="style11">st</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]][</span><span class="style11">n</span><span class="style10">]);
    }
    </span><span class="style5">int </span><span class="style11">maxx2 </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style4">8</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">maxx2 </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx2</span><span class="style10">, </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]);
        }
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">maxx2 </span><span class="style10">&lt; </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style11">maxx2</span><span class="style10">;
    </span><span class="style5">else return </span><span class="style11">maxx</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style11">init</span><span class="style10">();
    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">dp_bit</span><span class="style10">();
    </span><span class="style2">//pr_mb();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">result</span><span class="style10">(</span><span class="style11">n</span><span class="style10">);
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">d</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] += </span><span class="style11">val</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">+= (</span><span class="style11">x </span><span class="style10">&amp; -</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style11">add</span><span class="style10">(</span><span class="style11">l</span><span class="style10">, </span><span class="style11">val</span><span class="style10">);
    </span><span class="style11">add</span><span class="style10">(</span><span class="style11">r</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, -</span><span class="style11">val</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">point_query</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">ans </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">ans </span><span class="style10">+= </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">];
        </span><span class="style11">x </span><span class="style10">-= (</span><span class="style11">x </span><span class="style10">&amp; -</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">ans</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">l </span><span class="style10">&gt;&gt; </span><span class="style11">r </span><span class="style10">&gt;&gt; </span><span class="style11">d</span><span class="style10">;
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">l</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">d</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style5">int </span><span class="style11">x</span><span class="style10">;
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">point_query</span><span class="style10">(</span><span class="style11">x</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}
</span><span class="style15">///Template created by PPAP_1264589
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style16">stack</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">sk</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">s</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">mm1</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">mm2</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">left</span><span class="style10">(){
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &gt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">()]){
            </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()) </span><span class="style11">mm1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">mm1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
        </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">right1</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">top </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">rolldown</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">top </span><span class="style10">&gt; </span><span class="style4">0 </span><span class="style10">&amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &gt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">s</span><span class="style10">[</span><span class="style11">top</span><span class="style10">]]) </span><span class="style11">top</span><span class="style10">--;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">top </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style11">mm2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">mm2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">s</span><span class="style10">[</span><span class="style11">top</span><span class="style10">];
        </span><span class="style11">s</span><span class="style10">[++</span><span class="style11">top</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">right2</span><span class="style10">(){
    </span><span class="style11">rolldown</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &gt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">()]){
            </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()) </span><span class="style11">mm2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">mm2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
        </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">left</span><span class="style10">();
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()) </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
    </span><span class="style11">right2</span><span class="style10">();
    </span><span class="style11">rollup</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">mm1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">mm2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}
</span><span class="style15">///From VNOI with love

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">long long </span><span class="style11">a</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">long long </span><span class="style11">b</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">ll</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">rr</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">ll1</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">rr1</span><span class="style10">[</span><span class="style4">1000001</span><span class="style10">];
</span><span class="style16">stack</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">sk</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">left</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">()]) </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()) </span><span class="style11">ll</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">ll</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
        </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">right</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">()]) </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()) </span><span class="style11">rr</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">rr</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
        </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">left2</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;= </span><span class="style11">b</span><span class="style10">[</span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">()]) </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()) </span><span class="style11">ll1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">ll1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
        </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">right2</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">() &amp;&amp; </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;= </span><span class="style11">b</span><span class="style10">[</span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">()]) </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">sk</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()) </span><span class="style11">rr1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">else </span><span class="style11">rr1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
        </span><span class="style11">sk</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">pr_mb</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">ll</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" " </span><span class="style10">&lt;&lt; </span><span class="style11">rr</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"RECT.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"RECT.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) {
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">m </span><span class="style10">- </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }
    </span><span class="style11">left</span><span class="style10">();
    </span><span class="style11">sk </span><span class="style10">= </span><span class="style16">stack</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; {};
    </span><span class="style11">right</span><span class="style10">();
    </span><span class="style11">sk </span><span class="style10">= </span><span class="style16">stack</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; {};
    </span><span class="style11">left2</span><span class="style10">();
    </span><span class="style11">sk </span><span class="style10">= </span><span class="style16">stack</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; {};
    </span><span class="style11">right2</span><span class="style10">();
    </span><span class="style5">long long </span><span class="style11">res </span><span class="style10">= -</span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">res </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, (</span><span class="style11">rr</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style11">ll</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style4">1</span><span class="style10">)*</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
        </span><span class="style11">res </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, (</span><span class="style11">rr1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style11">ll1</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style4">1</span><span class="style10">)*</span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] += </span><span class="style11">val</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">int </span><span class="style11">Sum</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">];
        </span><span class="style11">x </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">while</span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">Sum</span><span class="style10">(</span><span class="style11">v</span><span class="style10">) - </span><span class="style11">Sum</span><span class="style10">(</span><span class="style11">u</span><span class="style10">-</span><span class="style4">1</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style2">//http://cpp.sh/9ozksz
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">21</span><span class="style10">][</span><span class="style4">21</span><span class="style10">];
</span><span class="style5">long long </span><span class="style11">f</span><span class="style10">[</span><span class="style4">2000000</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
        }
    }
}

</span><span class="style5">void </span><span class="style11">Dp_bit</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">st </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">st </span><span class="style10">&lt; (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">); </span><span class="style11">st</span><span class="style10">++){
        </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">__builtin_popcount</span><span class="style10">(</span><span class="style11">st</span><span class="style10">);
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
            </span><span class="style5">if </span><span class="style10">(!(</span><span class="style11">st </span><span class="style10">&gt;&gt; </span><span class="style11">i </span><span class="style10">&amp; </span><span class="style4">1</span><span class="style10">)){
                </span><span class="style11">f</span><span class="style10">[</span><span class="style11">st </span><span class="style10">| (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">)] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">st </span><span class="style10">| (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">)], </span><span class="style11">f</span><span class="style10">[</span><span class="style11">st</span><span class="style10">] + </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">]);
            }
            </span><span class="style2">//cout &lt;&lt; (st | (1 &lt;&lt; (i-1))) &lt;&lt; " " &lt;&lt; f[(st | (1 &lt;&lt; (i-1)))] &lt;&lt; endl;
        </span><span class="style10">}
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">f</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">];
}

</span><span class="style5">void </span><span class="style11">Dp_bit2</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">st </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">st </span><span class="style10">&lt; (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">); </span><span class="style11">st</span><span class="style10">++){
        </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">__builtin_popcount</span><span class="style10">(</span><span class="style11">st</span><span class="style10">);
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">st </span><span class="style10">&gt;&gt; </span><span class="style11">i </span><span class="style10">&amp; </span><span class="style4">1</span><span class="style10">){
                </span><span class="style11">f</span><span class="style10">[</span><span class="style11">st</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">st</span><span class="style10">], </span><span class="style11">f</span><span class="style10">[</span><span class="style11">st </span><span class="style10">&amp;~ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">)] + </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">k</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]);
            }
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">f</span><span class="style10">[(</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">n</span><span class="style10">) - </span><span class="style4">1</span><span class="style10">];
}

</span><span class="style5">int </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">IOS
    setFile</span><span class="style10">();
    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">Dp_bit2</span><span class="style10">();
}

</span><span class="style9">#define f first
#define s second
#define up(i, a, b) for (int i = (a); i &lt;= (b); i++)
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
}

</span><span class="style5">int </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] != -</span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
    </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">) + </span><span class="style11">w</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
}

</span><span class="style5">int </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">f</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">f</span><span class="style10">));
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; *</span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">f</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">f</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);

    </span><span class="style15">///debug
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">queue</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">degin</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">degin</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]++;
    }
}

</span><span class="style5">void </span><span class="style11">DP</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">degin</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }

    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">q</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">q</span><span class="style10">.</span><span class="style16">front</span><span class="style10">();
        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &lt; </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style11">w</span><span class="style10">){
                </span><span class="style11">f</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style11">w</span><span class="style10">;
            }
            </span><span class="style5">if </span><span class="style10">(--</span><span class="style11">degin</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        }
        </span><span class="style11">q</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">DP</span><span class="style10">();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; *</span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">f</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">f</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">b</span><span class="style10">){
    </span><span class="style11">a </span><span class="style10">= </span><span class="style11">a </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a </span><span class="style10">&gt;= </span><span class="style11">MOD</span><span class="style10">) </span><span class="style11">a </span><span class="style10">-= </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] != -</span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
    </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style11">add</span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">) + </span><span class="style4">1</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
}


</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    }

    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">f</span><span class="style10">, </span><span class="style11">f</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }

    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style11">add</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;

    </span><span class="style15">///debug
</span><span class="style2">//    cout &lt;&lt; "\n";
//    up(i, 1, n) cout &lt;&lt; f[i] &lt;&lt; " ";
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">deg</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style16">queue</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">deg</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]++;
    }
}

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">b</span><span class="style10">){
    </span><span class="style11">a </span><span class="style10">= </span><span class="style11">a </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a </span><span class="style10">&gt;= </span><span class="style11">MOD</span><span class="style10">) </span><span class="style11">a </span><span class="style10">-= </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">DP</span><span class="style10">(){
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">deg</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }

    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">q</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">q</span><span class="style10">.</span><span class="style16">front</span><span class="style10">();
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style11">add</span><span class="style10">(</span><span class="style11">f</span><span class="style10">[</span><span class="style11">v</span><span class="style10">], </span><span class="style11">f</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">);
            </span><span class="style5">if </span><span class="style10">(--</span><span class="style11">deg</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        }
        </span><span class="style11">q</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">DP</span><span class="style10">();

    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style11">add</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;

    </span><span class="style15">///debug
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">ra</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">ds</span><span class="style10">;
</span><span class="style5">short </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">scc</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">DFS1</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style11">DFS1</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    }
    </span><span class="style11">ds</span><span class="style10">.</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">DFS2</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">res</span><span class="style10">[</span><span class="style11">scc</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">ra</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] != </span><span class="style4">2</span><span class="style10">) </span><span class="style11">DFS2</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    }
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style5">const </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style5">const </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() != </span><span class="style11">y</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() ? </span><span class="style11">x</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() : </span><span class="style11">x</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] &lt; </span><span class="style11">y</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">ra</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">d</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">DFS1</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }

    </span><span class="style16">reverse</span><span class="style10">(</span><span class="style11">ds</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">ds</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">u </span><span class="style10">: </span><span class="style11">ds</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] != </span><span class="style4">2</span><span class="style10">){
            </span><span class="style11">scc</span><span class="style10">++;
            </span><span class="style11">DFS2</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
        }
    }

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">scc </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">scc</span><span class="style10">) </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">end</span><span class="style10">());
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">res</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">res</span><span class="style10">+</span><span class="style11">scc</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">scc</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">x </span><span class="style10">: </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">x </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style15">///Kosaraju Implementation
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;

</span><span class="style5">bool </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">stack</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">st</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">SCC</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style11">st</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style11">SCC</span><span class="style10">++;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style5">true</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">st</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
            </span><span class="style11">st</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
            </span><span class="style11">res</span><span class="style10">[</span><span class="style11">SCC</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">== </span><span class="style11">u</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
        }
        </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">res</span><span class="style10">[</span><span class="style11">SCC</span><span class="style10">].</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">res</span><span class="style10">[</span><span class="style11">SCC</span><span class="style10">].</span><span class="style16">end</span><span class="style10">());
    }
}

</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style5">const </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;&amp; </span><span class="style11">x</span><span class="style10">, </span><span class="style5">const </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;&amp; </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() == </span><span class="style11">y</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()) </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] &lt; </span><span class="style11">y</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]);
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style16">size</span><span class="style10">() &lt; </span><span class="style11">y</span><span class="style10">.</span><span class="style16">size</span><span class="style10">());
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">res</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">res</span><span class="style10">+</span><span class="style11">SCC</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">SCC </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">SCC</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">x </span><span class="style10">: </span><span class="style11">res</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">x </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">b</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">Tg</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">val</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">start</span><span class="style10">, </span><span class="style11">p</span><span class="style10">;
</span><span class="style5">bool </span><span class="style11">isgame</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">int </span><span class="style11">SCC</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">st</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">int </span><span class="style11">res</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">val</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">start </span><span class="style10">&gt;&gt; </span><span class="style11">p</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">pos</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">p</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">pos</span><span class="style10">;
        </span><span class="style11">isgame</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    }
}

</span><span class="style5">int </span><span class="style11">top </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style11">st</span><span class="style10">[++</span><span class="style11">top</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;

    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style11">SCC</span><span class="style10">++;
        </span><span class="style5">int </span><span class="style11">tol </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style5">true</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">st</span><span class="style10">[</span><span class="style11">top</span><span class="style10">--];
            </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">SCC</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">isgame</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style11">Tg</span><span class="style10">[</span><span class="style11">SCC</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">tol </span><span class="style10">+= </span><span class="style11">val</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
        }
        </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">SCC</span><span class="style10">] = </span><span class="style11">tol</span><span class="style10">;
    }
}

</span><span class="style5">int </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] != -</span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">Tg</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
    </span><span class="style5">else </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = -</span><span class="style4">1000001</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">b</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">) + </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
    }
    </span><span class="style5">return </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
</span><span class="style2">//    setFile();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">ui </span><span class="style10">= </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
            </span><span class="style5">int </span><span class="style11">vi </span><span class="style10">= </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">ui </span><span class="style10">!= </span><span class="style11">vi</span><span class="style10">){
                </span><span class="style11">b</span><span class="style10">[</span><span class="style11">ui</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">vi</span><span class="style10">);
            }
        }
    }

    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">start </span><span class="style10">= </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">start</span><span class="style10">];
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">start</span><span class="style10">);

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;

#define Task                    "F"
#define ll                      long long
#define bit(x,i)                ((x &gt;&gt; i) &amp; 1)
#define stt(x,i)                (x &amp; (1 &lt;&lt; i))
#define trail0(x)               (x &amp; (-x))
#define up(i,a,b)               for (int i = (a); i &lt;= (b); i++)
#define down(i,a,b)             for (int i = (a); i &gt;= (b); i--)
#define pb                      push_back
#define ep                      emplace_back
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">b</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">SCC</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">x</span><span class="style10">;
</span><span class="style16">set</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">s</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">st</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">top</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style11">st</span><span class="style10">[++</span><span class="style11">top</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style11">SCC</span><span class="style10">++;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style5">true</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">st</span><span class="style10">[</span><span class="style11">top</span><span class="style10">--];
            </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">SCC</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
        }
    }
}

</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] != -</span><span class="style4">1</span><span class="style10">) </span><span class="style5">return </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
    </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">b</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">) + </span><span class="style4">1</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
}

</span><span class="style5">void </span><span class="style11">prepare</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">clear</span><span class="style10">();
        </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">clear</span><span class="style10">();
    }
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">idx</span><span class="style10">, </span><span class="style11">idx</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">inSCC</span><span class="style10">, </span><span class="style11">inSCC</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">x</span><span class="style10">.</span><span class="style16">clear</span><span class="style10">();
    </span><span class="style11">s</span><span class="style10">.</span><span class="style16">clear</span><span class="style10">();
    </span><span class="style11">SCC </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">tdfs </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">top </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">s</span><span class="style10">.</span><span class="style16">insert</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
        </span><span class="style11">s</span><span class="style10">.</span><span class="style16">insert</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
    }
}

</span><span class="style5">void </span><span class="style11">compress_to_DAG</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">u </span><span class="style10">: </span><span class="style11">x</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">ui </span><span class="style10">= </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
            </span><span class="style5">int </span><span class="style11">vi </span><span class="style10">= </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">ui </span><span class="style10">!= </span><span class="style11">vi</span><span class="style10">){
                </span><span class="style11">b</span><span class="style10">[</span><span class="style11">ui</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">vi</span><span class="style10">);
            }
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style11">prepare</span><span class="style10">();
        </span><span class="style11">x</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">s</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">s</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
        </span><span class="style2">// tim tap hop chi chua nhung node co size() != 0

        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">u </span><span class="style10">: </span><span class="style11">x</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
        }
        </span><span class="style11">compress_to_DAG</span><span class="style10">();

        </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= -</span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">SCC</span><span class="style10">){
            </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            </span><span class="style11">res </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; ((</span><span class="style11">res </span><span class="style10">== </span><span class="style11">SCC</span><span class="style10">) ? </span><span class="style6">"YES" </span><span class="style10">: </span><span class="style6">"NO"</span><span class="style10">); </span><span class="style2">// neu duong di bang so node cua DAG =&gt; YES
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">ma</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">intplt</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">SCC</span><span class="style10">;
</span><span class="style16">deque</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">st</span><span class="style10">;

</span><span class="style5">long long </span><span class="style11">res</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">ma</span><span class="style10">.</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">});
    }
}

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style11">st</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">intplt</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style11">SCC</span><span class="style10">++;
        </span><span class="style5">long long </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style4">1</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">st</span><span class="style10">.</span><span class="style16">back</span><span class="style10">();
            </span><span class="style11">st</span><span class="style10">.</span><span class="style16">pop_back</span><span class="style10">();
            </span><span class="style11">k</span><span class="style10">++;
            </span><span class="style11">intplt</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">SCC</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
        }
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">k</span><span class="style10">*(</span><span class="style11">k</span><span class="style10">-</span><span class="style4">1</span><span class="style10">);
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) {
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            </span><span class="style11">st</span><span class="style10">.</span><span class="style16">clear</span><span class="style10">();
        }
    }

    </span><span class="style16">set</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">s</span><span class="style10">(</span><span class="style11">ma</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">ma</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style11">ma</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">s</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">s</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());

    </span><span class="style5">for </span><span class="style10">(</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;::</span><span class="style16">iterator </span><span class="style11">it </span><span class="style10">= </span><span class="style11">ma</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(); </span><span class="style11">it </span><span class="style10">!= </span><span class="style11">ma</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(); </span><span class="style11">it</span><span class="style10">++){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">it</span><span class="style10">-&gt;</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">it</span><span class="style10">-&gt;</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">intplt</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">intplt</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">res</span><span class="style10">--;
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">b</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">low</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">deg</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">SCC</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">stack</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">st</span><span class="style10">;
</span><span class="style5">bool </span><span class="style11">xh</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
    </span><span class="style11">st</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">low</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
        }
        </span><span class="style5">else </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] == </span><span class="style11">idx</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style11">SCC</span><span class="style10">++;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style5">true</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">st</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
            </span><span class="style11">st</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
            </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">SCC</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
        }
    }
}

</span><span class="style5">void </span><span class="style11">Prepare</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">clear</span><span class="style10">();
        </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">clear</span><span class="style10">();
    }
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">idx</span><span class="style10">, </span><span class="style11">idx</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">inSCC</span><span class="style10">, </span><span class="style11">inSCC</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">xh</span><span class="style10">, </span><span class="style11">xh</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">); </span><span class="style2">// Ä‘Ã¡nh dáº¥u Ä‘á»‰nh cÃ³ tá»± do hay khÃ´ng
    </span><span class="style11">SCC </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">tdfs </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">xh</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">xh</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
    }
}

</span><span class="style16">queue</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">q</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">topo</span><span class="style10">;
</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style11">Prepare</span><span class="style10">();

        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">xh</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &amp;&amp; !</span><span class="style11">idx</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">Tarjan</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        }

        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">xh</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &amp;&amp; </span><span class="style11">xh</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
                    </span><span class="style5">int </span><span class="style11">ui </span><span class="style10">= </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">u</span><span class="style10">];
                    </span><span class="style5">int </span><span class="style11">vi </span><span class="style10">= </span><span class="style11">inSCC</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
                    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">ui </span><span class="style10">!= </span><span class="style11">vi</span><span class="style10">){
                        </span><span class="style11">b</span><span class="style10">[</span><span class="style11">ui</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">vi</span><span class="style10">);
                    }
                }
            }
        } </span><span class="style2">// nÃ©n thÃ&nbsp;nh DAG

        </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">deg</span><span class="style10">, </span><span class="style11">deg</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">SCC</span><span class="style10">){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
                </span><span class="style11">deg</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]++;
            }
        }

        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">SCC</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">deg</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        }
        </span><span class="style11">topo</span><span class="style10">.</span><span class="style16">clear</span><span class="style10">();
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">q</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
            </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">q</span><span class="style10">.</span><span class="style16">front</span><span class="style10">();
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">: </span><span class="style11">b</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
                </span><span class="style5">if </span><span class="style10">(--</span><span class="style11">deg</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">){
                    </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
                    </span><span class="style11">topo</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">});
                }
            }
            </span><span class="style11">q</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        }

        </span><span class="style5">bool </span><span class="style11">flag </span><span class="style10">= </span><span class="style5">true</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">topo</span><span class="style10">) {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">f </span><span class="style10">!= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">){
                </span><span class="style11">flag </span><span class="style10">= </span><span class="style5">false</span><span class="style10">;
                </span><span class="style5">break</span><span class="style10">;
            }
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">flag</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"YES"</span><span class="style10">;
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"NO"</span><span class="style10">;
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style15">/// ÄÃ¡nh sá»‘ láº¡i Ä‘á»“ thá»‹ báº±ng Tarjan
/// sáº¯p xáº¿p cÃ¡c cáº¡nh theo topo
/// Ä‘á»ƒ Ä‘i háº¿t trÃªn DAG thÃ¬ pháº£i "1 Ä‘i khÃ´ng trá»Ÿ láº¡i"
/// nÃªn cÃ¡c cáº¡nh sau khi sáº¯p xáº¿p topo pháº£i thoÃ£ mÃ£n cÃ¡c Ä‘á»‰nh liá»n ká» nhau
/// 1-2, 2-3, 3-4
/// n-1, n

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">par</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">18</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">h</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tdfs</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">!= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]){
            </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = ++</span><span class="style11">tdfs</span><span class="style10">;
            </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style11">w</span><span class="style10">;

            </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
            </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">17</span><span class="style10">){
                </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">par</span><span class="style10">[</span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]][</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">];
            }
            </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">tdfs</span><span class="style10">--;
        }
    }
}

</span><span class="style5">int </span><span class="style11">LCA</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &lt; </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style16">swap</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">delta </span><span class="style10">= </span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] - </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];

    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">17</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">delta</span><span class="style10">, </span><span class="style11">i</span><span class="style10">)) </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">u</span><span class="style10">;

    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">17</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] != </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]){
            </span><span class="style11">u </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
            </span><span class="style11">v </span><span class="style10">= </span><span class="style11">par</span><span class="style10">[</span><span class="style11">v</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        }
    }

    </span><span class="style5">return </span><span class="style11">par</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style4">0</span><span class="style10">];
}

</span><span class="style5">void </span><span class="style11">solve</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style11">h</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">par</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]+</span><span class="style4">17</span><span class="style10">, </span><span class="style4">0</span><span class="style10">);
    }
    </span><span class="style11">tdfs </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">clear</span><span class="style10">();
    }

    </span><span class="style5">int </span><span class="style11">x</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">n </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style11">exit</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">x</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">i</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }

    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">q</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">;

    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">q</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">p </span><span class="style10">= </span><span class="style11">LCA</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] + </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] - </span><span class="style4">2</span><span class="style10">*</span><span class="style11">cost</span><span class="style10">[</span><span class="style11">p</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}


</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style5">while </span><span class="style10">(</span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">solve</span><span class="style10">();
    }

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define bit(x,i) (x &amp; (1 &lt;&lt; (i)))
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"SELECT.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"SELECT.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">st</span><span class="style10">[] = {</span><span class="style4">0</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style4">2</span><span class="style10">,</span><span class="style4">4</span><span class="style10">,</span><span class="style4">5</span><span class="style10">,</span><span class="style4">8</span><span class="style10">,</span><span class="style4">9</span><span class="style10">,</span><span class="style4">10</span><span class="style10">}; </span><span class="style2">// no adjaction 1-bit
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">4</span><span class="style10">][</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">f</span><span class="style10">[</span><span class="style4">11</span><span class="style10">][</span><span class="style4">100001</span><span class="style10">]; </span><span class="style15">/// 100001: REMEMBER to plus 1 when you cin from 1, not from 0

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style4">4</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
        }
    }
}

</span><span class="style5">void </span><span class="style11">dp_bit</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){ </span><span class="style2">// iterate from all columns
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">state </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">state </span><span class="style10">&lt; </span><span class="style4">8</span><span class="style10">; </span><span class="style11">state</span><span class="style10">++){ </span><span class="style2">// for each columns we have selection
            </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">st</span><span class="style10">[</span><span class="style11">state</span><span class="style10">];

            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style4">4</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">i</span><span class="style10">)) </span><span class="style11">f</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] += </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]; </span><span class="style2">// each selection plus into caculation
            </span><span class="style10">}

            </span><span class="style5">int </span><span class="style11">maxx </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">k </span><span class="style10">&lt; </span><span class="style4">8</span><span class="style10">; </span><span class="style11">k</span><span class="style10">++){
                </span><span class="style5">int </span><span class="style11">y </span><span class="style10">= </span><span class="style11">st</span><span class="style10">[</span><span class="style11">k</span><span class="style10">];
                </span><span class="style5">if </span><span class="style10">((</span><span class="style11">x </span><span class="style10">&amp; </span><span class="style11">y</span><span class="style10">) == </span><span class="style4">0</span><span class="style10">){
                    </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[</span><span class="style11">y</span><span class="style10">][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]); </span><span class="style2">// Dp
                </span><span class="style10">}
            }
            </span><span class="style11">f</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] += </span><span class="style11">maxx</span><span class="style10">;
        }
    }
}

</span><span class="style5">void </span><span class="style11">pr_mb</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">10</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">f</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">dp_bit</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">maxx </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style4">8</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">f</span><span class="style10">[</span><span class="style11">st</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]][</span><span class="style11">n</span><span class="style10">]);
    }
    </span><span class="style5">int </span><span class="style11">maxx2 </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style4">4</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">maxx2 </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx2</span><span class="style10">, </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]);
        }
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">maxx2 </span><span class="style10">&lt; </span><span class="style4">0</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">maxx2</span><span class="style10">; </span><span class="style2">// If the whole array contains negative values
    </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">maxx</span><span class="style10">;
    </span><span class="style2">//pr_mb();
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">701</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">2001</span><span class="style10">]; </span><span class="style2">// do abs(a[i]) co the dat toi 1000 -&gt; (a[i] + a[j] &lt;= 2000)

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">y</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">maxn</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">y</span><span class="style10">; </span><span class="style11">v </span><span class="style10">&lt;= </span><span class="style4">2001</span><span class="style10">; </span><span class="style11">v </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] += </span><span class="style11">val</span><span class="style10">;
        }
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style5">int </span><span class="style11">get</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">y</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">cur </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">y</span><span class="style10">; </span><span class="style11">v </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">; </span><span class="style11">v </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">v</span><span class="style10">)){
            </span><span class="style11">cur </span><span class="style10">= (</span><span class="style11">cur </span><span class="style10">+ </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">v</span><span class="style10">]) % </span><span class="style11">MOD</span><span class="style10">;
        }
        </span><span class="style11">x </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">cur</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">scanf</span><span class="style10">(</span><span class="style6">"%d"</span><span class="style10">, &amp;</span><span class="style11">n</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style11">scanf</span><span class="style10">(</span><span class="style6">"%d"</span><span class="style10">, &amp;</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);

    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style11">n</span><span class="style10">, </span><span class="style4">2</span><span class="style10">){
        </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){
            </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] + </span><span class="style11">a</span><span class="style10">[</span><span class="style11">j</span><span class="style10">];
            </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = (</span><span class="style11">get</span><span class="style10">(</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">, </span><span class="style4">2001</span><span class="style10">) - </span><span class="style11">get</span><span class="style10">(</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">, </span><span class="style11">x</span><span class="style10">) + </span><span class="style4">1 </span><span class="style10">+ </span><span class="style11">MOD</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style11">x</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]);
        }
    }

    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style11">res </span><span class="style10">= (</span><span class="style11">res </span><span class="style10">+ </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] - </span><span class="style4">1 </span><span class="style10">+ </span><span class="style11">MOD</span><span class="style10">) % </span><span class="style11">MOD</span><span class="style10">;
        }
    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style11">printf</span><span class="style10">(</span><span class="style6">"%d"</span><span class="style10">, </span><span class="style11">res</span><span class="style10">);
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;

#define Task            "SEQ2015"
#define up(i,a,b)       for (int i = (a); i &lt;= (b); i++)
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style4">701</span><span class="style10">][</span><span class="style4">701</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">b</span><span class="style10">){
    </span><span class="style11">a </span><span class="style10">= </span><span class="style11">a </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a </span><span class="style10">&gt;= </span><span class="style4">30103</span><span class="style10">) </span><span class="style11">a </span><span class="style10">-= </span><span class="style4">30103</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">p </span><span class="style10">= </span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">; </span><span class="style11">p </span><span class="style10">&lt; </span><span class="style11">j</span><span class="style10">; </span><span class="style11">p</span><span class="style10">++){
                </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">q </span><span class="style10">= </span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">; </span><span class="style11">q </span><span class="style10">&gt; </span><span class="style11">p</span><span class="style10">; </span><span class="style11">q</span><span class="style10">--){
                    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">p</span><span class="style10">] + </span><span class="style11">a</span><span class="style10">[</span><span class="style11">q</span><span class="style10">] &lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] + </span><span class="style11">a</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]){
                        </span><span class="style11">add</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">p</span><span class="style10">][</span><span class="style11">q</span><span class="style10">], </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">);
                    }
                }
            }
        }
    }

</span><span class="style2">//    up(i, 1, n){
//        up(j, 1, n){
//            cout &lt;&lt; dp[i][j] &lt;&lt; " ";
//        }
//        cout &lt;&lt; "\n";
//    }
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
            </span><span class="style11">add</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">]);
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">200001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">h</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">p</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;

</span><span class="style5">struct </span><span class="style11">ST</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">4</span><span class="style10">], </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">id</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

    </span><span class="style5">void </span><span class="style11">build</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">){
            </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
            </span><span class="style11">id</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">nod</span><span class="style10">;
            </span><span class="style5">return</span><span class="style10">;
        }
        </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
        </span><span class="style11">build</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
        </span><span class="style11">build</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
    }

    </span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">pos</span><span class="style10">, </span><span class="style5">int </span><span class="style11">val</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">id</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">];
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">] = </span><span class="style11">val</span><span class="style10">;

        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">nod </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">nod </span><span class="style10">/= </span><span class="style4">2</span><span class="style10">;
            </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">], </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
        }
    }

    </span><span class="style5">int </span><span class="style11">getmin</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v </span><span class="style10">&lt; </span><span class="style11">l </span><span class="style10">|| </span><span class="style11">u </span><span class="style10">&gt; </span><span class="style11">r</span><span class="style10">) </span><span class="style5">return </span><span class="style11">INT_MAX</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">];
        </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">left </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
        </span><span class="style5">int </span><span class="style11">right </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
        </span><span class="style5">return </span><span class="style16">min</span><span class="style10">(</span><span class="style11">left</span><span class="style10">, </span><span class="style11">right</span><span class="style10">);
    }
};

</span><span class="style11">ST Tmin</span><span class="style10">, </span><span class="style11">Tmax</span><span class="style10">;
</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">h</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style11">p</span><span class="style10">[</span><span class="style11">h</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">i</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">Tmin</span><span class="style10">.</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">Tmax</span><span class="style10">.</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">p</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;

</span><span class="style2">//    up(i, 1, n){
//        cin &gt;&gt; h[i];
//        p[h[i]] = i;
//    }
//    up(i, 1, n){
//        cout &lt;&lt; p[i] &lt;&lt; " ";
//    }
//    cout &lt;&lt; "\n";

    </span><span class="style11">Tmin</span><span class="style10">.</span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);
    </span><span class="style11">Tmax</span><span class="style10">.</span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);

    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">Tmin</span><span class="style10">.</span><span class="style11">update</span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">Tmin</span><span class="style10">.</span><span class="style11">update</span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">], </span><span class="style11">u</span><span class="style10">);
            </span><span class="style11">Tmax</span><span class="style10">.</span><span class="style11">update</span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], -</span><span class="style11">v</span><span class="style10">);
            </span><span class="style11">Tmax</span><span class="style10">.</span><span class="style11">update</span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">], -</span><span class="style11">u</span><span class="style10">);

</span><span class="style2">//            Tmin.update(u, h[v]);
//            Tmin.update(v, h[u]);
//            Tmax.update(u, -h[v]);
//            Tmax.update(v, -h[u]);
            </span><span class="style16">swap</span><span class="style10">(</span><span class="style11">h</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">h</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style5">int </span><span class="style11">minh </span><span class="style10">= </span><span class="style11">Tmin</span><span class="style10">.</span><span class="style11">getmin</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
            </span><span class="style5">int </span><span class="style11">maxh </span><span class="style10">= -</span><span class="style11">Tmax</span><span class="style10">.</span><span class="style11">getmin</span><span class="style10">(</span><span class="style4">1</span><span class="style10">,</span><span class="style4">1</span><span class="style10">,</span><span class="style11">n</span><span class="style10">);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">maxh </span><span class="style10">- </span><span class="style11">minh </span><span class="style10">== </span><span class="style11">v </span><span class="style10">- </span><span class="style11">u</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"YES"</span><span class="style10">;
            </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"NO"</span><span class="style10">;
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#define ep emplace_back
#define Task "A"
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">155</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">edge</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">v</span><span class="style10">,</span><span class="style11">c</span><span class="style10">,</span><span class="style11">d</span><span class="style10">;
};
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">edge</span><span class="style10">&gt; </span><span class="style11">E</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">s</span><span class="style10">, </span><span class="style11">f</span><span class="style10">, </span><span class="style11">W</span><span class="style10">;
</span><span class="style5">double </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">C</span><span class="style10">;
</span><span class="style16">priority_queue</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">, </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;, </span><span class="style16">greater</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;&gt; </span><span class="style11">P</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s </span><span class="style10">&gt;&gt; </span><span class="style11">f </span><span class="style10">&gt;&gt; </span><span class="style11">W</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">c</span><span class="style10">,</span><span class="style11">d</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">c </span><span class="style10">&gt;&gt; </span><span class="style11">d</span><span class="style10">;
        </span><span class="style11">E</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">c</span><span class="style10">, </span><span class="style11">d</span><span class="style10">});
        </span><span class="style11">E</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">c</span><span class="style10">, </span><span class="style11">d</span><span class="style10">});
        </span><span class="style11">C</span><span class="style10">.</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">c</span><span class="style10">);
    }
}

</span><span class="style5">double </span><span class="style11">Dijkstra</span><span class="style10">(</span><span class="style5">int </span><span class="style11">cmin</span><span class="style10">){
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">d</span><span class="style10">, </span><span class="style11">d</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style4">100001</span><span class="style10">);
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">s</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style4">0</span><span class="style10">, </span><span class="style11">s</span><span class="style10">});
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">P</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">curd </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">f</span><span class="style10">; </span><span class="style2">//current delay
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">f</span><span class="style10">){
            </span><span class="style5">return </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">f</span><span class="style10">] + </span><span class="style5">double</span><span class="style10">(</span><span class="style11">W </span><span class="style10">/ </span><span class="style5">double</span><span class="style10">(</span><span class="style11">cmin</span><span class="style10">)));
        }
        </span><span class="style11">P</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">curd </span><span class="style10">!= </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">edge e </span><span class="style10">: </span><span class="style11">E</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">v</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">c</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">delay </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">d</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">&lt; </span><span class="style11">cmin</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">; </span><span class="style2">// neu c &lt; cmin thi se mat nhieu time hon -&gt; loai
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt; </span><span class="style11">curd </span><span class="style10">+ </span><span class="style11">delay</span><span class="style10">){  </span><span class="style2">//tim delay nho nhat
                </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">curd </span><span class="style10">+ </span><span class="style11">delay</span><span class="style10">;
                </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">], </span><span class="style11">v</span><span class="style10">});
            }
        }
    }

    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">f</span><span class="style10">] + (</span><span class="style11">W </span><span class="style10">/ </span><span class="style5">double</span><span class="style10">(</span><span class="style11">cmin</span><span class="style10">)));
}

</span><span class="style5">int </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style5">double </span><span class="style11">res </span><span class="style10">= </span><span class="style11">DBL_MAX</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">c </span><span class="style10">: </span><span class="style11">C</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">Dijkstra</span><span class="style10">(</span><span class="style11">c</span><span class="style10">));
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">fixed </span><span class="style10">&lt;&lt; </span><span class="style16">setprecision</span><span class="style10">(</span><span class="style4">2</span><span class="style10">);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">priority_queue</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">P</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w1</span><span class="style10">,</span><span class="style11">w2</span><span class="style10">;
</span><span class="style5">char </span><span class="style11">T</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int </span><span class="style11">f1</span><span class="style10">, </span><span class="style5">int </span><span class="style11">f2</span><span class="style10">, </span><span class="style5">int </span><span class="style11">w</span><span class="style10">){
    </span><span class="style11">a</span><span class="style10">[</span><span class="style11">f1</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">f2</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
}

</span><span class="style5">void </span><span class="style11">Dijkstra</span><span class="style10">(){
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">d</span><span class="style10">, </span><span class="style11">d</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">INT_MAX</span><span class="style10">);
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">n</span><span class="style10">] = </span><span class="style11">d</span><span class="style10">[</span><span class="style11">n</span><span class="style10">+</span><span class="style11">n</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({-</span><span class="style11">d</span><span class="style10">[</span><span class="style11">n</span><span class="style10">], </span><span class="style11">n</span><span class="style10">});
    </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({-</span><span class="style11">d</span><span class="style10">[</span><span class="style11">n</span><span class="style10">+</span><span class="style11">n</span><span class="style10">], </span><span class="style11">n</span><span class="style10">+</span><span class="style11">n</span><span class="style10">});
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">P</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">curw </span><span class="style10">= -</span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">f</span><span class="style10">;
        </span><span class="style11">P</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();

        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style4">1 </span><span class="style10">|| </span><span class="style11">u </span><span class="style10">== </span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">curw </span><span class="style10">&gt; </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt; </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">){
                </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">;
                </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({-</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">], </span><span class="style11">v</span><span class="style10">});
            }
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w1 </span><span class="style10">&gt;&gt; </span><span class="style11">w2 </span><span class="style10">&gt;&gt; </span><span class="style11">T</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T </span><span class="style10">== </span><span class="style7">'M'</span><span class="style10">){
            </span><span class="style11">add</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">+</span><span class="style11">n</span><span class="style10">, </span><span class="style11">w1</span><span class="style10">);
            </span><span class="style11">add</span><span class="style10">(</span><span class="style11">v</span><span class="style10">+</span><span class="style11">n</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style11">w2</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style11">add</span><span class="style10">(</span><span class="style11">u</span><span class="style10">+</span><span class="style11">n</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">w1</span><span class="style10">);
            </span><span class="style11">add</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">+</span><span class="style11">n</span><span class="style10">, </span><span class="style11">w2</span><span class="style10">);
        }
    }

    </span><span class="style11">Dijkstra</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style4">1</span><span class="style10">], </span><span class="style11">d</span><span class="style10">[</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">res </span><span class="style10">== </span><span class="style11">INT_MAX</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; -</span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tr</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">d</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">s</span><span class="style10">, </span><span class="style11">f</span><span class="style10">;
</span><span class="style16">priority_queue</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">P</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m </span><span class="style10">&gt;&gt; </span><span class="style11">s </span><span class="style10">&gt;&gt; </span><span class="style11">f</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
}

</span><span class="style5">void </span><span class="style11">Dijkstra</span><span class="style10">(){
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">d</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">d</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">INT_MAX</span><span class="style10">);
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">s</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;

    </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({-</span><span class="style11">d</span><span class="style10">[</span><span class="style11">s</span><span class="style10">], </span><span class="style11">s</span><span class="style10">});

    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">P</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">curw </span><span class="style10">= -</span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">f</span><span class="style10">;
        </span><span class="style11">P</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">curw </span><span class="style10">&gt; </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt; </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">){
                </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">;
                </span><span class="style11">tr</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">u</span><span class="style10">;
                </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({-</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">], </span><span class="style11">v</span><span class="style10">});
            }
        }
    }
}

</span><span class="style5">void </span><span class="style11">out</span><span class="style10">(){
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">path</span><span class="style10">;
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">s </span><span class="style10">!= </span><span class="style11">f</span><span class="style10">){
        </span><span class="style11">path</span><span class="style10">.</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">f</span><span class="style10">);
        </span><span class="style11">f </span><span class="style10">= </span><span class="style11">tr</span><span class="style10">[</span><span class="style11">f</span><span class="style10">];
    }
    </span><span class="style11">path</span><span class="style10">.</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">s</span><span class="style10">);
    </span><span class="style16">reverse</span><span class="style10">(</span><span class="style11">path</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">path</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">auto </span><span class="style11">x </span><span class="style10">: </span><span class="style11">path</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">x </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">Dijkstra</span><span class="style10">();
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">d</span><span class="style10">[</span><span class="style11">f</span><span class="style10">];
    </span><span class="style2">//out();

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">10001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">priority_queue</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">, </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;, </span><span class="style16">greater</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;&gt; </span><span class="style11">P</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">da</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">db</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">(</span><span class="style11">make_pair</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">));
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">(</span><span class="style11">make_pair</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">));
    }
}

</span><span class="style5">void </span><span class="style11">Dijkstra</span><span class="style10">(){
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">da</span><span class="style10">, </span><span class="style11">da</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">INT_MAX</span><span class="style10">);
    </span><span class="style11">da</span><span class="style10">[</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style4">0</span><span class="style10">, </span><span class="style4">1</span><span class="style10">});
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">P</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">curw </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">P</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">curw </span><span class="style10">&gt; </span><span class="style11">da</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">da</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt; </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">){
                </span><span class="style11">da</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">;
                </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style11">da</span><span class="style10">[</span><span class="style11">v</span><span class="style10">], </span><span class="style11">v</span><span class="style10">});
            }
        }
    }

    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">db</span><span class="style10">, </span><span class="style11">db</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">INT_MAX</span><span class="style10">);
    </span><span class="style11">db</span><span class="style10">[</span><span class="style4">2</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style4">0</span><span class="style10">, </span><span class="style4">2</span><span class="style10">});
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">P</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">curw </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">P</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">curw </span><span class="style10">&gt; </span><span class="style11">db</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">db</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &gt; </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">){
                </span><span class="style11">db</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">;
                </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style11">db</span><span class="style10">[</span><span class="style11">v</span><span class="style10">], </span><span class="style11">v</span><span class="style10">});
            }
        }
    }
}



</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">Dijkstra</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">da</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }

    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">T</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">T</span><span class="style10">.</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">db</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style11">da</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    }
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">T</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">T</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">/</span><span class="style4">2</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style11">res </span><span class="style10">+= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">k</span><span class="style10">;
</span><span class="style16">priority_queue</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">, </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;, </span><span class="style16">greater</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;&gt; </span><span class="style11">P</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;&gt; </span><span class="style11">d</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">in</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
    </span><span class="style11">d</span><span class="style10">.</span><span class="style16">resize</span><span class="style10">(</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;());
}

</span><span class="style5">void </span><span class="style11">Dijkstra</span><span class="style10">(){
    </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style4">0</span><span class="style10">, </span><span class="style4">1</span><span class="style10">});
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">P</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">curw </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">f</span><span class="style10">;
        </span><span class="style11">P</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">((</span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() != </span><span class="style4">0 </span><span class="style10">&amp;&amp; </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">back</span><span class="style10">() == </span><span class="style11">curw</span><span class="style10">) || </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() &gt;= </span><span class="style11">k</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;
        </span><span class="style11">d</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">ep</span><span class="style10">(</span><span class="style11">curw</span><span class="style10">);

        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">val </span><span class="style10">= </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">;

            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() != </span><span class="style4">0 </span><span class="style10">&amp;&amp; </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style16">back</span><span class="style10">() == </span><span class="style11">val </span><span class="style10">|| </span><span class="style11">d</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() &gt;= </span><span class="style11">k</span><span class="style10">) </span><span class="style5">continue</span><span class="style10">;
            </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style11">val</span><span class="style10">, </span><span class="style11">v</span><span class="style10">});
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style11">in</span><span class="style10">();
    </span><span class="style11">Dijkstra</span><span class="style10">();
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">n</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style16">cout </span><span class="style10">&lt;&lt; -</span><span class="style4">1</span><span class="style10">, </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">x </span><span class="style10">: </span><span class="style11">d</span><span class="style10">[</span><span class="style11">n</span><span class="style10">]) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">x </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">s</span><span class="style10">,</span><span class="style11">f</span><span class="style10">;
</span><span class="style16">priority_queue</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">, </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;, </span><span class="style16">greater</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;&gt; </span><span class="style11">P</span><span class="style10">;

</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">2</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; </span><span class="style11">g</span><span class="style10">[</span><span class="style4">2</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">d</span><span class="style10">[</span><span class="style4">2</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">2</span><span class="style10">];
</span><span class="style5">bool </span><span class="style11">instack</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">2</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">Input</span><span class="style10">(</span><span class="style5">int </span><span class="style11">type</span><span class="style10">){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">w</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">w</span><span class="style10">;
        </span><span class="style11">g</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
        </span><span class="style11">g</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">v</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">u</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
    }
}

</span><span class="style5">void </span><span class="style11">Dijkstra</span><span class="style10">(</span><span class="style5">int </span><span class="style11">type</span><span class="style10">){
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">]+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">]+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">MOD</span><span class="style10">);
    </span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">f</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style4">0</span><span class="style10">, </span><span class="style11">f</span><span class="style10">}); </span><span class="style2">// do phai chuan hoa cac canh theo
                    // chieu giam dan cua khoang cach khi di tu u -&gt; v
                    // theo tieu chi w(u -&gt; finish) &gt; w(v -&gt; finish)
                    // =&gt; Quy hoach tai vi tri f
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">P</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">curw </span><span class="style10">= </span><span class="style11">P</span><span class="style10">.</span><span class="style11">top</span><span class="style10">().</span><span class="style11">f</span><span class="style10">;
        </span><span class="style11">P</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">curw </span><span class="style10">&gt; </span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">u</span><span class="style10">]) </span><span class="style5">continue</span><span class="style10">;

        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">g</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] &gt; </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">){
                </span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">curw </span><span class="style10">+ </span><span class="style11">w</span><span class="style10">;
                </span><span class="style11">P</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">v</span><span class="style10">], </span><span class="style11">v</span><span class="style10">});
            }
        }
    }
}

</span><span class="style5">void </span><span class="style11">ChuanHoa</span><span class="style10">(</span><span class="style5">int </span><span class="style11">type</span><span class="style10">){
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">g</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">u</span><span class="style10">]){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
            </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">u</span><span class="style10">] &gt; </span><span class="style11">d</span><span class="style10">[</span><span class="style11">type</span><span class="style10">][</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style2">// di tu u den v sao cho w(u -&gt; finish) &gt; w(v -&gt; finish)
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">type </span><span class="style10">== </span><span class="style4">0</span><span class="style10">){
                    </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u </span><span class="style10">+ </span><span class="style11">n</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
                }
                </span><span class="style5">else </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style11">pb</span><span class="style10">({</span><span class="style11">v </span><span class="style10">+ </span><span class="style11">n</span><span class="style10">, </span><span class="style11">w</span><span class="style10">});
            }
        }
    }
}

</span><span class="style5">bool </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">*</span><span class="style4">2</span><span class="style10">];
</span><span class="style5">void </span><span class="style11">DFS</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">u </span><span class="style10">== </span><span class="style11">f </span><span class="style10">|| </span><span class="style11">u </span><span class="style10">== </span><span class="style11">f</span><span class="style10">+</span><span class="style11">n</span><span class="style10">) </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">dd</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">instack</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style11">pii x </span><span class="style10">: </span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]){
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">f</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">instack</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; -</span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">exit</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
        }
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">dd</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]) </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dist</span><span class="style10">[</span><span class="style11">u</span><span class="style10">], </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] + </span><span class="style11">w</span><span class="style10">);
    }
    </span><span class="style11">instack</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">fopen</span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">)){
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
        </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
    }

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">s </span><span class="style10">&gt;&gt; </span><span class="style11">f</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">type</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">Input</span><span class="style10">(</span><span class="style11">type</span><span class="style10">);
        </span><span class="style11">Dijkstra</span><span class="style10">(</span><span class="style11">type</span><span class="style10">);
        </span><span class="style11">ChuanHoa</span><span class="style10">(</span><span class="style11">type</span><span class="style10">);
    }
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">dist</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">dist</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, -</span><span class="style11">MOD</span><span class="style10">);
    </span><span class="style11">DFS</span><span class="style10">(</span><span class="style11">s</span><span class="style10">+</span><span class="style11">n</span><span class="style10">);
    </span><span class="style2">// do bat dau tai duong bo nen DFS tu (source+n)

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dist</span><span class="style10">[</span><span class="style11">s</span><span class="style10">+</span><span class="style11">n</span><span class="style10">] &lt; </span><span class="style4">0</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; -</span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">dist</span><span class="style10">[</span><span class="style11">s</span><span class="style10">+</span><span class="style11">n</span><span class="style10">];

</span><span class="style2">//    cout &lt;&lt; "\n";
//    up(i, 1, n) cout &lt;&lt; dist[i] &lt;&lt; " ";
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define int long long
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"SUMRANGE.inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style6">"SUMRANGE.out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">tree</span><span class="style10">[</span><span class="style4">4</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">id</span><span class="style10">[</span><span class="style4">4</span><span class="style10">*</span><span class="style4">100001</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">build</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">){
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
        </span><span class="style11">id</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">node</span><span class="style10">;
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style11">build</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">] + </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">];
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">pos</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">node </span><span class="style10">= </span><span class="style11">id</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">];
    </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">node </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">){
        </span><span class="style11">node </span><span class="style10">/= </span><span class="style4">2</span><span class="style10">;
        </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">] = </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">] + </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">];
    }
}

</span><span class="style5">int </span><span class="style11">getsum</span><span class="style10">(</span><span class="style5">int </span><span class="style11">node</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">){
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">r </span><span class="style10">&lt; </span><span class="style11">u </span><span class="style10">|| </span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt;= </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">v</span><span class="style10">) </span><span class="style5">return </span><span class="style11">tree</span><span class="style10">[</span><span class="style11">node</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= (</span><span class="style11">l</span><span class="style10">+</span><span class="style11">r</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">sumleft </span><span class="style10">= </span><span class="style11">getsum</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">sumright </span><span class="style10">= </span><span class="style11">getsum</span><span class="style10">(</span><span class="style11">node</span><span class="style10">*</span><span class="style4">2</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    </span><span class="style5">return </span><span class="style11">sumleft </span><span class="style10">+ </span><span class="style11">sumright</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">build</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">) {
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">getsum</span><span class="style10">(</span><span class="style4">1</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style2">//for (int i = 1; i &lt;= 4*n; i++) cout &lt;&lt; tree[i].val &lt;&lt; " ";
</span><span class="style10">}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">17</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">l</span><span class="style10">,</span><span class="style11">r</span><span class="style10">;

</span><span class="style2">// [i, i + 2^j - 1]
// =&gt; [i, i + 2^(j-1) - 1] hop voi [i + 2 ^ (j-1), i + 2^j - 1]

</span><span class="style5">void </span><span class="style11">Sparse</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">j</span><span class="style10">) &lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">j</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
            </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">], </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]);
        }
    }
} </span><span class="style2">// Dua vao hai doan con co do dai 2^log2(r-l+1) phu het [i, j]

</span><span class="style5">void </span><span class="style11">Out</span><span class="style10">(){
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">log2</span><span class="style10">(</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">sp</span><span class="style10">[</span><span class="style11">l</span><span class="style10">][</span><span class="style11">k</span><span class="style10">], </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">r </span><span class="style10">- (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">k</span><span class="style10">) + </span><span class="style4">1</span><span class="style10">][</span><span class="style11">k</span><span class="style10">]);
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">Debug</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">log2</span><span class="style10">(</span><span class="style11">n</span><span class="style10">); </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] &lt;&lt; </span><span class="style6">" "</span><span class="style10">;
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style4">0</span><span class="style10">];
    </span><span class="style11">Sparse</span><span class="style10">();
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">l </span><span class="style10">&gt;&gt; </span><span class="style11">r</span><span class="style10">;
        </span><span class="style11">Out</span><span class="style10">();
    }
    </span><span class="style2">//Debug();
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;

#define Task                    "D"
#define ll                      long long
#define bit(x,i)                ((x &gt;&gt; i) &amp; 1)
#define stt(x,i)                (x &amp; (1 &lt;&lt; i))
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">300001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">19</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">get_right</span><span class="style10">(</span><span class="style5">int </span><span class="style11">pos</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">maxh </span><span class="style10">= </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">pos</span><span class="style10">] + </span><span class="style11">k</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">18</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">pos </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">pos</span><span class="style10">] &lt;= </span><span class="style11">maxh</span><span class="style10">){
            </span><span class="style11">pos </span><span class="style10">+= (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">);
        }
    }
    </span><span class="style5">return </span><span class="style11">pos</span><span class="style10">;
} </span><span class="style2">// Return R in binary search

</span><span class="style5">int </span><span class="style11">get_left</span><span class="style10">(</span><span class="style5">int </span><span class="style11">pos</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">maxh </span><span class="style10">= </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">pos</span><span class="style10">] + </span><span class="style11">k</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">18</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">pos </span><span class="style10">- (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) &gt;= </span><span class="style4">0 </span><span class="style10">&amp;&amp; </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">pos </span><span class="style10">- (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) + </span><span class="style4">1</span><span class="style10">] &lt;= </span><span class="style11">maxh</span><span class="style10">){
            </span><span class="style11">pos </span><span class="style10">-= (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">);
        }
    }
    </span><span class="style5">return </span><span class="style11">pos</span><span class="style10">;
} </span><span class="style2">// Return L in binary search

</span><span class="style5">void </span><span class="style11">Sparse</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style4">17</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j</span><span class="style10">], </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))]);
        }
    }
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
    }
    </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">] = </span><span class="style11">INT_MAX</span><span class="style10">;
    </span><span class="style2">//sp[0][0] = INT_MAX;
    </span><span class="style11">Sparse</span><span class="style10">();
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">get_right</span><span class="style10">(</span><span class="style11">i</span><span class="style10">) - </span><span class="style11">get_left</span><span class="style10">(</span><span class="style11">i</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style6">" "</span><span class="style10">;
    }

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}


</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style9">#define int long long

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">long long </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">19</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cost</span><span class="style10">,</span><span class="style11">l</span><span class="style10">,</span><span class="style11">r</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">Sparse</span><span class="style10">(){
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">17</span><span class="style10">){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j</span><span class="style10">], </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))]);
        }
    }
}

</span><span class="style5">int </span><span class="style11">getmin</span><span class="style10">(</span><span class="style5">int </span><span class="style11">pos</span><span class="style10">){
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">17</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">pos </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">n </span><span class="style10">&amp;&amp; </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">pos</span><span class="style10">] &gt; </span><span class="style11">cost</span><span class="style10">){
            </span><span class="style11">pos </span><span class="style10">+= (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">);
        }
    }
    </span><span class="style5">return </span><span class="style11">pos</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
    }
    </span><span class="style11">Sparse</span><span class="style10">();

    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">cost </span><span class="style10">&gt;&gt; </span><span class="style11">l </span><span class="style10">&gt;&gt; </span><span class="style11">r</span><span class="style10">;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&lt;= </span><span class="style11">r</span><span class="style10">){
            </span><span class="style11">l </span><span class="style10">= </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">l</span><span class="style10">);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">l </span><span class="style10">&gt; </span><span class="style11">r</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
            </span><span class="style11">cost </span><span class="style10">%= </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">l</span><span class="style10">];
        }
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">cost </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">18</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">v</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style2">//int f[i][x] == la cha cua x cach x 2^i buoc
//int v = f[i-1][u];

</span><span class="style15">///precompute O(NlogN)
///Access     O(logN)
</span><span class="style5">void </span><span class="style11">Sparse</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">log2</span><span class="style10">(</span><span class="style11">n</span><span class="style10">); </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">u </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">u</span><span class="style10">++){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">u</span><span class="style10">];
            </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">v</span><span class="style10">];
        }
    }
}

</span><span class="style5">void </span><span class="style11">Out</span><span class="style10">(){
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">17</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">bit</span><span class="style10">(</span><span class="style11">k</span><span class="style10">, </span><span class="style11">i</span><span class="style10">)){
            </span><span class="style11">v </span><span class="style10">= </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">v</span><span class="style10">];
        }
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">v </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}


</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">2</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
    }
    </span><span class="style11">Sparse</span><span class="style10">();

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">k</span><span class="style10">;
        </span><span class="style11">Out</span><span class="style10">();
    }

</span><span class="style2">//    for (int i = 0; i &lt;= 17; i++){
//        for (int j = 0; j &lt;= 20; j++){
//            cout &lt;&lt; sp[i][j] &lt;&lt;  " ";
//        }
//        cout &lt;&lt; "\n";
//    }

    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cp</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">compress</span><span class="style10">(){
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">v</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">() + </span><span class="style4">1</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">b</span><span class="style10">){
    </span><span class="style11">a </span><span class="style10">= </span><span class="style11">a </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a </span><span class="style10">&gt;= </span><span class="style11">MOD</span><span class="style10">) </span><span class="style11">a </span><span class="style10">-= </span><span class="style11">MOD</span><span class="style10">;
}
</span><span class="style5">void </span><span class="style11">DP</span><span class="style10">(){
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">+</span><span class="style11">maxn</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">fill</span><span class="style10">(</span><span class="style11">cp</span><span class="style10">, </span><span class="style11">cp</span><span class="style10">+</span><span class="style11">maxn</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">){
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] &lt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]){
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">){
                    </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">;
                    </span><span class="style11">cp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">cp</span><span class="style10">[</span><span class="style11">j</span><span class="style10">];
                }
                </span><span class="style5">else if </span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] == </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">)
                    </span><span class="style11">add</span><span class="style10">(</span><span class="style11">cp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">cp</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]);
            }
        }
    }

    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">lmax </span><span class="style10">= *</span><span class="style16">max_element</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">dp</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] == </span><span class="style11">lmax</span><span class="style10">) </span><span class="style11">add</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">cp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">compress</span><span class="style10">();
    </span><span class="style11">DP</span><span class="style10">();
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">501</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">p</span><span class="style10">,</span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">9</span><span class="style10">][</span><span class="style4">9</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxn</span><span class="style10">];


</span><span class="style5">void </span><span class="style11">Init</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">m</span><span class="style10">){
            </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style4">0</span><span class="style10">][</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
        }
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">u</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">8</span><span class="style10">){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">v </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">j</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">v</span><span class="style10">++){
                </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">j</span><span class="style10">][</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">], </span><span class="style11">sp</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))]);
            }
        }
    }

    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style4">8</span><span class="style10">){
        </span><span class="style11">up</span><span class="style10">(</span><span class="style11">j</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style4">8</span><span class="style10">){
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">u </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">i</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">u</span><span class="style10">++){
                </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">v </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">j</span><span class="style10">) - </span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">v</span><span class="style10">++){
                    </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">][</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j</span><span class="style10">][</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">], </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">][</span><span class="style11">j</span><span class="style10">][</span><span class="style11">u </span><span class="style10">+ (</span><span class="style4">1 </span><span class="style10">&lt;&lt; (</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))][</span><span class="style11">v</span><span class="style10">]);
                }
            }
        }
    }
}

</span><span class="style5">void </span><span class="style11">getmin</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">, </span><span class="style5">int </span><span class="style11">p</span><span class="style10">, </span><span class="style5">int </span><span class="style11">q</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">log2</span><span class="style10">(</span><span class="style11">p</span><span class="style10">-</span><span class="style11">u</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);     </span><span class="style2">//do dai hang
    </span><span class="style5">int </span><span class="style11">l </span><span class="style10">= </span><span class="style11">log2</span><span class="style10">(</span><span class="style11">q</span><span class="style10">-</span><span class="style11">v</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);     </span><span class="style2">//do dai cot
    </span><span class="style5">int </span><span class="style11">r </span><span class="style10">= </span><span class="style11">p </span><span class="style10">- (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">k</span><span class="style10">) + </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">s </span><span class="style10">= </span><span class="style11">q </span><span class="style10">- (</span><span class="style4">1 </span><span class="style10">&lt;&lt; </span><span class="style11">l</span><span class="style10">) + </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">m1 </span><span class="style10">= </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">l</span><span class="style10">][</span><span class="style11">u</span><span class="style10">][</span><span class="style11">v</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">m2 </span><span class="style10">= </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">l</span><span class="style10">][</span><span class="style11">u</span><span class="style10">][</span><span class="style11">s</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">m3 </span><span class="style10">= </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">l</span><span class="style10">][</span><span class="style11">r</span><span class="style10">][</span><span class="style11">v</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">m4 </span><span class="style10">= </span><span class="style11">sp</span><span class="style10">[</span><span class="style11">k</span><span class="style10">][</span><span class="style11">l</span><span class="style10">][</span><span class="style11">r</span><span class="style10">][</span><span class="style11">s</span><span class="style10">];

    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style16">min</span><span class="style10">(</span><span class="style16">min</span><span class="style10">(</span><span class="style16">min</span><span class="style10">(</span><span class="style11">m1</span><span class="style10">, </span><span class="style11">m2</span><span class="style10">), </span><span class="style11">m3</span><span class="style10">), </span><span class="style11">m4</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
}


</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style11">Init</span><span class="style10">();
    </span><span class="style5">int </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">tt</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">tt</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">u </span><span class="style10">&gt;&gt; </span><span class="style11">v </span><span class="style10">&gt;&gt; </span><span class="style11">p </span><span class="style10">&gt;&gt; </span><span class="style11">q</span><span class="style10">;
        </span><span class="style11">getmin</span><span class="style10">(</span><span class="style11">u</span><span class="style10">,</span><span class="style11">v</span><span class="style10">,</span><span class="style11">p</span><span class="style10">,</span><span class="style11">q</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">k</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">BIT</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">compress</span><span class="style10">(){
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">v</span><span class="style10">.</span><span class="style16">assign</span><span class="style10">(</span><span class="style11">a</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">+</span><span class="style11">n</span><span class="style10">+</span><span class="style4">1</span><span class="style10">);
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style16">lower_bound</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">v</span><span class="style10">.</span><span class="style16">end</span><span class="style10">(), </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) - </span><span class="style11">v</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">() + </span><span class="style4">1</span><span class="style10">;
    }
}

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">b</span><span class="style10">){
    </span><span class="style11">a </span><span class="style10">= </span><span class="style11">a </span><span class="style10">+ </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a </span><span class="style10">&gt;= </span><span class="style11">MOD</span><span class="style10">) </span><span class="style11">a </span><span class="style10">-= </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style11">pii v</span><span class="style10">){
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style11">f </span><span class="style10">&gt; </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">f</span><span class="style10">) </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">else if </span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style11">f </span><span class="style10">== </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">f</span><span class="style10">) {
            </span><span class="style11">add</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">s</span><span class="style10">, </span><span class="style11">v</span><span class="style10">.</span><span class="style11">s</span><span class="style10">);
        }
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}

</span><span class="style11">pii getl</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style11">pii res </span><span class="style10">= </span><span class="style11">make_pair</span><span class="style10">(</span><span class="style4">0</span><span class="style10">, </span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">res</span><span class="style10">.</span><span class="style11">f </span><span class="style10">&lt; </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">f</span><span class="style10">) </span><span class="style11">res </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">];
        </span><span class="style5">else if </span><span class="style10">(</span><span class="style11">res</span><span class="style10">.</span><span class="style11">f </span><span class="style10">== </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">f</span><span class="style10">){
            </span><span class="style11">add</span><span class="style10">(</span><span class="style11">res</span><span class="style10">.</span><span class="style11">s</span><span class="style10">, </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">s</span><span class="style10">);
        }
        </span><span class="style11">x </span><span class="style10">-= </span><span class="style11">trail0</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">res</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">) </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    </span><span class="style11">compress</span><span class="style10">();

    </span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style11">v </span><span class="style10">= </span><span class="style11">getl</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]-</span><span class="style4">1</span><span class="style10">);
        </span><span class="style11">update</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">make_pair</span><span class="style10">(</span><span class="style11">v</span><span class="style10">.</span><span class="style11">f</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">v</span><span class="style10">.</span><span class="style11">s</span><span class="style10">));
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">getl</span><span class="style10">(</span><span class="style11">n</span><span class="style10">).</span><span class="style11">s</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define Task                    "G"
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1000001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">Trie</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">child</span><span class="style10">[</span><span class="style4">27</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">depth</span><span class="style10">;
};
</span><span class="style11">Trie T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cnt</span><span class="style10">;
</span><span class="style16">string </span><span class="style11">dict</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">res</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">Add</span><span class="style10">(</span><span class="style16">string </span><span class="style11">s</span><span class="style10">, </span><span class="style5">int </span><span class="style11">i</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">nod </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">char </span><span class="style11">c </span><span class="style10">: </span><span class="style11">s</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style11">c </span><span class="style10">- </span><span class="style7">'a' </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">]) </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">] = ++</span><span class="style11">cnt</span><span class="style10">;
        </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">];
    }
    </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">depth</span><span class="style10">) </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">depth </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">findstring</span><span class="style10">(</span><span class="style5">int </span><span class="style11">nod</span><span class="style10">, </span><span class="style5">int </span><span class="style11">i</span><span class="style10">, </span><span class="style16">string </span><span class="style11">a</span><span class="style10">){ </span><span class="style2">// Force tim ra xau dai nhat
    </span><span class="style5">int </span><span class="style11">pos2 </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">depth</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">pos2</span><span class="style10">){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dict</span><span class="style10">[</span><span class="style11">res</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() == </span><span class="style11">dict</span><span class="style10">[</span><span class="style11">pos2</span><span class="style10">].</span><span class="style16">size</span><span class="style10">()) </span><span class="style11">res </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">res</span><span class="style10">, </span><span class="style11">pos2</span><span class="style10">); </span><span class="style2">// Thu tu tu dien nho nhat
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dict</span><span class="style10">[</span><span class="style11">res</span><span class="style10">].</span><span class="style16">size</span><span class="style10">() &lt; </span><span class="style11">dict</span><span class="style10">[</span><span class="style11">pos2</span><span class="style10">].</span><span class="style16">size</span><span class="style10">()) </span><span class="style11">res </span><span class="style10">= </span><span class="style11">pos2</span><span class="style10">;
    }

    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">i </span><span class="style10">== (</span><span class="style5">int</span><span class="style10">)</span><span class="style11">a</span><span class="style10">.</span><span class="style16">size</span><span class="style10">()) </span><span class="style5">return</span><span class="style10">;
    </span><span class="style11">findstring</span><span class="style10">(</span><span class="style11">nod</span><span class="style10">, </span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] - </span><span class="style7">'a' </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
    </span><span class="style11">findstring</span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">], </span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">, </span><span class="style11">a</span><span class="style10">);
}

</span><span class="style16">string </span><span class="style11">conv</span><span class="style10">(</span><span class="style16">string </span><span class="style11">g</span><span class="style10">){
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">g</span><span class="style10">.</span><span class="style16">begin</span><span class="style10">(), </span><span class="style11">g</span><span class="style10">.</span><span class="style16">end</span><span class="style10">());
    </span><span class="style5">return </span><span class="style11">g</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">In</span><span class="style10">(){
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">dict</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
    }
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">dict </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style11">dict </span><span class="style10">+ </span><span class="style11">n </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">);
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++) </span><span class="style11">Add</span><span class="style10">(</span><span class="style11">conv</span><span class="style10">(</span><span class="style11">dict</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]), </span><span class="style11">i</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style11">In</span><span class="style10">();
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">m</span><span class="style10">--){
        </span><span class="style16">string </span><span class="style11">a</span><span class="style10">;
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">;
        </span><span class="style11">a </span><span class="style10">= </span><span class="style11">conv</span><span class="style10">(</span><span class="style11">a</span><span class="style10">);
        </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">findstring</span><span class="style10">(</span><span class="style4">0</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">a</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">res</span><span class="style10">) </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">dict</span><span class="style10">[</span><span class="style11">res</span><span class="style10">];
        </span><span class="style5">else </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"IMPOSSIBLE"</span><span class="style10">;
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1000001</span><span class="style10">;

</span><span class="style5">struct </span><span class="style11">nod</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">child</span><span class="style10">[</span><span class="style4">27</span><span class="style10">];
    </span><span class="style5">bool </span><span class="style11">IE</span><span class="style10">;
};

</span><span class="style5">struct </span><span class="style11">nod T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">depth</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">Add</span><span class="style10">(</span><span class="style16">string </span><span class="style11">s</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style2">// root;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">char </span><span class="style11">c </span><span class="style10">: </span><span class="style11">s</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style11">c </span><span class="style10">- </span><span class="style7">'a' </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">] = ++</span><span class="style11">depth</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">];
    }
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">IE </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
}

</span><span class="style5">bool </span><span class="style11">Find</span><span class="style10">(</span><span class="style16">string </span><span class="style11">s</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">char </span><span class="style11">c </span><span class="style10">: </span><span class="style11">s</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style11">c </span><span class="style10">- </span><span class="style7">'a' </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">];
    }
    </span><span class="style5">return </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">IE</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">string </span><span class="style11">s</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style11">n</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">Add</span><span class="style10">(</span><span class="style11">s</span><span class="style10">);
    }
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">Find</span><span class="style10">(</span><span class="style11">s</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">depth</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">dem </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">nod</span><span class="style10">{
    </span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">child</span><span class="style10">[</span><span class="style4">27</span><span class="style10">];
    </span><span class="style5">bool </span><span class="style11">IE</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">num</span><span class="style10">;
};
</span><span class="style11">nod T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">Add</span><span class="style10">(</span><span class="style16">string </span><span class="style11">s</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">char </span><span class="style11">c </span><span class="style10">: </span><span class="style11">s</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style11">c </span><span class="style10">- </span><span class="style7">'a' </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">].</span><span class="style11">f </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">].</span><span class="style11">f </span><span class="style10">= ++</span><span class="style11">depth</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">].</span><span class="style11">f</span><span class="style10">;
        </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">].</span><span class="style11">s</span><span class="style10">++;
    }
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">IE </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">Check</span><span class="style10">(</span><span class="style16">string </span><span class="style11">s</span><span class="style10">){
    </span><span class="style11">dem </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">char </span><span class="style11">c </span><span class="style10">: </span><span class="style11">s</span><span class="style10">){
        </span><span class="style11">id </span><span class="style10">= </span><span class="style11">c </span><span class="style10">- </span><span class="style7">'a' </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">].</span><span class="style11">f </span><span class="style10">== </span><span class="style4">0</span><span class="style10">) </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">].</span><span class="style11">f</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">].</span><span class="style11">s</span><span class="style10">;
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style16">string </span><span class="style11">s</span><span class="style10">;
    </span><span class="style5">while</span><span class="style10">(</span><span class="style11">n</span><span class="style10">--){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">Add</span><span class="style10">(</span><span class="style11">s</span><span class="style10">);
    }
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">m</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(</span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">){
        </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">Check</span><span class="style10">(</span><span class="style11">s</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#define MOD                     1000000007
#define base                    311
#define pii                     pair&lt;int, int&gt;
#define f                       first
#define s                       second
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1000001</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">Tree</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">child</span><span class="style10">[</span><span class="style4">27</span><span class="style10">];
    </span><span class="style5">bool </span><span class="style11">IE</span><span class="style10">;
};
</span><span class="style11">Tree T</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">F</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">r</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">plusmod</span><span class="style10">(</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">b</span><span class="style10">){
    </span><span class="style11">a </span><span class="style10">+= </span><span class="style11">b</span><span class="style10">;
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">a </span><span class="style10">&gt;= </span><span class="style11">MOD</span><span class="style10">) </span><span class="style11">a </span><span class="style10">-= </span><span class="style11">MOD</span><span class="style10">;
}

</span><span class="style5">void </span><span class="style11">Add</span><span class="style10">(</span><span class="style16">string </span><span class="style11">s</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">char </span><span class="style11">c </span><span class="style10">: </span><span class="style11">s</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style11">c </span><span class="style10">- </span><span class="style7">'a' </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">] = ++</span><span class="style11">r</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">id</span><span class="style10">];
    }
    </span><span class="style11">T</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style11">IE </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
}


</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style16">string </span><span class="style11">s</span><span class="style10">;
    </span><span class="style11">up</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">1</span><span class="style10">, </span><span class="style11">n</span><span class="style10">){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">Add</span><span class="style10">(</span><span class="style11">s</span><span class="style10">);
    }

    </span><span class="style16">string </span><span class="style11">x</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
    </span><span class="style11">n </span><span class="style10">= </span><span class="style11">x</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();

    </span><span class="style11">F</span><span class="style10">[</span><span class="style11">n</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">n</span><span class="style10">-</span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">int </span><span class="style11">nod </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++){
            </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">x</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] - </span><span class="style7">'a' </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
            </span><span class="style2">//cout &lt;&lt; T[nod].child[v] &lt;&lt; "\n";
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style5">break</span><span class="style10">;
            </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">child</span><span class="style10">[</span><span class="style11">v</span><span class="style10">];
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">T</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">].</span><span class="style11">IE</span><span class="style10">) </span><span class="style11">plusmod</span><span class="style10">(</span><span class="style11">F</span><span class="style10">[</span><span class="style11">i</span><span class="style10">], </span><span class="style11">F</span><span class="style10">[</span><span class="style11">j</span><span class="style10">+</span><span class="style4">1</span><span class="style10">]);
            </span><span class="style2">//for (int i = 0; i &lt;= n; i++) cout &lt;&lt; F[i] &lt;&lt; " ";
            //cout &lt;&lt; "\n";
        </span><span class="style10">}
        </span><span class="style2">//cout &lt;&lt; "\n";
    </span><span class="style10">}

    </span><span class="style2">//up(i, 0, n) cout &lt;&lt; F[i] &lt;&lt; " ";
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">F</span><span class="style10">[</span><span class="style4">0</span><span class="style10">];
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">q</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">child</span><span class="style10">[</span><span class="style4">10000001</span><span class="style10">][</span><span class="style4">2</span><span class="style10">]; </span><span class="style2">// I realized that using struct, in some cases, is a really stupid idea
</span><span class="style5">int </span><span class="style11">val</span><span class="style10">[</span><span class="style4">10000001</span><span class="style10">];      </span><span class="style2">// Because it never noficate that I'm making a RTE
</span><span class="style5">int </span><span class="style11">num</span><span class="style10">[</span><span class="style4">10000001</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cnt </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">Add</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">nod </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">short </span><span class="style11">i </span><span class="style10">= </span><span class="style4">30</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">bool </span><span class="style11">id </span><span class="style10">= </span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">i</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style11">id</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style11">id</span><span class="style10">] = ++</span><span class="style11">cnt</span><span class="style10">;
        </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style11">id</span><span class="style10">];
        </span><span class="style11">num</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">]++;
    }
    </span><span class="style11">val</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">get</span><span class="style10">(</span><span class="style5">int </span><span class="style11">k</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">nod </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">res </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">short </span><span class="style11">i </span><span class="style10">= </span><span class="style4">30</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&gt;= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">--){
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] == </span><span class="style4">0 </span><span class="style10">|| </span><span class="style11">num</span><span class="style10">[</span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]] &lt; </span><span class="style11">k</span><span class="style10">){
            </span><span class="style11">k </span><span class="style10">-= </span><span class="style11">num</span><span class="style10">[</span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style4">0</span><span class="style10">]];
            </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style4">1</span><span class="style10">];
            </span><span class="style11">res </span><span class="style10">= </span><span class="style11">res </span><span class="style10">* </span><span class="style4">2 </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style4">0</span><span class="style10">];
            </span><span class="style11">res </span><span class="style10">= </span><span class="style11">res </span><span class="style10">* </span><span class="style4">2</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style11">val</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">];
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">c</span><span class="style10">,</span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">c </span><span class="style10">&gt;&gt; </span><span class="style11">x</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">c </span><span class="style10">== </span><span class="style4">1</span><span class="style10">){
            </span><span class="style11">Add</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
        }
        </span><span class="style5">else </span><span class="style10">{
            </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">get</span><span class="style10">(</span><span class="style11">x</span><span class="style10">) &lt;&lt; </span><span class="style6">"\n"</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}

</span><span class="style9">#include &lt;bits/stdc++.h&gt;
#define pii pair&lt;int, int&gt;
#define f                       first
#define s                       second
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">setFile</span><span class="style10">(){
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".inp"</span><span class="style10">, </span><span class="style6">"r"</span><span class="style10">, </span><span class="style11">stdin</span><span class="style10">);
    </span><span class="style11">freopen </span><span class="style10">(</span><span class="style11">Task</span><span class="style6">".out"</span><span class="style10">, </span><span class="style6">"w"</span><span class="style10">, </span><span class="style11">stdout</span><span class="style10">);
}

</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">10000001</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">child</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style4">2</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">val</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cnt</span><span class="style10">;

</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">nod </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">down </span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">30</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">i</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style11">id</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">) </span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style11">id</span><span class="style10">] = ++</span><span class="style11">cnt</span><span class="style10">;
        </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style11">id</span><span class="style10">];
    }
    </span><span class="style11">val</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] = </span><span class="style11">x</span><span class="style10">;
}

</span><span class="style5">int </span><span class="style11">check</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">){
    </span><span class="style5">int </span><span class="style11">nod </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">down</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, </span><span class="style4">30</span><span class="style10">, </span><span class="style4">0</span><span class="style10">){
        </span><span class="style5">int </span><span class="style11">id </span><span class="style10">= </span><span class="style11">bit</span><span class="style10">(</span><span class="style11">x</span><span class="style10">, </span><span class="style11">i</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style4">1</span><span class="style10">-</span><span class="style11">id</span><span class="style10">] != </span><span class="style4">0</span><span class="style10">){
            </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style4">1</span><span class="style10">-</span><span class="style11">id</span><span class="style10">];
        }
        </span><span class="style5">else </span><span class="style11">nod </span><span class="style10">= </span><span class="style11">child</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">][</span><span class="style11">id</span><span class="style10">];
    }
</span><span class="style2">//    cout &lt;&lt; val[nod] &lt;&lt; " ";
//    cout &lt;&lt; x &lt;&lt; " ";
//    cout &lt;&lt; (val[nod] ^ x) &lt;&lt; " ";
    </span><span class="style5">return </span><span class="style10">(</span><span class="style11">val</span><span class="style10">[</span><span class="style11">nod</span><span class="style10">] ^ </span><span class="style11">x</span><span class="style10">);
}

</span><span class="style5">signed </span><span class="style11">main </span><span class="style10">(){
    </span><span class="style11">setFile</span><span class="style10">();
    </span><span class="style16">ios_base</span><span class="style10">::</span><span class="style11">sync_with_stdio</span><span class="style10">(</span><span class="style5">false</span><span class="style10">);
    </span><span class="style16">cin</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);
    </span><span class="style16">cout</span><span class="style10">.</span><span class="style11">tie</span><span class="style10">(</span><span class="style4">0</span><span class="style10">);

    </span><span class="style5">int </span><span class="style11">maxx </span><span class="style10">= </span><span class="style11">INT_MIN</span><span class="style10">;
    </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style16">cin </span><span class="style10">&gt;&gt; </span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">add</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]);
    }
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++){
        </span><span class="style11">maxx </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxx</span><span class="style10">, </span><span class="style11">check</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]));
    }
    </span><span class="style16">cout </span><span class="style10">&lt;&lt; </span><span class="style11">maxx</span><span class="style10">;
    </span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
}</span></span>
</code></pre>


</body></html>
